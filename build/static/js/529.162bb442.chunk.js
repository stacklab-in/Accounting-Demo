"use strict";(self.webpackChunk_accounting_billing_stacklab=self.webpackChunk_accounting_billing_stacklab||[]).push([[529],{32869:function(e,n,a){a.d(n,{Ds:function(){return t.Ds}});var t=a(58518);a(58764)},48806:function(e,n,a){a.r(n),a.d(n,{default:function(){return z}});var t=a(6907),r=a(74165),i=a(15861),o=a(4942),l=a(1413),c=a(29439),s=a(72791),u=a(64554),d=a(89164),f=a(4567),x=a(57088),h=a(89891),m=a(30439),b=a(71715),p=a(82626),Z=a(73590),v=a(61889),k=a(48550),j=a(85523),g=a(68096),y=a(50168),C=a(58406),D=a(42419),N=a(18406),A=a(99615),S=a(52073),w=a(32869),B=a(26759),_=a(43513),P=a(71652),T=a(23937),E=a(24750),q=a(97892),I=a.n(q),F=a(8976),R=a(80184),W={position:"absolute",top:"40%",left:"50%",transform:"translate(-50%, -50%)",width:"70%",bgcolor:"background.paper",borderRadius:"10px",boxShadow:24,p:2,backgroundColor:N.$_.modalbackground,height:"auto",overflow:"auto"},U={id:"",accountNumber:"",ifscCode:"",bankName:"",branchName:"",isDefault:!1},M={fromAccount:"",toAccount:"",amount:"",transferDate:null};function Y(){var e,n,a=(0,F.E)().user,t=(0,x.K$)(),q=(0,w.Ds)().enqueueSnackbar,Y=(0,s.useState)(!1),z=(0,c.Z)(Y,2),H=z[0],L=z[1],$=(0,s.useState)(!1),K=(0,c.Z)($,2),O=K[0],G=K[1],V=(0,s.useState)(U),J=(0,c.Z)(V,2),Q=J[0],X=J[1],ee=(0,s.useState)([]),ne=(0,c.Z)(ee,2),ae=ne[0],te=ne[1],re=(0,s.useState)([]),ie=(0,c.Z)(re,2),oe=ie[0],le=ie[1],ce=(0,s.useState)(""),se=(0,c.Z)(ce,2),ue=se[0],de=se[1],fe=(0,s.useState)(null),xe=(0,c.Z)(fe,2),he=xe[0],me=xe[1],be=Boolean(he),pe=(0,s.useState)({}),Ze=(0,c.Z)(pe,2),ve=Ze[0],ke=Ze[1],je=(0,s.useState)(!1),ge=(0,c.Z)(je,2),ye=ge[0],Ce=ge[1],De=(0,s.useState)(!1),Ne=(0,c.Z)(De,2),Ae=Ne[0],Se=Ne[1],we=(0,s.useState)(M),Be=(0,c.Z)(we,2),_e=Be[0],Pe=Be[1],Te=function(e){var n=e.target,a=n.name,t=n.value;Pe((function(e){return(0,l.Z)((0,l.Z)({},e),{},(0,o.Z)({},a,t))}))};console.log({bank:Q});var Ee=function(e){var n=e.target,a=n.name,t=n.value;X((function(e){return(0,l.Z)((0,l.Z)({},e),{},(0,o.Z)({},a,"ifscCode"===a||"bankName"===a||"branchName"===a?t.toUpperCase():t))}))},qe=function(){var e=(0,i.Z)((0,r.Z)().mark((function e(){var n,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=localStorage.getItem(S._.keyUserToken),a=(0,N.sw)(n),A.ZP.post(A.Hv.bank.update,Q,{headers:{Authorization:"Bearer ".concat(a)}}).then((function(e){q("Bank updated successfully!",{variant:"success"}),X(U),de(""),Ie(),L(!1)})).catch((function(e){q(e.error,{variant:"error"})}));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ie=function(){var e=(0,i.Z)((0,r.Z)().mark((function e(){var n,a,t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=localStorage.getItem(S._.keyUserToken),a=(0,N.sw)(n),e.next=5,A.ZP.post(A.Hv.bank.list,{},{headers:{Authorization:"Bearer ".concat(a)}});case 5:(t=e.sent)&&(le(!1),te(t.data.data)),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),q("Failed to fetch bank accounts!",{variant:"error"}),le(!1);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();(0,s.useEffect)((function(){le(!0),Ie()}),[]);var Fe=[{name:"Set as Default",selector:function(e){return e.isDefault},cell:function(e){var n,t;return(0,R.jsx)(h.Z,{checked:e.isDefault,disabled:!(null!==a&&void 0!==a&&null!==(n=a.permissions)&&void 0!==n&&null!==(t=n.settings)&&void 0!==t&&t.u),onChange:function(n){le(!0);var a=localStorage.getItem(S._.keyUserToken),t=(0,N.sw)(a);A.ZP.post(A.Hv.bank.setAsDefault,{id:e._id},{headers:{Authorization:"Bearer ".concat(t)}}).then((function(e){q("Default bank updated successfully!",{variant:"success"}),Ie(),le(!1)})).catch((function(e){q(e.error,{variant:"error"}),le(!1)}))}})},width:"160px"},{name:"Bank Details",selector:function(e){return e.branchName},cell:function(e){return(0,R.jsxs)("div",{children:[(0,R.jsx)(f.Z,{variant:"h6",children:e.bankName}),(0,R.jsx)(f.Z,{variant:"subtitle1",children:e.accountNumber}),(0,R.jsx)(f.Z,{variant:"subtitle2",children:e.ifscCode})]})},width:"auto"},{name:"Balance",selector:function(e){return N.MG.format(e.balance)}},{name:"Actions",width:"auto",cell:function(e){var n,t;return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(m.Z,{disabled:!(null!==a&&void 0!==a&&null!==(n=a.permissions)&&void 0!==n&&null!==(t=n.settings)&&void 0!==t&&t.u),onClick:function(n){me(n.currentTarget),ke(e)},style:{color:N.$_.actionButton},c:!0,variant:"outlined",endIcon:(0,R.jsx)(B.Z,{}),children:"Action"}),(0,R.jsxs)(b.Z,{id:"basic-menu",anchorEl:he,open:be,onClose:function(){me(null),ke({})},MenuListProps:{"aria-labelledby":"basic-button"},children:[(0,R.jsx)(p.Z,{onClick:function(){X((function(n){return(0,l.Z)((0,l.Z)((0,l.Z)({},n),e),{},{id:e._id})})),me(null),L(!0),G(!0),de(e.accountNumber)},children:"Edit Details"}),(0,R.jsx)(p.Z,{onClick:function(){return X((function(e){return(0,l.Z)((0,l.Z)({},e),{},{id:ve._id,bankName:ve.bankName,accountNumber:ve.accountNumber,ifscCode:ve.ifscCode})})),me(null),void Ce(!0)},children:"Remove"})]})]})}}];return(0,R.jsxs)(d.Z,{maxWidth:!t.themeStretch&&"xl",children:[(0,R.jsx)(f.Z,{variant:"h4",children:"Bank Details "}),(0,R.jsxs)(u.Z,{sx:{mt:3,p:2,display:"flex",gap:"30px",flexDirection:"column"},children:[(0,R.jsx)(u.Z,{sx:{display:"flex",gap:"10px"},children:(null===a||void 0===a||null===(e=a.permissions)||void 0===e||null===(n=e.settings)||void 0===n?void 0:n.u)&&(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(m.Z,{startIcon:(0,R.jsx)(D.Z,{}),variant:"contained",color:"primary",onClick:function(){L(!0)},children:"NEW BANK DETAILS"}),ae.length>1&&(0,R.jsx)(m.Z,{startIcon:(0,R.jsx)(D.Z,{}),variant:"contained",onClick:function(){Se(!0)},children:"TRANSFER FUNDS"})]})}),(0,R.jsx)(u.Z,{sx:{display:"flex",gap:"10px",border:"1px solid black",borderRadius:"10px"},children:(0,R.jsx)(_.ZP,{data:ae,columns:Fe,progressPending:oe})})]}),(0,R.jsx)(Z.Z,{open:H,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,R.jsxs)(u.Z,{sx:W,children:[(0,R.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[(0,R.jsx)(f.Z,{id:"modal-modal-title",variant:"h4",component:"h2",children:"Bank Details"}),(0,R.jsxs)(v.ZP,{container:!0,spacing:2,children:[(0,R.jsx)(v.ZP,{item:!0,xs:12,children:(0,R.jsx)(k.Z,{sx:{borderRadius:"7px",backgroundColor:"white"},label:"Account Number",name:"accountNumber",type:"number",value:Q.accountNumber,onChange:function(e){return Ee(e)},fullWidth:!0,required:!0})}),(0,R.jsx)(v.ZP,{item:!0,xs:12,children:(0,R.jsx)(k.Z,{sx:{borderRadius:"7px",backgroundColor:"white"},label:"Confirm Bank Account Number",type:"number",value:ue,onChange:function(e){return de(e.target.value)},fullWidth:!0,required:!0})}),(0,R.jsx)(v.ZP,{item:!0,xs:12,children:(0,R.jsx)(k.Z,{sx:{borderRadius:"7px",backgroundColor:"white"},label:"IFSC Code",name:"ifscCode",value:Q.ifscCode,onChange:function(e){return Ee(e)},fullWidth:!0,required:!0})}),(0,R.jsx)(v.ZP,{item:!0,xs:12,children:(0,R.jsx)(k.Z,{sx:{borderRadius:"7px",backgroundColor:"white"},label:"Bank Name",name:"bankName",value:Q.bankName,onChange:function(e){return Ee(e)},fullWidth:!0,required:!0})}),(0,R.jsx)(v.ZP,{item:!0,xs:12,children:(0,R.jsx)(k.Z,{sx:{borderRadius:"7px",backgroundColor:"white"},label:"Branch Name",name:"branchName",value:Q.branchName,onChange:function(e){return Ee(e)},fullWidth:!0,required:!0})}),(0,R.jsx)(v.ZP,{item:!0,xs:12,children:(0,R.jsx)(j.Z,{control:(0,R.jsx)(h.Z,{checked:Q.isDefault,onChange:function(e){X((function(e){return(0,l.Z)((0,l.Z)({},e),{},{isDefault:!Q.isDefault})}))}}),label:"Make Default"})})]})]}),(0,R.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:"10px",justifyContent:"flex-end",padding:"10px"},children:[(0,R.jsx)(m.Z,{variant:"outlined",onClick:function(){X(U),de(""),L(!1)},children:"Cancel"}),(0,R.jsx)(m.Z,{variant:"contained",color:"primary",disabled:!Q.accountNumber||!Q.ifscCode||!Q.bankName||!ue||!Q.branchName||Q.accountNumber!==ue,onClick:O?qe:function(){console.log({bank:Q});var e=localStorage.getItem(S._.keyUserToken),n=(0,N.sw)(e);A.ZP.post(A.Hv.bank.add,Q,{headers:{Authorization:"Bearer ".concat(n)}}).then((function(e){q("Bank added successfully!",{variant:"success"}),X(U),de(""),Ie(),L(!1)})).catch((function(e){q(e.error,{variant:"error"})}))},children:O?"UPDATE":"SAVE"})]})]})}),(0,R.jsx)(Z.Z,{open:ye,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,R.jsxs)(u.Z,{sx:W,children:[(0,R.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[(0,R.jsx)(f.Z,{id:"modal-modal-title",variant:"h4",component:"h2",children:"Bank Details"}),(0,R.jsxs)("div",{style:{backgroundColor:"white",padding:"10px",borderRadius:"10px"},children:[(0,R.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:"10px",marginBottom:"10px"},children:[(0,R.jsx)(k.Z,{label:"Bank Name",name:"bankName",value:Q.bankName,disabled:!0,fullWidth:!0,required:!0}),(0,R.jsx)(k.Z,{label:"Account Number",name:"accountNumber",type:"number",value:Q.accountNumber,disabled:!0,fullWidth:!0,required:!0})]}),(0,R.jsx)(v.ZP,{item:!0,xs:6,children:(0,R.jsx)(k.Z,{label:"IFSC Code",name:"ifscCode",value:Q.ifscCode,disabled:!0,fullWidth:!0,required:!0})})]})]}),(0,R.jsx)(f.Z,{sx:{color:"red"},children:"Note : Deleting the bank account from here will remove the bank details from all existing invoices. Deleted banks cannot be used again and this action cannot be undone. "}),(0,R.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:"10px",justifyContent:"flex-end",padding:"10px"},children:[(0,R.jsx)(m.Z,{variant:"outlined",onClick:function(){X(U),Ce(!1)},children:"CLOSE"}),(0,R.jsx)(m.Z,{variant:"contained",color:"primary",onClick:function(){var e=localStorage.getItem(S._.keyUserToken),n=(0,N.sw)(e);A.ZP.post(A.Hv.bank.delete,{id:Q.id},{headers:{Authorization:"Bearer ".concat(n)}}).then((function(e){q("Bank deleted successfully!",{variant:"success"}),X(U),Ce(!1),Ie()})).catch((function(e){q(e.error,{variant:"error"})}))},children:"DELETE"})]})]})}),(0,R.jsx)(Z.Z,{open:Ae,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,R.jsxs)(u.Z,{sx:W,children:[(0,R.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[(0,R.jsx)(f.Z,{id:"modal-modal-title",variant:"h4",component:"h2",children:"Internal Bank to Bank Fund Transfer"}),(0,R.jsx)(f.Z,{id:"modal-modal-title",sx:{color:"black"},children:"Note : This Transfer only affects the internal bank balances in the software and does not affect the actual bank balances."}),(0,R.jsxs)("div",{style:{backgroundColor:"white",padding:"10px",borderRadius:"10px"},children:[(0,R.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:"10px",marginBottom:"10px"},children:[(0,R.jsxs)(g.Z,{fullWidth:!0,required:!0,children:[(0,R.jsx)(y.Z,{id:"demo-simple-select-label",children:"Select From Bank Account"}),(0,R.jsx)(C.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:_e.fromAccount,label:"Select From Bank Account",name:"fromAccount",onChange:Te,required:!0,children:ae.filter((function(e){return e._id!==_e.toAccount})).map((function(e){return(0,R.jsx)(p.Z,{value:e._id,children:e.bankName})}))})]}),(0,R.jsxs)(g.Z,{fullWidth:!0,required:!0,children:[(0,R.jsx)(y.Z,{id:"demo-simple-select-label",children:"Select To Bank Account"}),(0,R.jsx)(C.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:_e.toAccount,label:"Select To Bank Account",name:"toAccount",onChange:Te,required:!0,children:ae.filter((function(e){return e._id!==_e.fromAccount})).map((function(e){return(0,R.jsx)(p.Z,{value:e._id,children:e.bankName})}))})]})]}),(0,R.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:"10px",marginBottom:"10px"},children:[(0,R.jsx)(k.Z,{label:"Enter Amount",name:"amount",type:"number",value:_e.amount,onChange:Te,fullWidth:!0,required:!0}),(0,R.jsx)(P._,{dateAdapter:E.y,children:(0,R.jsx)(T.M,{label:"Transfer Date",value:_e.transferDate,onChange:function(e){Pe((function(n){return(0,l.Z)((0,l.Z)({},n),{},{transferDate:e})}))},format:"DD/MM/YYYY",slotProps:{textField:{fullWidth:!0}}})})]})]})]}),(0,R.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:"10px",justifyContent:"flex-end",padding:"10px"},children:[(0,R.jsx)(m.Z,{variant:"contained",color:"primary",onClick:function(){var e={fromAccount:_e.fromAccount,toAccount:_e.toAccount,amount:_e.amount,transferDate:I()(_e.transferDate).format("YYYY-MM-DD")},n=localStorage.getItem(S._.keyUserToken),a=(0,N.sw)(n);A.ZP.post(A.Hv.bank.transfer,e,{headers:{Authorization:"Bearer ".concat(a)}}).then((function(e){q("Bank transfer successful!",{variant:"success"}),Pe(M),Se(!1),Ie()})).catch((function(e){q(e.error,{variant:"error"})}))},disabled:!_e.fromAccount||!_e.toAccount||!_e.amount||!_e.transferDate,children:"TRANSFER FUNDS"}),(0,R.jsx)(m.Z,{variant:"outlined",onClick:function(){Pe(M),Se(!1)},children:"CLOSE"})]})]})})]})}function z(){return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(t.ql,{children:(0,R.jsx)("title",{children:" Settings : Banking Details"})}),(0,R.jsx)(Y,{})]})}}}]);
//# sourceMappingURL=529.162bb442.chunk.js.map