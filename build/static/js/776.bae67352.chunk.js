"use strict";(self.webpackChunk_accounting_billing_stacklab=self.webpackChunk_accounting_billing_stacklab||[]).push([[776],{32869:function(e,t,n){n.d(t,{Ds:function(){return r.Ds}});var r=n(58518);n(58764)},41776:function(e,t,n){n.r(t),n.d(t,{default:function(){return Y}});var r=n(1413),a=n(74165),o=n(15861),i=n(29439),s=n(89164),l=n(4567),c=n(36314),u=n(85771),d=n(30439),p=n(71715),m=n(82626),f=n(48550),h=n(63466),v=n(64554),x=n(6907),b=n(57088),y=n(18406),Z=n(26759),j=n(72791),g=n(52073),A=n(99615),D=n(32869),I=n(43513),P=n(5403),k=n(71652),w=n(23937),N=n(97892),_=n.n(N),M=n(24750),C=n(34045),S=n(35125),T=(n(31052),n(64802)),F=n(80184);function Y(){var e=(0,b.K$)(),t=(0,j.useState)(!1),n=(0,i.Z)(t,2),N=n[0],Y=n[1],B=(0,j.useState)([]),R=(0,i.Z)(B,2),z=R[0],E=R[1],L=(0,j.useState)([]),G=(0,i.Z)(L,2),O=(G[0],G[1]),V=(0,j.useState)(""),q=(0,i.Z)(V,2),U=q[0],W=q[1],$=(0,j.useState)([]),H=(0,i.Z)($,2),K=H[0],J=H[1],Q=(0,D.Ds)().enqueueSnackbar,X=(0,j.useState)(null),ee=(0,i.Z)(X,2),te=ee[0],ne=ee[1],re=Boolean(te),ae=function(){var e=(0,o.Z)((0,a.Z)().mark((function e(){var t,n,r;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem(g._.keyUserToken),n=(0,y.sw)(t),e.next=5,A.ZP.post(A.Hv.purchase.list,{},{headers:{Authorization:"Bearer ".concat(n)}});case 5:(r=e.sent)&&(Y(!1),E(r.data.data),O(r.data.data),J(r.data.data)),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),Q("Failed to fetch purchase orders!",{variant:"error"}),Y(!1);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();(0,j.useEffect)((function(){Y(!0),ae()}),[]);var oe=(0,j.useState)(_()().startOf("month")),ie=(0,i.Z)(oe,2),se=ie[0],le=ie[1],ce=(0,j.useState)(_()().endOf("month")),ue=(0,i.Z)(ce,2),de=ue[0],pe=ue[1];(0,j.useEffect)((function(){if(se&&de){var e=K.filter((function(e){var t=_()(e.createdAt);return console.log(se,de),t.isBetween(se,de,null,"[]")}));E(e)}else E(K)}),[se,de]);var me=[{name:"Vendor Name",selector:function(e){return e.vendorId.name},sortable:"true"},{name:"Invoice Number",selector:function(e){return e.invoiceNumber}},{name:"Amount",selector:function(e){return e.totalAmount.toFixed(2)},sortable:"true"},{name:"Payment Mode",selector:function(e){return e.payments[0].paymentID.paymentMode},sortable:"true"},{name:"Invoice Date",selector:function(e){return new Date(e.createdAt).toLocaleDateString("en-GB",{day:"2-digit",month:"long",year:"numeric"})},sortable:"true"}],fe=z.filter((function(e){var t;return null===e||void 0===e||null===(t=e.vendorId.name)||void 0===t?void 0:t.toLowerCase().includes(null===U||void 0===U?void 0:U.toLowerCase())}));return(0,F.jsxs)(s.Z,{maxWidth:!e.themeStretch&&"xl",children:[(0,F.jsx)(x.ql,{children:(0,F.jsx)("title",{children:" Reports: Purchase Report"})}),(0,F.jsx)(l.Z,{variant:"h4",children:" Purchase Report "}),(0,F.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",marginTop:"20px"},children:[(0,F.jsx)(c.Z,{direction:"row",spacing:1,children:(0,F.jsx)(u.Z,{label:"Total Amount : ".concat(z.length>0?y.MG.format(z.reduce((function(e,t){return e+t.totalAmount}),0)):y.MG.format(0)),variant:"outlined"})}),(0,F.jsxs)(c.Z,{children:[(0,F.jsx)(d.Z,{style:{color:y.$_.actionButton},endIcon:(0,F.jsx)(Z.Z,{}),variant:"outlined",onClick:function(e){return ne(e.currentTarget)},children:"ACTIONS"}),(0,F.jsxs)(p.Z,{id:"basic-menu",anchorEl:te,open:re,onClose:function(){ne(null),O({})},MenuListProps:{"aria-labelledby":"basic-button"},children:[(0,F.jsx)(m.Z,{onClick:function(){},children:"Print"}),(0,F.jsx)(m.Z,{onClick:function(){ne(null);var e=new S.default;e.text("Purchase Report",10,10);var t=fe.map((function(e){var t,n;return[e.vendorId.name||"N/A",e.invoiceNumber||"N/A",e.totalAmount.toFixed(2)||"N/A",(null===(t=e.payments[e.payments.length-1])||void 0===t||null===(n=t.paymentID)||void 0===n?void 0:n.paymentMode)||"N/A",e.createdAt?(0,y.p6)(e.createdAt):"N/A"]}));e.autoTable({head:[["Vendor Name","Invoice Number","Amount","Payment Mode","Time"]],body:t}),e.save("purchase_report.pdf")},children:"Download as PDF"}),(0,F.jsx)(m.Z,{onClick:function(){ne(null);var e=fe.map((function(e){var t,n;return{"Vendor Name":e.vendorId.name,"Invoice Number":e.invoiceNumber,Amount:e.totalAmount.toFixed(2),"Payment Mode":(null===(t=e.payments[e.payments.length-1])||void 0===t||null===(n=t.paymentID)||void 0===n?void 0:n.paymentMode)||"N/A","Invoice Date":e.createdAt?(0,y.p6)(e.createdAt):"N/A"}})),t=C.P6.book_new(),n=C.P6.json_to_sheet(e);C.P6.book_append_sheet(t,n,"Purchase Report");var r=C.cW(t,{bookType:"xlsx",type:"array"}),a=new Blob([r],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});(0,T.saveAs)(a,"purchase_report.xlsx")},children:"Download as Excel"})]})]})]}),(0,F.jsxs)("div",{style:{display:"flex",marginTop:"8px",gap:"10px"},children:[(0,F.jsx)(f.Z,{placeholder:"Search",size:"small",value:U,onChange:function(e){return W(e.target.value)},InputProps:{startAdornment:(0,F.jsx)(h.Z,{position:"start",children:(0,F.jsx)(P.Z,{})})}}),(0,F.jsx)("div",{children:(0,F.jsx)(k._,{dateAdapter:M.y,children:(0,F.jsxs)(v.Z,{sx:{display:"flex",flexDirection:"row",gap:"10px",alignItems:"center"},children:[(0,F.jsx)(w.M,{label:"From",format:"DD/MM/YYYY",value:se,slotProps:{textField:{size:"small"}},onChange:function(e){le(e)},renderInput:function(e){return(0,F.jsx)(f.Z,(0,r.Z)({},e))}}),(0,F.jsx)(l.Z,{children:"-"}),(0,F.jsx)(w.M,{label:"To",format:"DD/MM/YYYY",value:de,slotProps:{textField:{size:"small"}},onChange:function(e){pe(e)},renderInput:function(e){return(0,F.jsx)(f.Z,(0,r.Z)({},e))}})]})})})]}),(0,F.jsx)("div",{style:{marginTop:"20px"},children:(0,F.jsx)(I.ZP,{columns:me,data:fe,pagination:!0,progressPending:N})})]})}}}]);
//# sourceMappingURL=776.bae67352.chunk.js.map