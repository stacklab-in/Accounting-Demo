"use strict";(self.webpackChunk_accounting_billing_stacklab=self.webpackChunk_accounting_billing_stacklab||[]).push([[571],{32869:function(e,t,n){n.d(t,{Ds:function(){return r.Ds}});var r=n(58518);n(58764)},36571:function(e,t,n){n.r(t),n.d(t,{default:function(){return X}});var r=n(6907),a=n(93433),o=n(74165),i=n(15861),l=n(1413),c=n(29439),s=n(72791),u=n(89164),d=n(4567),p=n(57088),f=n(30439),m=n(71715),x=n(82626),h=n(93006),Z=n(63466),y=n(13400),v=n(36314),g=n(85771),b=n(73590),j=n(64554),P=n(61889),k=n(89744),C=n(68096),S=n(50168),w=n(58406),D=n(42419),A=n(5403),I=n(97892),M=n.n(I),T=n(4560),q=n(71652),B=n(24750),_=n(51612),R=n(26759),F=n(43513),W=n(83932),z=n(27247),O=n(93704),E=n(18406),N=n(52073),Y=n(99615),H=n(32869),U=n(42716),V=n(80184),L={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"75%",bgcolor:E.$_.modalbackground,borderRadius:"10px",height:"90%",overflowY:"auto",boxShadow:24,display:"flex",flexDirection:"column",justifyContent:"space-between",gap:"10px",p:2},G={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"400px",bgcolor:E.$_.modalbackground,borderRadius:"10px",height:"auto",boxShadow:24,p:2},$={customer:null,mobileNumber:"",salesMan:null,invoiceDate:null,invoiceDueDate:null,products:[],offer:"",amountToPay:"",totalAmount:0,productDiscount:0,paymentMode:"",paymentStatus:"",bank:""},Q={category:"All Categories",product:null,quantity:"",netAmount:null,discount:null,sellingPrice:null},K={salesOrderId:"",name:"",balance:0,amountToPay:0,paymentMode:"",bank:"",paymentDate:M()(new Date)};function J(){var e,t,n=(0,p.K$)(),r=(0,H.Ds)().enqueueSnackbar,I=(0,s.useState)((function(){return[M()("2022-04-17"),M()("2022-04-21")]})),J=(0,c.Z)(I,2),X=J[0],ee=J[1],te=(0,s.useState)(!1),ne=(0,c.Z)(te,2),re=ne[0],ae=ne[1],oe=function(){qe($),Fe(Q),qe((function(e){return(0,l.Z)((0,l.Z)({},e),{},{customer:null})}))},ie=(0,s.useState)([]),le=(0,c.Z)(ie,2),ce=le[0],se=le[1],ue=(0,s.useState)([]),de=(0,c.Z)(ue,2),pe=de[0],fe=de[1],me=(0,s.useState)([]),xe=(0,c.Z)(me,2),he=xe[0],Ze=xe[1],ye=(0,s.useState)([]),ve=(0,c.Z)(ye,2),ge=ve[0],be=ve[1],je=(0,s.useState)([]),Pe=(0,c.Z)(je,2),ke=Pe[0],Ce=Pe[1],Se=(0,s.useState)([]),we=(0,c.Z)(Se,2),De=we[0],Ae=we[1],Ie=(0,s.useState)($),Me=(0,c.Z)(Ie,2),Te=Me[0],qe=Me[1],Be=(0,s.useState)(Q),_e=(0,c.Z)(Be,2),Re=_e[0],Fe=_e[1],We=(0,s.useState)(!1),ze=(0,c.Z)(We,2),Oe=ze[0],Ee=ze[1],Ne=(0,s.useState)([]),Ye=(0,c.Z)(Ne,2),He=Ye[0],Ue=Ye[1],Ve=(0,s.useState)({totalSalesAmount:0,totalPaidAmount:0,pendingAmount:0}),Le=(0,c.Z)(Ve,2),Ge=Le[0],$e=Le[1],Qe=(0,s.useState)(null),Ke=(0,c.Z)(Qe,2),Je=Ke[0],Xe=Ke[1],et=Boolean(Je),tt=(0,s.useState)({}),nt=(0,c.Z)(tt,2),rt=nt[0],at=nt[1],ot=(0,s.useState)(!1),it=(0,c.Z)(ot,2),lt=it[0],ct=it[1],st=(0,s.useState)(K),ut=(0,c.Z)(st,2),dt=ut[0],pt=ut[1],ft=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var t,n,a;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem(N._.keyUserToken),n=(0,E.sw)(t),e.next=5,Y.ZP.post(Y.Hv.customer.list,{},{headers:{Authorization:"Bearer ".concat(n)}});case 5:(a=e.sent)&&se(a.data.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),r("Failed to fetch customers!",{variant:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),mt=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var t,n,a;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem(N._.keyUserToken),n=(0,E.sw)(t),e.next=5,Y.ZP.post(Y.Hv.employee.list,{},{headers:{Authorization:"Bearer ".concat(n)}});case 5:(a=e.sent)&&fe(a.data.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),r("Failed to fetch employees!",{variant:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),xt=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var t,n,a;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem(N._.keyUserToken),n=(0,E.sw)(t),e.next=5,Y.ZP.post(Y.Hv.product.list,{},{headers:{Authorization:"Bearer ".concat(n)}});case 5:(a=e.sent)&&Ce(a.data.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),r("Failed to fetch products!",{variant:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),ht=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var t,n,a;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem(N._.keyUserToken),n=(0,E.sw)(t),e.next=5,Y.ZP.post(Y.Hv.product.category.list,{},{headers:{Authorization:"Bearer ".concat(n)}});case 5:(a=e.sent)&&Ze(a.data.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),r("Failed to fetch Categories!",{variant:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),Zt=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var t,n,a;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem(N._.keyUserToken),n=(0,E.sw)(t),e.next=5,Y.ZP.post(Y.Hv.offer.list,{status:["LIVE"]},{headers:{Authorization:"Bearer ".concat(n)}});case 5:(a=e.sent)&&Ae(a.data.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),r("Failed to fetch offers!",{variant:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),yt=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var t,n,a;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem(N._.keyUserToken),n=(0,E.sw)(t),e.next=5,Y.ZP.post(Y.Hv.sales.list,{},{headers:{Authorization:"Bearer ".concat(n)}});case 5:(a=e.sent)&&(console.log("calling"),Ee(!1),Ue(a.data.data)),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),r("Failed to fetch sales orders!",{variant:"error"}),Ee(!1);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),vt=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var t,n,a;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem(N._.keyUserToken),n=(0,E.sw)(t),e.next=5,Y.ZP.post(Y.Hv.bank.list,{},{headers:{Authorization:"Bearer ".concat(n)}});case 5:(a=e.sent)&&be(a.data.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),r("Failed to fetch bank accounts!",{variant:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),gt=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var t,n,a;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem(N._.keyUserToken),n=(0,E.sw)(t),e.next=5,Y.ZP.get(Y.Hv.sales.summary,{headers:{Authorization:"Bearer ".concat(n)}});case 5:(a=e.sent)&&$e({totalSalesAmount:a.data.data.totalSalesAmount,totalPaidAmount:a.data.data.totalPaidAmount,pendingAmount:a.data.data.pendingAmount}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),r("Failed to fetch bank accounts!",{variant:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();(0,s.useEffect)((function(){Ee(!0),yt(),gt(),ft(),mt(),xt(),ht(),Zt(),vt()}),[]);var bt=[{name:"Customer Name",selector:function(e){return e.customerId.name},sortable:"true",width:"160px"},{name:"Product Name",selector:function(e){return e.products.length>1?"".concat(e.products[0].name,", & ").concat(e.products.length-1," more"):e.products[0].name}},{name:"Amount",selector:function(e){return e.totalAmount.toFixed(2)},sortable:"true"},{name:"Payment Mode",selector:function(e){return e.payments[0].paymentID.paymentMode},sortable:"true"},{name:"Payment Status",selector:function(e){return e.payments[0].paymentID.paymentStatus},sortable:"true"},{name:"Invoice Number",width:"160px",selector:function(e){return e.invoiceNumber}},{name:"Last Updated",width:"250px",selector:function(e){return(0,E.p6)(e.updatedAt)},sortable:"true"},{name:"Actions",width:"130px",cell:function(e){return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(f.Z,{onClick:function(t){Xe(t.currentTarget),at(e)},style:{color:E.$_.actionButton},variant:"outlined",endIcon:(0,V.jsx)(R.Z,{}),children:"Action"}),(0,V.jsxs)(m.Z,{id:"basic-menu",anchorEl:Je,open:et,onClose:function(){Xe(null),at({})},MenuListProps:{"aria-labelledby":"basic-button"},children:[(0,V.jsx)(x.Z,{onClick:function(){},children:"Edit"}),(0,V.jsx)(x.Z,{onClick:function(){},children:"View"}),(0,V.jsx)(x.Z,{onClick:function(){},children:"Send via Email"}),(0,V.jsx)(x.Z,{onClick:function(){},children:"Send via Whatsapp"}),rt.remainingAmount>0&&(0,V.jsx)(x.Z,{onClick:function(){return Xe(null),ct(!0),pt((function(e){return(0,l.Z)((0,l.Z)({},e),{},{name:rt.customerId.name,balance:rt.remainingAmount,salesOrderId:rt._id})})),void at({})},children:"Record Payment"})]})]})}}],jt=function(e,t,n){"discount"===t&&(n<0?(n=0,r("Discount should be between 0 and 100 percent.",{variant:"error"})):n>100&&(n=100,r("Discount should be between 0 and 100 percent.",{variant:"error"}))),"quantity"===t&&n>Te.products[e].product.quantity&&(n=Te.products[e].product.quantity,r("There are only ".concat(Te.products[e].product.quantity," units available."),{variant:"error"}));var o=(0,a.Z)(Te.products),i=(0,l.Z)({},o[e]);i[t]=n,o[e]=i,console.log("new Product",o[e]),qe((function(e){return(0,l.Z)((0,l.Z)({},e),{},{products:o})}))},Pt=[{name:"Product Name",selector:function(e){return e.product.name}},{name:"Quantity",selector:function(e){return e.quantity},cell:function(e,t){return(0,V.jsx)(h.Z,{type:"number",onBlur:function(n){var o=(0,a.Z)(Te.products),i=(0,l.Z)({},o[t]);0===e.quantity.length&&(r("Quantity cannot be empty",{variant:"error"}),i.quantity="1",o[t]=i,qe((function(e){return(0,l.Z)((0,l.Z)({},e),{},{products:o})})))},onChange:function(e){return jt(t,"quantity",e.target.value)},value:e.quantity,size:"small"})},center:"true"},{name:"Sell Price",selector:function(e){return e.sellingPrice},cell:function(e,t){return(0,V.jsx)(h.Z,{type:"number",onBlur:function(){var n=(0,a.Z)(Te.products),o=(0,l.Z)({},n[t]);(0===e.sellingPrice.length||o.product.purchasePrice>parseInt(e.sellingPrice,10))&&(r("The product price cannot be lower than its purchase price of ".concat(kt(Te.products[t].product.purchasePrice)),{variant:"error"}),o.sellingPrice=String(o.product.purchasePrice),n[t]=o,qe((function(e){return(0,l.Z)((0,l.Z)({},e),{},{products:n})})))},onChange:function(e){return jt(t,"sellingPrice",e.target.value)},value:e.sellingPrice,size:"small"})},center:"true"},{name:"GST Value",selector:function(e){return e.product.gstValue},center:"true"},{name:"Discount",selector:function(e){return e.discount},cell:function(e,t){return(0,V.jsx)(h.Z,{value:e.discount,size:"small",type:"number",onBlur:function(){if(0===e.discount.length){var n=(0,a.Z)(Te.products),r=(0,l.Z)({},n[t]);r.discount="0",n[t]=r,qe((function(e){return(0,l.Z)((0,l.Z)({},e),{},{products:n})}))}},onChange:function(e){return jt(t,"discount",e.target.value)},InputProps:{endAdornment:(0,V.jsx)(Z.Z,{position:"end",children:(0,V.jsx)(O.Z,{fontSize:"small"})})}})},center:"true"},{name:"Net Amount",selector:function(e){return parseInt(e.quantity?e.quantity:0,10)*parseInt(e.sellingPrice?e.sellingPrice:0,10)},center:"true"},{name:"Actions",cell:function(e,t){return(0,V.jsx)(y.Z,{onClick:function(){return function(e,t){console.log("deleting product...");var n=(0,a.Z)(Te.products);n.splice(t,1),qe((function(e){return(0,l.Z)((0,l.Z)({},e),{},{products:n})}))}(0,t)},color:"error",variant:"outlined",children:(0,V.jsx)(z.Z,{})})},center:"true"}],kt=new Intl.NumberFormat("hi-In",{style:"currency",currency:"INR"}).format;var Ct=Te.products.reduce((function(e,t){var n=function(e){return parseInt(0===e.sellingPrice.length?0:e.sellingPrice,10)*parseInt(0===e.quantity.length?0:e.quantity,10)*(parseInt(0===e.discount.length?0:e.discount,10)/100)}(t);return e+n}),0),St=Te.products.reduce((function(e,t){return e+parseInt(0===t.sellingPrice.length?0:t.sellingPrice,10)*parseInt(0===t.quantity.length?0:t.quantity,10)}),0),wt=0;Object.keys(Te.offer).length>0&&(wt="PERCENTAGE"===Te.offer.type?St*Te.offer.typeValue/100:Te.offer.typeValue);var Dt=St-(Ct+wt);return(0,V.jsxs)(u.Z,{maxWidth:!n.themeStretch&&"xl",children:[(0,V.jsx)(d.Z,{variant:"h4",children:" Sales "}),(0,V.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",marginTop:"20px"},children:[(0,V.jsxs)(v.Z,{direction:"row",spacing:1,children:[(0,V.jsx)(g.Z,{label:"Total  ".concat(E.MG.format(Ge.totalSalesAmount)),variant:"contained",sx:{backgroundColor:"#CBF0FF"}}),(0,V.jsx)(g.Z,{label:"Paid  ".concat(E.MG.format(Ge.totalPaidAmount)),variant:"contained",sx:{backgroundColor:"#CBFFE0"}}),(0,V.jsx)(g.Z,{label:"Pending  ".concat(E.MG.format(Ge.pendingAmount)),variant:"contained",sx:{backgroundColor:"#FFF7CB"}})]}),(0,V.jsx)(v.Z,{children:(0,V.jsx)(f.Z,{variant:"contained",color:"primary",startIcon:(0,V.jsx)(D.Z,{}),onClick:function(){qe((function(e){return(0,l.Z)((0,l.Z)({},e),{},{invoiceDate:M()(new Date)})})),ae(!0)},children:"CREATE SALES ORDER"})})]}),(0,V.jsxs)("div",{style:{marginTop:"20px"},children:[(0,V.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"10px"},children:[(0,V.jsx)("div",{style:{display:"flex",marginTop:"8px"},children:(0,V.jsx)(h.Z,{placeholder:"Search",size:"small",InputProps:{startAdornment:(0,V.jsx)(Z.Z,{position:"start",children:(0,V.jsx)(A.Z,{})})}})}),(0,V.jsx)("div",{children:(0,V.jsx)(q._,{dateAdapter:B.y,children:(0,V.jsx)(T.C,{components:["SingleInputDateRangeField"],children:(0,V.jsx)(_.n,{size:"small",label:"Date Range",value:X,onChange:function(e){return ee(e)}})})})})]}),(0,V.jsx)("div",{style:{marginTop:"20px"},children:(0,V.jsx)(F.ZP,{columns:bt,data:He,pagination:!0,progressPending:Oe})})]}),(0,V.jsx)(b.Z,{open:re,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,V.jsxs)(j.Z,{sx:L,children:[(0,V.jsxs)(P.ZP,{container:!0,columnGap:2,sx:{backgroundColor:"white",padding:"15px",borderRadius:"10px",display:"flex",justifyContent:"space-between",gap:"10px"},children:[(0,V.jsx)(P.ZP,{item:!0,xs:3,children:(0,V.jsx)(k.Z,{value:Te.customer,options:ce,getOptionLabel:function(e){return e.name?e.name:e},fullWidth:!0,onChange:function(e,t){qe((function(e){return(0,l.Z)((0,l.Z)({},e),{},{customer:t||null,mobileNumber:t?t.mobileNumber.slice(3):""})}))},onInputChange:function(e,t){qe((function(e){return(0,l.Z)((0,l.Z)({},e),{},{customer:t})}))},renderInput:function(e){return(0,V.jsx)(h.Z,(0,l.Z)((0,l.Z)({},e),{},{label:"Search Customers",fullWidth:!0}))},freeSolo:!0})}),(0,V.jsx)(P.ZP,{item:!0,xs:3,children:(0,V.jsx)(h.Z,{type:"number",label:"Mobile Number",InputProps:{startAdornment:(0,V.jsxs)(Z.Z,{position:"start",children:[(0,V.jsx)(U.Z,{})," +91"]})},value:Te.mobileNumber,fullWidth:!0,onChange:function(e){e.target.value.length>10||qe((function(t){return(0,l.Z)((0,l.Z)({},t),{},{mobileNumber:e.target.value})}))}})}),(0,V.jsx)(P.ZP,{item:!0,xs:3,children:(0,V.jsx)(k.Z,{value:Te.salesMan,options:pe,getOptionLabel:function(e){return e.name},fullWidth:!0,onChange:function(e,t){qe((function(e){return(0,l.Z)((0,l.Z)({},e),{},{salesMan:t})}))},renderInput:function(e){return(0,V.jsx)(h.Z,(0,l.Z)((0,l.Z)({},e),{},{label:"Sales Man",fullWidth:!0}))}})}),(0,V.jsxs)(P.ZP,{container:!0,sx:{display:"flex",gap:"136px"},children:[(0,V.jsx)(P.ZP,{item:!0,xs:3,children:(0,V.jsx)(q._,{dateAdapter:B.y,children:(0,V.jsx)(W.M,{label:"Invoice Date",value:Te.invoiceDate,onChange:function(e){qe((function(t){return(0,l.Z)((0,l.Z)({},t),{},{invoiceDate:e})}))},format:"DD/MM/YYYY",slotProps:{textField:{fullWidth:!0}}})})}),(0,V.jsx)(P.ZP,{item:!0,xs:3,children:(0,V.jsx)(q._,{dateAdapter:B.y,children:(0,V.jsx)(W.M,{label:"Invoice Due Date",format:"DD/MM/YYYY",value:Te.invoiceDueDate,minDate:Te.invoiceDate,onChange:function(e){qe((function(t){return(0,l.Z)((0,l.Z)({},t),{},{invoiceDueDate:e})}))},slotProps:{textField:{fullWidth:!0}}})})})]})]}),(0,V.jsxs)(P.ZP,{container:!0,sx:{backgroundColor:"white",padding:"15px",borderRadius:"10px",display:"flex",justifyContent:"space-between"},alignItems:"center",children:[(0,V.jsxs)(P.ZP,{item:!0,xs:12,md:7,display:"flex",children:[(0,V.jsxs)(C.Z,{sx:{width:"35%"},children:[(0,V.jsx)(S.Z,{id:"demo-simple-select-label",children:"All Categories"}),(0,V.jsxs)(w.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",label:"All Categories",value:Re.category,onChange:function(e){Fe((function(t){return(0,l.Z)((0,l.Z)({},t),{},{category:e.target.value,product:null,quantity:null})}))},children:[(0,V.jsx)(x.Z,{value:"All Categories",children:"All Categories"}),he.map((function(e,t){return(0,V.jsx)(x.Z,{value:e.name,children:e.name},t)}))]})]}),(0,V.jsx)(k.Z,{options:ke.filter((function(e){return!Re.category||"All Categories"===Re.category||e.category.name===Re.category})),value:null!==(e=null===Re||void 0===Re?void 0:Re.product)&&void 0!==e?e:null,onChange:function(e,t){Fe(t?function(e){return(0,l.Z)((0,l.Z)({},e),{},{product:t})}:function(e){return(0,l.Z)((0,l.Z)({},e),{},{product:null})})},getOptionLabel:function(e){return null===e||void 0===e?void 0:e.name},fullWidth:!0,renderInput:function(e){return(0,V.jsx)(h.Z,(0,l.Z)((0,l.Z)({},e),{},{label:"Search Products",fullWidth:!0}))}})]}),(0,V.jsx)(P.ZP,{item:!0,xs:12,md:2,children:(0,V.jsx)(h.Z,{label:"Quantity",type:"number",onChange:function(e){return Fe((function(t){return(0,l.Z)((0,l.Z)({},t),{},{quantity:e.target.value})}))},value:Re.quantity})}),(0,V.jsx)(P.ZP,{item:!0,xs:12,md:2,children:(0,V.jsx)(f.Z,{startIcon:(0,V.jsx)(D.Z,{}),disabled:null===Re.product||null===Re.quantity||Re.quantity<=0,variant:"contained",color:"primary",onClick:function(){if(Te.products.find((function(e){return e.product.name===Re.product.name})))r("Product already added!",{variant:"error"});else{var e=ke.find((function(e){return e.name===Re.product.name}));if(e&&e.quantity<Re.quantity)r("Product quantity not available!",{variant:"error"});else{var t={product:Re.product,sellingPrice:Re.product.sellingPrice,quantity:Re.quantity,category:Re.category,discount:0};qe((function(e){return(0,l.Z)((0,l.Z)({},e),{},{products:[].concat((0,a.Z)(e.products),[t])})})),console.log(Re),Fe(Q)}}},fullWidth:!0,children:"ADD TO ORDER"})})]}),Te.products.length>0&&(0,V.jsxs)(P.ZP,{container:!0,sx:{backgroundColor:"white",padding:"15px",borderRadius:"10px"},alignItems:"center",children:[(0,V.jsx)(P.ZP,{item:!0,xs:12,children:(0,V.jsx)(F.ZP,{columns:Pt,data:Te.products})}),(0,V.jsx)(P.ZP,{item:!0,xs:12,display:"flex",justifyContent:"flex-end",sx:{mt:2},children:(0,V.jsxs)("div",{children:[(0,V.jsx)("div",{children:"Apply Offer to all products"}),(0,V.jsx)("div",{style:{paddingTop:"5px"},children:0===Object.keys(Te.offer).length?(0,V.jsxs)(C.Z,{fullWidth:!0,size:"small",children:[(0,V.jsx)(S.Z,{id:"demo-simple-select-label",children:"Select Offer"}),(0,V.jsx)(w.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",label:"Select Offer",value:null!==(t=Te.offer)&&void 0!==t?t:"",onChange:function(e){return qe((function(t){return(0,l.Z)((0,l.Z)({},t),{},{offer:e.target.value})}))},children:De.map((function(e,t){return(0,V.jsx)(x.Z,{value:e,children:e.code},t)}))})]}):(0,V.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,V.jsx)(g.Z,{variant:"contained",color:"primary",label:"Offer Applied : ".concat(Te.offer.code),onDelete:function(){qe((function(e){return(0,l.Z)((0,l.Z)({},e),{},{offer:{}})}))}}),(0,V.jsx)(d.Z,{variant:"caption",gutterBottom:!0,children:"PERCENTAGE"===Te.offer.type?"".concat(Te.offer.typeValue,"% Off"):"".concat(kt(Te.offer.typeValue)," Off")})]})})]})})]}),(0,V.jsx)(P.ZP,{container:!0,display:"flex",justifyContent:"flex-end",children:(0,V.jsx)(P.ZP,{item:!0,xs:12,md:6,lg:6,sx:{backgroundColor:"white",padding:"15px",borderRadius:"10px"},children:(0,V.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,V.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,V.jsx)("div",{children:"Product Discount"}),(0,V.jsx)("div",{children:0===Te.products.length?kt(0):kt(Ct)})]}),0!==Object.keys(Te.offer).length?(0,V.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,V.jsx)("div",{children:"Offer Discount"}),(0,V.jsx)("div",{children:kt(wt)})]}):null,(0,V.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,V.jsx)("div",{children:"Total Amount"}),(0,V.jsx)("div",{children:0===Te.products.length?kt(0):kt(St)})]})]})})}),(0,V.jsx)(P.ZP,{container:!0,display:"flex",justifyContent:"flex-end",children:(0,V.jsxs)(P.ZP,{item:!0,xs:12,md:6,lg:6,sx:{backgroundColor:"white",padding:"15px",borderRadius:"10px",display:"flex",flexDirection:"column",gap:"10px"},children:[(0,V.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:"10px"},children:[(0,V.jsx)(h.Z,{fullWidth:!0,size:"small",label:"Enter Amount",onBlur:function(e){e.target.value>St&&(r("Amount to pay cannot be greater than total amount!",{variant:"error"}),qe((function(e){return(0,l.Z)((0,l.Z)({},e),{},{amountToPay:St})})))},value:Te.amountToPay,onChange:function(e){return qe((function(t){return(0,l.Z)((0,l.Z)({},t),{},{amountToPay:e.target.value})}))}}),(0,V.jsxs)(C.Z,{fullWidth:!0,size:"small",children:[(0,V.jsx)(S.Z,{id:"demo-simple-select-label",children:"Select Payment Status"}),(0,V.jsx)(w.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",label:"Select Payment Status",value:Te.paymentStatus,onChange:function(e){return qe((function(t){return(0,l.Z)((0,l.Z)({},t),{},{paymentStatus:e.target.value})}))},children:E.y0.paymentStatus.map((function(e,t){return(0,V.jsx)(x.Z,{value:e,children:e},t)}))})]})]}),(0,V.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:"10px"},children:[(0,V.jsxs)(C.Z,{fullWidth:!0,size:"small",children:[(0,V.jsx)(S.Z,{id:"demo-simple-select-label",children:"Select Payment Mode"}),(0,V.jsx)(w.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",label:"Select Payment Mode",value:Te.paymentMode,onChange:function(e){return qe((function(t){return(0,l.Z)((0,l.Z)({},t),{},{paymentMode:e.target.value})}))},children:E.y0.paymentMode.map((function(e,t){return(0,V.jsx)(x.Z,{value:e,children:e},t)}))})]}),(0,V.jsxs)(C.Z,{fullWidth:!0,size:"small",children:[(0,V.jsx)(S.Z,{id:"demo-simple-select-label",children:"Select Bank"}),(0,V.jsx)(w.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",label:"Select Bank",value:Te.bank,onChange:function(e){return qe((function(t){return(0,l.Z)((0,l.Z)({},t),{},{bank:e.target.value})}))},children:ge.map((function(e,t){return(0,V.jsx)(x.Z,{value:e._id,children:e.bankName})}))})]})]})]})}),(0,V.jsx)(P.ZP,{container:!0,children:(0,V.jsxs)(P.ZP,{item:!0,xs:12,md:12,lg:12,sx:{backgroundColor:"white",p:"15px",borderRadius:"10px"},display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,V.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-around",gap:"20px"},children:[(0,V.jsx)("div",{children:"Total  :"}),(0,V.jsx)("div",{children:0===Te.products.length?kt(0):kt(Dt)})]}),(0,V.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,V.jsx)(f.Z,{variant:"contained",onClick:function(){var e=(0,l.Z)({},Te);e.discount={},e.discount.productDiscount=Ct,Object.keys(Te.offer).length>0&&(e.discount.offer={},e.discount.offer.discount=wt,e.discount.offer.id=Te.offer._id),e.totalDiscount=Ct+wt,e.totalAmount=Dt,e.invoiceDueDate=M()(e.invoiceDueDate).format("YYYY-MM-DD");var t=localStorage.getItem(N._.keyUserToken),n=(0,E.sw)(t);Y.ZP.post(Y.Hv.sales.add,e,{headers:{Authorization:"Bearer ".concat(n)}}).then((function(e){r("Sales order created successfully!",{variant:"success"}),ae(!1),oe(),yt()})).catch((function(e){r(e.error||e.err,{variant:"error"})}))},color:"primary",disabled:!Te.customer||!Te.mobileNumber||!Te.salesMan||!Te.invoiceDueDate||0===Te.products.length||!Te.amountToPay||!Te.paymentMode||!Te.paymentStatus||0===Te.bank.length,children:"SAVE"}),(0,V.jsx)(f.Z,{variant:"contained",color:"error",onClick:function(){ae(!1),oe()},children:"CANCEL"})]})]})})]})}),(0,V.jsx)(b.Z,{id:"paymentModal",open:lt,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,V.jsx)(j.Z,{sx:G,children:(0,V.jsxs)(P.ZP,{container:!0,sx:{display:"flex",flexDirection:"column",gap:"10px"},children:[(0,V.jsx)(P.ZP,{item:!0,xs:12,children:(0,V.jsx)(d.Z,{variant:"h6",children:"Customer Details"})}),(0,V.jsx)(P.ZP,{item:!0,xs:12,children:(0,V.jsx)(h.Z,{label:"Name",value:dt.name,disabled:!0,sx:{backgroundColor:"white",borderRadius:"7px"},fullWidth:!0})}),(0,V.jsx)(P.ZP,{item:!0,xs:12,children:(0,V.jsx)(h.Z,{label:"Balance",value:dt.balance,disabled:!0,sx:{backgroundColor:"white",borderRadius:"7px"},fullWidth:!0})}),(0,V.jsx)(P.ZP,{item:!0,xs:12,children:(0,V.jsx)(d.Z,{variant:"h6",children:"Payment Details"})}),(0,V.jsx)(P.ZP,{item:!0,xs:12,children:(0,V.jsx)(h.Z,{label:"Amount To Pay",value:dt.amountToPay,onBlur:function(){dt.amountToPay>dt.balance&&(r("Amount to pay cannot be greater than balance!",{variant:"error"}),pt((function(e){return(0,l.Z)((0,l.Z)({},e),{},{amountToPay:dt.balance})})))},onChange:function(e){return pt((function(t){return(0,l.Z)((0,l.Z)({},t),{},{amountToPay:e.target.value})}))},sx:{backgroundColor:"white",borderRadius:"7px"},fullWidth:!0})}),(0,V.jsx)(P.ZP,{item:!0,xs:12,children:(0,V.jsx)(q._,{dateAdapter:B.y,children:(0,V.jsx)(W.M,{label:"Payment Date",value:dt.paymentDate,maxDate:M()(new Date),onChange:function(e){pt((function(t){return(0,l.Z)((0,l.Z)({},t),{},{paymentDate:e})}))},sx:{backgroundColor:"white",borderRadius:"7px"},format:"DD/MM/YYYY",slotProps:{textField:{fullWidth:!0}}})})}),(0,V.jsx)(P.ZP,{item:!0,xs:12,children:(0,V.jsxs)(C.Z,{fullWidth:!0,children:[(0,V.jsx)(S.Z,{id:"record-payment-mode",children:"Select Payment Mode"}),(0,V.jsx)(w.Z,{labelId:"record-payment-mode",id:"demo-simple-select",label:"Select Payment Mode",sx:{backgroundColor:"white",borderRadius:"7px"},value:dt.paymentMode,onChange:function(e){return pt((function(t){return(0,l.Z)((0,l.Z)({},t),{},{paymentMode:e.target.value})}))},children:E.y0.paymentMode.map((function(e,t){return(0,V.jsx)(x.Z,{value:e,children:e},t)}))})]})}),"CASH"!==dt.paymentMode&&(0,V.jsx)(P.ZP,{item:!0,xs:12,children:(0,V.jsxs)(C.Z,{fullWidth:!0,children:[(0,V.jsx)(S.Z,{id:"select-bank",children:"Select Bank"}),(0,V.jsx)(w.Z,{labelId:"select-bank",id:"demo-simple-select",label:"Select Bank",value:dt.bank,sx:{backgroundColor:"white",borderRadius:"7px"},onChange:function(e){return pt((function(t){return(0,l.Z)((0,l.Z)({},t),{},{paymentMode:e.target.value})}))},children:E.y0.paymentMode.map((function(e,t){return(0,V.jsx)(x.Z,{value:e,children:e},t)}))})]})}),(0,V.jsxs)(P.ZP,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[(0,V.jsx)(f.Z,{variant:"contained",color:"primary",onClick:function(){var e={};e.salesOrderId=dt.salesOrderId,e.amountToPay=dt.amountToPay,e.paymentDate=dt.paymentDate,e.paymentMode=dt.paymentMode,dt.bank.length>0&&(e.bank=dt.bank);var t=localStorage.getItem(N._.keyUserToken),n=(0,E.sw)(t);Y.ZP.post(Y.Hv.sales.recordPayment,e,{headers:{Authorization:"Bearer ".concat(n)}}).then((function(e){r("Sales order payment recorded successfully!",{variant:"success"}),ct(!1),pt(K),yt()})).catch((function(e){r(e.error,{variant:"error"})}))},disabled:!dt.amountToPay||!dt.paymentMode||"CASH"!==dt.paymentMode&&!dt.bank,children:"Update Payment"}),(0,V.jsx)(f.Z,{variant:"contained",color:"error",onClick:function(){ct(!1),pt(K)},children:"Cancel"})]})]})})})]})}function X(){return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(r.ql,{children:(0,V.jsx)("title",{children:" Dashboard : Sales"})}),(0,V.jsx)(J,{})]})}},42716:function(e,t,n){var r=n(64836);t.Z=void 0;var a=r(n(45649)),o=n(80184);t.Z=(0,a.default)((0,o.jsx)("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02z"}),"Phone")}}]);
//# sourceMappingURL=571.742fb663.chunk.js.map