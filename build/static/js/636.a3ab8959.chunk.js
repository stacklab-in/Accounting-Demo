"use strict";(self.webpackChunk_accounting_billing_stacklab=self.webpackChunk_accounting_billing_stacklab||[]).push([[636],{32869:function(e,t,n){n.d(t,{Ds:function(){return r.Ds}});var r=n(58518);n(58764)},78636:function(e,t,n){n.r(t),n.d(t,{default:function(){return ee}});var r=n(6907),a=n(93433),o=n(74165),l=n(15861),i=n(1413),s=n(29439),u=n(72791),c=n(89164),d=n(4567),p=n(57088),m=n(30439),h=n(71715),f=n(82626),x=n(48550),v=n(13400),Z=n(36314),g=n(85771),y=n(73590),b=n(64554),j=n(89744),P=n(61889),k=n(68096),S=n(50168),C=n(58406),w=n(63466),D=n(5574),A=n(65661),M=n(39157),T=n(97123),I=n(42419),F=n(5403),Y=n(97892),_=n.n(Y),R=n(71652),z=n(24750),B=n(26759),q=n(43513),H=n(23937),N=n(27247),E=n(18406),W=n(52073),U=n(99615),G=n(32869),L=n(8976),O=n(80184),V={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"75%",borderRadius:"10px",height:"90%",overflowY:"auto",boxShadow:24,display:"flex",flexDirection:"column",justifyContent:"space-between",bgcolor:E.$_.modalbackground,gap:"10px",p:2},Q={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"400px",bgcolor:E.$_.modalbackground,borderRadius:"10px",height:"auto",boxShadow:24,p:2},$={vendor:null,purchaseDate:null,purchaseDueDate:null,referenceNumber:"",products:[],offer:"",amountToPay:"",totalAmount:0,productDiscount:0,paymentMode:"",paymentStatus:"",bank:""},K={id:"",name:"",balance:0,amountToPay:0,paymentMode:"",bank:"",paymentDate:_()(new Date)},J={category:"All Categories",product:null,quantity:"",netAmount:null,discount:null,sellingPrice:null};function X(){var e,t,n,r=(0,p.K$)(),Y=(0,G.Ds)().enqueueSnackbar,X=(0,u.useState)(""),ee=(0,s.Z)(X,2),te=(ee[0],ee[1]),ne=(0,u.useState)([]),re=(0,s.Z)(ne,2),ae=re[0],oe=re[1],le=(0,L.E)().user,ie=(0,u.useState)((function(){return[_()("2022-04-17"),_()("2022-04-21")]})),se=(0,s.Z)(ie,2),ue=(se[0],se[1],(0,u.useRef)(null)),ce=(0,u.useState)(!1),de=(0,s.Z)(ce,2),pe=de[0],me=de[1],he=(0,u.useState)($),fe=(0,s.Z)(he,2),xe=fe[0],ve=fe[1],Ze=(0,u.useState)([]),ge=(0,s.Z)(Ze,2),ye=ge[0],be=ge[1],je=(0,u.useState)([]),Pe=(0,s.Z)(je,2),ke=(Pe[0],Pe[1],(0,u.useState)([])),Se=(0,s.Z)(ke,2),Ce=Se[0],we=Se[1],De=(0,u.useState)([]),Ae=(0,s.Z)(De,2),Me=Ae[0],Te=Ae[1],Ie=(0,u.useState)([]),Fe=(0,s.Z)(Ie,2),Ye=(Fe[0],Fe[1]),_e=(0,u.useState)(""),Re=(0,s.Z)(_e,2),ze=Re[0],Be=Re[1],qe=(0,u.useState)(J),He=(0,s.Z)(qe,2),Ne=He[0],Ee=He[1],We=(0,u.useState)(!1),Ue=(0,s.Z)(We,2),Ge=Ue[0],Le=Ue[1],Oe=(0,u.useState)([]),Ve=(0,s.Z)(Oe,2),Qe=Ve[0],$e=Ve[1],Ke=(0,u.useState)({totalPurchaseAmount:0,totalPaidAmount:0,pendingAmount:0}),Je=(0,s.Z)(Ke,2),Xe=Je[0],et=Je[1],tt=(0,u.useState)(!1),nt=(0,s.Z)(tt,2),rt=nt[0],at=nt[1],ot=(0,u.useState)(null),lt=(0,s.Z)(ot,2),it=lt[0],st=lt[1],ut=Boolean(it),ct=(0,u.useState)({}),dt=(0,s.Z)(ct,2),pt=dt[0],mt=dt[1],ht=(0,u.useState)(!1),ft=(0,s.Z)(ht,2),xt=ft[0],vt=ft[1],Zt=(0,u.useState)(K),gt=(0,s.Z)(Zt,2),yt=gt[0],bt=gt[1],jt=(0,u.useState)(!1),Pt=(0,s.Z)(jt,2),kt=Pt[0],St=Pt[1],Ct=function(){var e=(0,l.Z)((0,o.Z)().mark((function e(){var t,n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem(W._.keyUserToken),n=(0,E.sw)(t),e.next=5,U.ZP.post(U.Hv.vendor.list,{},{headers:{Authorization:"Bearer ".concat(n)}});case 5:(r=e.sent)&&be(r.data.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),Y("Failed to fetch vendors!",{variant:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),wt=function(){var e=(0,l.Z)((0,o.Z)().mark((function e(){var t,n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem(W._.keyUserToken),n=(0,E.sw)(t),e.next=5,U.ZP.get(U.Hv.purchase.summary,{headers:{Authorization:"Bearer ".concat(n)}});case 5:(r=e.sent)&&et({totalPurchaseAmount:r.data.data.totalPurchaseAmount,totalPaidAmount:r.data.data.totalPaidAmount,pendingAmount:r.data.data.pendingAmount}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),Y("Failed to fetch purchase summary!",{variant:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),Dt=function(){var e=(0,l.Z)((0,o.Z)().mark((function e(){var t,n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem(W._.keyUserToken),n=(0,E.sw)(t),e.next=5,U.ZP.post(U.Hv.product.list,{},{headers:{Authorization:"Bearer ".concat(n)}});case 5:(r=e.sent)&&Te(r.data.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),Y("Failed to fetch products!",{variant:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),At=function(){var e=(0,l.Z)((0,o.Z)().mark((function e(){var t,n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem(W._.keyUserToken),n=(0,E.sw)(t),e.next=5,U.ZP.post(U.Hv.purchase.list,{},{headers:{Authorization:"Bearer ".concat(n)}});case 5:(r=e.sent)&&(Le(!1),$e(r.data.data),oe(r.data.data)),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),Y("Failed to fetch purchase orders!",{variant:"error"}),Le(!1);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),Mt=function(){var e=(0,l.Z)((0,o.Z)().mark((function e(){var t,n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem(W._.keyUserToken),n=(0,E.sw)(t),e.next=5,U.ZP.post(U.Hv.offer.list,{status:["LIVE"]},{headers:{Authorization:"Bearer ".concat(n)}});case 5:(r=e.sent)&&Ye(r.data.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),Y("Failed to fetch offers!",{variant:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),Tt=function(){var e=(0,l.Z)((0,o.Z)().mark((function e(){var t,n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem(W._.keyUserToken),n=(0,E.sw)(t),e.next=5,U.ZP.post(U.Hv.bank.list,{},{headers:{Authorization:"Bearer ".concat(n)}});case 5:(r=e.sent)&&we(r.data.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),Y("Failed to fetch bank accounts!",{variant:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();(0,u.useEffect)((function(){Le(!0),At(),wt(),Ct(),Dt(),Mt(),Tt()}),[]);var It=(0,u.useState)(_()().startOf("month")),Ft=(0,s.Z)(It,2),Yt=Ft[0],_t=Ft[1],Rt=(0,u.useState)(_()().endOf("month")),zt=(0,s.Z)(Rt,2),Bt=zt[0],qt=zt[1];(0,u.useEffect)((function(){if(Yt&&Bt){var e=ae.filter((function(e){var t=_()(e.createdAt);return console.log(Yt,Bt),t.isBetween(Yt,Bt,null,"[]")}));$e(e)}else $e(ae)}),[Yt,Bt]);var Ht=function(){ve($),Ee(J),ve((function(e){return(0,i.Z)((0,i.Z)({},e),{},{vendor:null})}))},Nt=function(e,t,n){var r=(0,a.Z)(xe.products),o=(0,i.Z)({},r[e]);o[t]=n,r[e]=o,console.log("new Product",r[e]),ve((function(e){return(0,i.Z)((0,i.Z)({},e),{},{products:r})}))};console.log("purchase.products",xe.products);var Et=function(){st(null),console.log({tempData:pt}),ve((function(e){return(0,i.Z)((0,i.Z)({},e),{},{vendor:pt.vendorId,purchaseDate:_()(pt.purchaseDate),purchaseDueDate:_()(pt.purchaseDueDate),products:pt.products,paymentMode:pt.payments[pt.payments.length-1].paymentID.paymentMode,paymentStatus:pt.paymentStatus})})),St(!0),me(!0)},Wt=[{name:"Vendor Name",selector:function(e){return e.vendorId.name}},{name:"Product Name",width:"150px",selector:function(e){return e.products.length>1?"".concat(e.products[0].name,", & ").concat(e.products.length-1," more"):e.products[0].name}},{name:"Amount",selector:function(e){return e.totalAmount.toFixed(2)}},{name:"Payment Mode",selector:function(e){return e.payments[0].paymentID.paymentMode}},{name:"Payment Status",selector:function(e){return e.paymentStatus}},{name:"Invoice Number",width:"160px",selector:function(e){return e.invoiceNumber}},{name:"Last Updated",width:"250px",selector:function(e){return(0,E.p6)(e.updatedAt)},sortable:"true"},{name:"Actions",width:"130px",cell:function(e){var t,n;return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(m.Z,{onClick:function(t){st(t.currentTarget),mt(e)},disabled:!(null!==le&&void 0!==le&&null!==(t=le.permissions)&&void 0!==t&&null!==(n=t.purchase)&&void 0!==n&&n.u),style:{color:E.$_.actionButton},variant:"outlined",endIcon:(0,O.jsx)(B.Z,{}),children:"Action"}),(0,O.jsxs)(h.Z,{id:"basic-menu",anchorEl:it,open:ut,onClose:function(){st(null),mt({})},MenuListProps:{"aria-labelledby":"basic-button"},children:[(0,O.jsx)(f.Z,{onClick:Et,children:"Edit"}),(0,O.jsx)(f.Z,{onClick:function(){},children:"Send via Email"}),(0,O.jsx)(f.Z,{onClick:function(){},children:"Send via Whatsapp"}),(0,O.jsx)(f.Z,{onClick:function(){at(!0),st(null)},children:"Delete"}),pt.remainingAmount>0&&(0,O.jsx)(f.Z,{onClick:function(){return st(null),vt(!0),bt((function(e){return(0,i.Z)((0,i.Z)({},e),{},{name:pt.vendorId.name,balance:pt.remainingAmount,id:pt._id})})),void mt({})},children:"Record Payment"})]})]})}}],Ut=[{name:"Product Name",selector:function(e){return e.name}},{name:"Quantity",selector:function(e){return e.quantity},cell:function(e,t){return(0,O.jsx)(x.Z,{disabled:kt,type:"number",autoFocus:t===xe.products.length-1,onBlur:function(n){var r=(0,a.Z)(xe.products),o=(0,i.Z)({},r[t]);(!e.quantity||parseFloat(e.quantity,10)<=0)&&(Y("Quantity cannot be empty",{variant:"error"}),o.quantity="1",r[t]=o,ve((function(e){return(0,i.Z)((0,i.Z)({},e),{},{products:r})})))},onChange:function(e){return Nt(t,"quantity",e.target.value)},value:e.quantity,size:"small"})},center:"true"},{name:"Purchase Price",selector:function(e){return e.sellingPrice},cell:function(e,t){return(0,O.jsx)(x.Z,{type:"number",disabled:kt,onBlur:function(){var n=(0,a.Z)(xe.products),r=(0,i.Z)({},n[t]);(!e.sellingPrice||parseFloat(e.sellingPrice)<=0)&&(r.sellingPrice=String(1),n[t]=r,ve((function(e){return(0,i.Z)((0,i.Z)({},e),{},{products:n})})))},onChange:function(e){return Nt(t,"sellingPrice",e.target.value)},value:e.sellingPrice,size:"small"})},center:"true"},{name:"SGST",selector:function(e){return null===e||void 0===e?void 0:e.sgst},cell:function(e,t){return(0,O.jsx)(x.Z,{disabled:kt||e.igst,type:"number",onBlur:function(e){},onChange:function(e){return Nt(t,"sgst",e.target.value)},value:null===e||void 0===e?void 0:e.sgst,size:"small"})},center:"true"},{name:"CGST",selector:function(e){return null===e||void 0===e?void 0:e.cgst},cell:function(e,t){return(0,O.jsx)(x.Z,{disabled:kt||e.igst,type:"number",onBlur:function(n){var r=(0,a.Z)(xe.products),o=(0,i.Z)({},r[t]);(!e.quantity||parseFloat(e.quantity,10)<=0)&&(Y("Quantity cannot be empty",{variant:"error"}),o.quantity="1",r[t]=o,ve((function(e){return(0,i.Z)((0,i.Z)({},e),{},{products:r})})))},onChange:function(e){return Nt(t,"cgst",e.target.value)},value:null===e||void 0===e?void 0:e.cgst,size:"small"})},center:"true"},{name:"IGST",selector:function(e){return null===e||void 0===e?void 0:e.igst},cell:function(e,t){return(0,O.jsx)(x.Z,{disabled:kt||e.cgst||e.sgst,type:"number",onBlur:function(n){var r=(0,a.Z)(xe.products),o=(0,i.Z)({},r[t]);(!e.quantity||parseFloat(e.quantity,10)<=0)&&(Y("Quantity cannot be empty",{variant:"error"}),o.quantity="1",r[t]=o,ve((function(e){return(0,i.Z)((0,i.Z)({},e),{},{products:r})})))},onChange:function(e){return Nt(t,"igst",e.target.value)},value:null===e||void 0===e?void 0:e.igst,size:"small"})},center:"true"},{name:"Net Amount",selector:function(e){return(parseFloat(e.quantity||0)*parseFloat(e.sellingPrice||0)).toFixed(2)},center:"true"},{name:"Actions",cell:function(e,t){return(0,O.jsx)(v.Z,{disabled:kt,onClick:function(){return function(e,t){console.log("deleting product...");var n=(0,a.Z)(xe.products);n.splice(t,1),ve((function(e){return(0,i.Z)((0,i.Z)({},e),{},{products:n})}))}(0,t)},color:"error",variant:"outlined",children:(0,O.jsx)(N.Z,{})})},center:"true"}],Gt=xe.products.reduce((function(e,t){var n=parseFloat(t.sellingPrice?t.sellingPrice:0);return e+parseFloat(t.quantity?t.quantity:0)*n}),0),Lt=xe.products.reduce((function(e,t){var n=t.sellingPrice*(parseFloat(t.sgst||"0")+parseFloat(t.cgst||"0")+parseFloat(t.igst||"0"))/100;return console.log("\ud83d\ude80 ~ totalGSTAmount ~ gstAmount:",n),e+n}),0),Ot=Gt+Lt,Vt=Qe.filter((function(e){var t,n;return(null===e||void 0===e||null===(t=e.vendorId.name)||void 0===t?void 0:t.toLowerCase().includes(null===ze||void 0===ze?void 0:ze.toLowerCase()))||(null===e||void 0===e||null===(n=e.invoiceNumber)||void 0===n?void 0:n.toLowerCase().includes(null===ze||void 0===ze?void 0:ze.toLowerCase()))}));return(0,O.jsxs)(c.Z,{maxWidth:!r.themeStretch&&"xl",children:[(0,O.jsx)(d.Z,{variant:"h4",children:" Purchase Order "}),(0,O.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",marginTop:"20px"},children:[(0,O.jsxs)(Z.Z,{direction:"row",spacing:1,children:[(0,O.jsx)(g.Z,{label:"Total  ".concat(E.MG.format(Xe.totalPurchaseAmount)),variant:"outlined"}),(0,O.jsx)(g.Z,{label:"Paid  ".concat(E.MG.format(Xe.totalPaidAmount)),variant:"outlined"}),(0,O.jsx)(g.Z,{label:"Pending  ".concat(E.MG.format(Xe.pendingAmount)),variant:"outlined"})]}),(null===le||void 0===le||null===(e=le.permissions)||void 0===e||null===(t=e.purchase)||void 0===t?void 0:t.u)&&(0,O.jsx)(Z.Z,{children:(0,O.jsx)(m.Z,{variant:"contained",color:"primary",startIcon:(0,O.jsx)(I.Z,{}),onClick:function(){me(!0),St(!1),ve((function(e){return(0,i.Z)((0,i.Z)({},e),{},{purchaseDate:_()(new Date)})}))},children:"CREATE PURCHASE ORDER"})})]}),(0,O.jsx)(y.Z,{open:pe,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,O.jsxs)(b.Z,{sx:V,children:[(0,O.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:"10px",backgroundColor:"white",padding:"15px",borderRadius:"10px"},children:[(0,O.jsx)(j.Z,{options:ye,disabled:kt,getOptionLabel:function(e){return e.name},fullWidth:!0,value:xe.vendor,onChange:function(e,t){ve((function(e){return(0,i.Z)((0,i.Z)({},e),{},{vendor:null!==t&&void 0!==t?t:null})}))},renderInput:function(e){return(0,O.jsx)(x.Z,(0,i.Z)((0,i.Z)({},e),{},{label:"Search Vendors",fullWidth:!0}))}}),(0,O.jsx)(R._,{dateAdapter:z.y,children:(0,O.jsx)(H.M,{label:"Purchase Date",value:xe.purchaseDate,onChange:function(e){ve((function(t){return(0,i.Z)((0,i.Z)({},t),{},{purchaseDate:e})}))},format:"DD/MM/YYYY",disabled:kt,slotProps:{textField:{fullWidth:!0}}})}),(0,O.jsx)(x.Z,{label:"Reference Number",type:"text",fullWidth:!0,value:xe.referenceNumber,onChange:function(e){return ve((function(t){return(0,i.Z)((0,i.Z)({},t),{},{referenceNumber:e.target.value})}))}})]}),(0,O.jsx)(P.ZP,{container:!0,sx:{backgroundColor:"white",padding:"15px",borderRadius:"10px",display:"flex",justifyContent:"space-between"},alignItems:"center",children:(0,O.jsx)(P.ZP,{item:!0,xs:12,md:12,display:"flex",children:(0,O.jsx)(j.Z,{options:Me,value:null!==(n=null===Ne||void 0===Ne?void 0:Ne.product)&&void 0!==n?n:null,onChange:function(e,t){t?(Ee((function(e){return(0,i.Z)((0,i.Z)({},e),{},{product:t})})),function(e){if(console.log("\ud83d\ude80 ~ addProductToSales ~ newValue:",e),xe.products.find((function(t){return t.name===e.name})))Y("Product already added!",{variant:"error"});else{var t=Me.find((function(t){return t.name===e.name}));if(t&&t.quantity<e.quantity)Y("Product quantity not available!",{variant:"error"});else{var n={productId:e._id,name:e.name,sellingPrice:e.purchasePrice,quantity:1,sgst:e.sgst||"",cgst:e.cgst||"",igst:e.igst||""};console.log("\ud83d\ude80 ~ addProductToSales ~ productToAdd:",n),ve((function(e){return(0,i.Z)((0,i.Z)({},e),{},{products:[].concat((0,a.Z)(e.products),[n])})})),console.log(e),Ee(J),ue.current&&ue.current.blur()}}}(t)):Ee((function(e){return(0,i.Z)((0,i.Z)({},e),{},{product:null})}))},disabled:kt,getOptionLabel:function(e){return"".concat(e.name)},onInputChange:function(e,t){console.log("\ud83d\ude80 ~ PurchaseOrderPageView ~ newInputValue:",t),te(t)},fullWidth:!0,renderInput:function(e){return(0,O.jsx)(x.Z,(0,i.Z)((0,i.Z)({},e),{},{inputRef:ue,label:"Search Products",fullWidth:!0}))}})})}),xe.products.length>0&&(0,O.jsx)(P.ZP,{container:!0,sx:{backgroundColor:"white",padding:"15px",borderRadius:"10px"},alignItems:"center",children:(0,O.jsx)(P.ZP,{item:!0,xs:12,children:(0,O.jsx)(q.ZP,{columns:Ut,data:xe.products})})}),(0,O.jsx)(P.ZP,{container:!0,display:"flex",justifyContent:"flex-end",children:(0,O.jsx)(P.ZP,{item:!0,xs:12,md:6,lg:6,sx:{backgroundColor:"white",padding:"15px",borderRadius:"10px"},children:(0,O.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,O.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,O.jsx)("div",{children:"GST Amount"}),(0,O.jsx)("div",{children:E.MG.format(Lt)})]}),(0,O.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,O.jsx)("div",{children:"Net Amount"}),(0,O.jsx)("div",{children:0===xe.products.length?E.MG.format(0):E.MG.format(Gt.toFixed(2))})]})]})})}),(0,O.jsx)(P.ZP,{container:!0,display:"flex",justifyContent:"flex-end",children:(0,O.jsxs)(P.ZP,{item:!0,xs:12,md:6,lg:6,sx:{backgroundColor:"white",padding:"15px",borderRadius:"10px",display:"flex",flexDirection:"column",gap:"10px"},children:[(0,O.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:"10px"},children:[(0,O.jsx)(x.Z,{fullWidth:!0,disabled:kt,size:"small",label:"Enter Amount",onBlur:function(e){e.target.value>Ot&&(Y("Amount to pay cannot be greater than total amount!",{variant:"error"}),ve((function(e){return(0,i.Z)((0,i.Z)({},e),{},{amountToPay:Ot.toFixed(2)})})))},value:xe.amountToPay,onChange:function(e){return ve((function(t){return(0,i.Z)((0,i.Z)({},t),{},{amountToPay:e.target.value})}))}}),(0,O.jsxs)(k.Z,{fullWidth:!0,size:"small",children:[(0,O.jsx)(S.Z,{id:"demo-simple-select-label",children:"Select Payment Status"}),(0,O.jsx)(C.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",label:"Select Payment Status",value:xe.paymentStatus,onChange:function(e){return ve((function(t){return(0,i.Z)((0,i.Z)({},t),{},{paymentStatus:e.target.value})}))},children:E.y0.paymentStatus.map((function(e,t){return(0,O.jsx)(f.Z,{value:e,children:e},t)}))})]})]}),(0,O.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:"10px"},children:[(0,O.jsxs)(k.Z,{fullWidth:!0,size:"small",children:[(0,O.jsx)(S.Z,{id:"demo-simple-select-label",children:"Select Payment Mode"}),(0,O.jsx)(C.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",label:"Select Payment Mode",value:xe.paymentMode,disabled:kt,onChange:function(e){return ve((function(t){return(0,i.Z)((0,i.Z)({},t),{},{paymentMode:e.target.value})}))},children:["CASH","CHEQUE"].map((function(e,t){return(0,O.jsx)(f.Z,{value:e,children:e},t)}))})]}),(0,O.jsxs)(k.Z,{fullWidth:!0,size:"small",children:[(0,O.jsx)(S.Z,{id:"demo-simple-select-label",children:"Select Bank"}),(0,O.jsx)(C.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",label:"Select Bank",value:xe.bank,disabled:kt||"CASH"===xe.paymentMode,onChange:function(e){return ve((function(t){return(0,i.Z)((0,i.Z)({},t),{},{bank:e.target.value})}))},children:Ce.map((function(e,t){return(0,O.jsx)(f.Z,{value:e._id,children:e.bankName},t)}))})]})]})]})}),(0,O.jsx)(P.ZP,{container:!0,children:(0,O.jsxs)(P.ZP,{item:!0,xs:12,md:12,lg:12,sx:{backgroundColor:"white",p:"15px",borderRadius:"10px"},display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,O.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-around",gap:"20px"},children:[(0,O.jsx)("div",{children:"Total  :"}),(0,O.jsx)("div",{children:0===xe.products.length?E.MG.format(0):E.MG.format(Ot)})]}),(0,O.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[kt?(0,O.jsx)(m.Z,{variant:"contained",onClick:function(){var e={};e.paymentStatus=xe.paymentStatus,e.id=pt._id,console.log({updatePayload:e});var t=localStorage.getItem(W._.keyUserToken),n=(0,E.sw)(t);U.ZP.post(U.Hv.purchase.update,e,{headers:{Authorization:"Bearer ".concat(n)}}).then((function(e){Y("Purchase order updated successfully!",{variant:"success"}),me(!1),mt({}),Ht(),At(),wt(),St(!1)})).catch((function(e){Y(e.error||"Something went wrong!",{variant:"error"})}))},color:"primary",disabled:!xe.paymentStatus,children:"UPDATE"}):(0,O.jsx)(m.Z,{variant:"contained",onClick:function(){if(parseFloat(xe.amountToPay)<=0)Y("Amount to pay must be greater than 0!",{variant:"error"});else{var e=(0,i.Z)({},xe);e.totalAmount=Number(Ot.toFixed(2)),e.purchaseDueDate=_()(e.purchaseDueDate).format("YYYY-MM-DD"),e.purchaseDate=_()(e.purchaseDate).format("YYYY-MM-DD"),e.amountToPay=parseFloat(e.amountToPay).toFixed(2),delete e.offer,delete e.purchaseDueDate,console.log(e);var t=localStorage.getItem(W._.keyUserToken),n=(0,E.sw)(t);U.ZP.post(U.Hv.purchase.add,e,{headers:{Authorization:"Bearer ".concat(n)}}).then((function(e){Y("Purchase order created successfully!",{variant:"success"}),me(!1),Ht(),At(),wt()})).catch((function(e){Y(e.error||"Something went wrong!",{variant:"error"})}))}},color:"primary",disabled:!xe.vendor||0===xe.products.length||!xe.amountToPay||!xe.paymentMode||!xe.paymentStatus||"CASH"!==xe.paymentMode&&!xe.bank,children:"SAVE"}),(0,O.jsx)(m.Z,{variant:"contained",color:"error",onClick:function(){Ht(),St(!1),me(!1)},children:"CANCEL"})]})]})})]})}),(0,O.jsxs)("div",{style:{marginTop:"20px"},children:[(0,O.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"10px"},children:[(0,O.jsx)("div",{children:(0,O.jsx)(x.Z,{placeholder:"Search",size:"small",value:ze,onChange:function(e){return Be(e.target.value)},InputProps:{startAdornment:(0,O.jsx)(w.Z,{position:"start",children:(0,O.jsx)(F.Z,{})})}})}),(0,O.jsx)("div",{children:(0,O.jsx)(R._,{dateAdapter:z.y,children:(0,O.jsxs)(b.Z,{sx:{display:"flex",flexDirection:"row",gap:"10px",alignItems:"center"},children:[(0,O.jsx)(H.M,{label:"From",format:"DD/MM/YYYY",value:Yt,slotProps:{textField:{size:"small"}},onChange:function(e){_t(e)},renderInput:function(e){return(0,O.jsx)(x.Z,(0,i.Z)({},e))}}),(0,O.jsx)(d.Z,{children:"-"}),(0,O.jsx)(H.M,{label:"To",format:"DD/MM/YYYY",value:Bt,slotProps:{textField:{size:"small"}},onChange:function(e){qt(e)},renderInput:function(e){return(0,O.jsx)(x.Z,(0,i.Z)({},e))}})]})})})]}),(0,O.jsx)("div",{style:{marginTop:"20px"},children:(0,O.jsx)(q.ZP,{columns:Wt,data:Vt,progressPending:Ge,pagination:!0})})]}),(0,O.jsx)(y.Z,{id:"paymentModal",open:xt,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,O.jsx)(b.Z,{sx:Q,children:(0,O.jsxs)(P.ZP,{container:!0,sx:{display:"flex",flexDirection:"column",gap:"10px"},children:[(0,O.jsx)(P.ZP,{item:!0,xs:12,children:(0,O.jsx)(d.Z,{variant:"h6",children:"Customer Details"})}),(0,O.jsx)(P.ZP,{item:!0,xs:12,children:(0,O.jsx)(x.Z,{label:"Name",value:yt.name,disabled:!0,sx:{backgroundColor:"white",borderRadius:"7px"},fullWidth:!0})}),(0,O.jsx)(P.ZP,{item:!0,xs:12,children:(0,O.jsx)(x.Z,{label:"Balance",value:yt.balance,disabled:!0,sx:{backgroundColor:"white",borderRadius:"7px"},fullWidth:!0})}),(0,O.jsx)(P.ZP,{item:!0,xs:12,children:(0,O.jsx)(d.Z,{variant:"h6",children:"Payment Details"})}),(0,O.jsx)(P.ZP,{item:!0,xs:12,children:(0,O.jsx)(x.Z,{label:"Amount To Pay",value:yt.amountToPay,onBlur:function(){yt.amountToPay>yt.balance&&(Y("Amount to pay cannot be greater than balance!",{variant:"error"}),bt((function(e){return(0,i.Z)((0,i.Z)({},e),{},{amountToPay:yt.balance})})))},onChange:function(e){return bt((function(t){return(0,i.Z)((0,i.Z)({},t),{},{amountToPay:e.target.value})}))},sx:{backgroundColor:"white",borderRadius:"7px"},fullWidth:!0})}),(0,O.jsx)(P.ZP,{item:!0,xs:12,children:(0,O.jsx)(R._,{dateAdapter:z.y,children:(0,O.jsx)(H.M,{label:"Payment Date",value:yt.paymentDate,maxDate:_()(new Date),onChange:function(e){bt((function(t){return(0,i.Z)((0,i.Z)({},t),{},{paymentDate:e})}))},sx:{backgroundColor:"white",borderRadius:"7px"},format:"DD/MM/YYYY",slotProps:{textField:{fullWidth:!0}}})})}),(0,O.jsx)(P.ZP,{item:!0,xs:12,children:(0,O.jsxs)(k.Z,{fullWidth:!0,children:[(0,O.jsx)(S.Z,{id:"record-payment-mode",children:"Select Payment Mode"}),(0,O.jsx)(C.Z,{labelId:"record-payment-mode",id:"demo-simple-select",label:"Select Payment Mode",sx:{backgroundColor:"white",borderRadius:"7px"},value:yt.paymentMode,onChange:function(e){return bt((function(t){return(0,i.Z)((0,i.Z)({},t),{},{paymentMode:e.target.value})}))},children:["CASH","CHEQUE"].map((function(e,t){return(0,O.jsx)(f.Z,{value:e,children:e},t)}))})]})}),"CASH"!==yt.paymentMode&&(0,O.jsx)(P.ZP,{item:!0,xs:12,children:(0,O.jsxs)(k.Z,{fullWidth:!0,children:[(0,O.jsx)(S.Z,{id:"select-bank",children:"Select Bank"}),(0,O.jsx)(C.Z,{labelId:"select-bank",id:"demo-simple-select",label:"Select Bank",value:yt.bank,sx:{backgroundColor:"white",borderRadius:"7px"},onChange:function(e){return bt((function(t){return(0,i.Z)((0,i.Z)({},t),{},{bank:e.target.value})}))},children:Ce.map((function(e,t){return(0,O.jsx)(f.Z,{value:e._id,children:e.bankName},t)}))})]})}),(0,O.jsxs)(P.ZP,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[(0,O.jsx)(m.Z,{variant:"contained",color:"primary",onClick:function(){var e={};e.id=yt.id,e.amountToPay=yt.amountToPay,e.paymentDate=_()(yt.paymentDate).format("YYYY-MM-DD"),e.paymentMode=yt.paymentMode,yt.bank.length>0&&(e.bank=yt.bank);var t=localStorage.getItem(W._.keyUserToken),n=(0,E.sw)(t);U.ZP.post(U.Hv.purchase.recordPayment,e,{headers:{Authorization:"Bearer ".concat(n)}}).then((function(e){Y("Purchase order payment recorded successfully!",{variant:"success"}),vt(!1),bt(K),At(),wt()})).catch((function(e){Y(e.error,{variant:"error"})}))},disabled:!yt.amountToPay||!yt.paymentMode||"CASH"!==yt.paymentMode&&!yt.bank,children:"Update Payment"}),(0,O.jsx)(m.Z,{variant:"contained",color:"error",onClick:function(){vt(!1),bt(K)},children:"Cancel"})]})]})})}),(0,O.jsxs)(D.Z,{open:rt,onClose:function(){return at(!1)},children:[(0,O.jsx)(A.Z,{children:"Remove"}),(0,O.jsx)(M.Z,{children:"Are you sure you want to delete this purchase order?"}),(0,O.jsxs)(T.Z,{children:[(0,O.jsx)(m.Z,{onClick:function(){at(!1),mt({})},children:"Cancel"}),(0,O.jsx)(m.Z,{onClick:function(){var e=localStorage.getItem(W._.keyUserToken),t=(0,E.sw)(e),n={headers:{Authorization:"Bearer ".concat(t)}};U.ZP.post(U.Hv.purchase.delete,{id:pt._id},n).then((function(e){e&&(Y("Purchase order deleted successfully!",{variant:"success"}),at(!1),mt({}),At())})).catch((function(e){console.log(e),Y(e.msg||e.error,{variant:"error"})}))},variant:"contained",color:"error",children:"Delete"})]})]})]})}function ee(){return(0,O.jsxs)(O.Fragment,{children:[(0,O.jsx)(r.ql,{children:(0,O.jsx)("title",{children:" Dashboard: Purchase Order"})}),(0,O.jsx)(X,{})]})}},27247:function(e,t,n){var r=n(64836);t.Z=void 0;var a=r(n(45649)),o=n(80184);t.Z=(0,a.default)((0,o.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete")},5403:function(e,t,n){var r=n(64836);t.Z=void 0;var a=r(n(45649)),o=n(80184);t.Z=(0,a.default)((0,o.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search")},65661:function(e,t,n){var r=n(87462),a=n(63366),o=n(72791),l=n(28182),i=n(94419),s=n(4567),u=n(66934),c=n(31402),d=n(17673),p=n(85090),m=n(80184),h=["className","id"],f=(0,u.ZP)(s.Z,{name:"MuiDialogTitle",slot:"Root",overridesResolver:function(e,t){return t.root}})({padding:"16px 24px",flex:"0 0 auto"}),x=o.forwardRef((function(e,t){var n=(0,c.Z)({props:e,name:"MuiDialogTitle"}),s=n.className,u=n.id,x=(0,a.Z)(n,h),v=n,Z=function(e){var t=e.classes;return(0,i.Z)({root:["root"]},d.a,t)}(v),g=o.useContext(p.Z).titleId,y=void 0===g?u:g;return(0,m.jsx)(f,(0,r.Z)({component:"h2",className:(0,l.Z)(Z.root,s),ownerState:v,ref:t,variant:"h6",id:null!=u?u:y},x))}));t.Z=x}}]);
//# sourceMappingURL=636.a3ab8959.chunk.js.map