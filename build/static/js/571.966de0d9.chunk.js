"use strict";(self.webpackChunk_accounting_billing_stacklab=self.webpackChunk_accounting_billing_stacklab||[]).push([[571],{32869:function(e,t,n){n.d(t,{Ds:function(){return r.Ds}});var r=n(58518);n(58764)},36571:function(e,t,n){n.r(t),n.d(t,{default:function(){return re}});var r=n(6907),a=n(93433),o=n(74165),i=n(15861),l=n(1413),s=n(29439),c=n(72791),u=n(89164),d=n(4567),p=n(57088),f=n(30439),m=n(71715),x=n(82626),h=n(93006),Z=n(63466),v=n(13400),y=n(36314),b=n(85771),g=n(73590),j=n(64554),P=n(61889),k=n(89744),C=n(68096),D=n(50168),S=n(58406),w=n(5574),A=n(65661),I=n(39157),M=n(97123),T=n(42419),R=n(5403),_=n(97892),q=n.n(_),N=n(4560),B=n(71652),z=n(24750),O=n(51612),E=n(26759),W=n(43513),Y=n(83932),F=n(27247),H=n(93704),U=n(18406),L=n(52073),V=n(99615),G=n(32869),$=n(42716),Q=n(80184),K={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"75%",bgcolor:U.$_.modalbackground,borderRadius:"10px",height:"90%",overflowY:"auto",boxShadow:24,display:"flex",flexDirection:"column",justifyContent:"space-between",gap:"10px",p:2},J={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"400px",bgcolor:U.$_.modalbackground,borderRadius:"10px",height:"auto",boxShadow:24,p:2},X={customer:null,mobileNumber:"",salesMan:null,invoiceDate:null,invoiceDueDate:null,products:[],offer:"",amountToPay:"",totalAmount:0,productDiscount:0,paymentMode:"",paymentStatus:"",bank:""},ee={category:"All Categories",product:null,quantity:"",netAmount:null,discount:null,sellingPrice:null},te={salesOrderId:"",name:"",balance:0,amountToPay:0,paymentMode:"",bank:"",paymentDate:q()(new Date)};function ne(){var e,t,n,r=(0,p.K$)(),_=(0,G.Ds)().enqueueSnackbar,ne=(0,c.useState)((function(){return[q()("2022-04-17"),q()("2022-04-21")]})),re=(0,s.Z)(ne,2),ae=re[0],oe=re[1],ie=(0,c.useState)(!1),le=(0,s.Z)(ie,2),se=le[0],ce=le[1],ue=function(){Ye(X),Qe(ee),Ye((function(e){return(0,l.Z)((0,l.Z)({},e),{},{customer:null})}))},de=(0,c.useState)(!1),pe=(0,s.Z)(de,2),fe=pe[0],me=pe[1],xe=(0,c.useState)([]),he=(0,s.Z)(xe,2),Ze=he[0],ve=he[1],ye=(0,c.useState)([]),be=(0,s.Z)(ye,2),ge=be[0],je=be[1],Pe=(0,c.useState)([]),ke=(0,s.Z)(Pe,2),Ce=ke[0],De=ke[1],Se=(0,c.useState)([]),we=(0,s.Z)(Se,2),Ae=we[0],Ie=we[1],Me=(0,c.useState)([]),Te=(0,s.Z)(Me,2),Re=Te[0],_e=Te[1],qe=(0,c.useState)([]),Ne=(0,s.Z)(qe,2),Be=Ne[0],ze=Ne[1],Oe=(0,c.useState)(X),Ee=(0,s.Z)(Oe,2),We=Ee[0],Ye=Ee[1],Fe=(0,c.useState)(""),He=(0,s.Z)(Fe,2),Ue=He[0],Le=He[1],Ve=(0,c.useState)(ee),Ge=(0,s.Z)(Ve,2),$e=Ge[0],Qe=Ge[1],Ke=(0,c.useState)(!1),Je=(0,s.Z)(Ke,2),Xe=Je[0],et=Je[1],tt=(0,c.useState)([]),nt=(0,s.Z)(tt,2),rt=nt[0],at=nt[1],ot=(0,c.useState)({totalSalesAmount:0,totalPaidAmount:0,pendingAmount:0}),it=(0,s.Z)(ot,2),lt=it[0],st=it[1],ct=(0,c.useState)(null),ut=(0,s.Z)(ct,2),dt=ut[0],pt=ut[1],ft=Boolean(dt),mt=(0,c.useState)({}),xt=(0,s.Z)(mt,2),ht=xt[0],Zt=xt[1],vt=(0,c.useState)(!1),yt=(0,s.Z)(vt,2),bt=yt[0],gt=yt[1],jt=(0,c.useState)(te),Pt=(0,s.Z)(jt,2),kt=Pt[0],Ct=Pt[1],Dt=(0,c.useState)(!1),St=(0,s.Z)(Dt,2),wt=St[0],At=St[1],It=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var t,n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem(L._.keyUserToken),n=(0,U.sw)(t),e.next=5,V.ZP.post(V.Hv.customer.list,{},{headers:{Authorization:"Bearer ".concat(n)}});case 5:(r=e.sent)&&ve(r.data.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),_("Failed to fetch customers!",{variant:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),Mt=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var t,n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem(L._.keyUserToken),n=(0,U.sw)(t),e.next=5,V.ZP.post(V.Hv.employee.list,{},{headers:{Authorization:"Bearer ".concat(n)}});case 5:(r=e.sent)&&je(r.data.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),_("Failed to fetch employees!",{variant:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),Tt=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var t,n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem(L._.keyUserToken),n=(0,U.sw)(t),e.next=5,V.ZP.post(V.Hv.product.list,{},{headers:{Authorization:"Bearer ".concat(n)}});case 5:(r=e.sent)&&_e(r.data.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),_("Failed to fetch products!",{variant:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),Rt=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var t,n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem(L._.keyUserToken),n=(0,U.sw)(t),e.next=5,V.ZP.post(V.Hv.product.category.list,{},{headers:{Authorization:"Bearer ".concat(n)}});case 5:(r=e.sent)&&De(r.data.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),_("Failed to fetch Categories!",{variant:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),_t=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var t,n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem(L._.keyUserToken),n=(0,U.sw)(t),e.next=5,V.ZP.post(V.Hv.offer.list,{status:["LIVE"]},{headers:{Authorization:"Bearer ".concat(n)}});case 5:(r=e.sent)&&ze(r.data.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),_("Failed to fetch offers!",{variant:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),qt=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var t,n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem(L._.keyUserToken),n=(0,U.sw)(t),e.next=5,V.ZP.post(V.Hv.sales.list,{},{headers:{Authorization:"Bearer ".concat(n)}});case 5:(r=e.sent)&&(et(!1),at(r.data.data)),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),_("Failed to fetch sales orders!",{variant:"error"}),et(!1);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),Nt=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var t,n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem(L._.keyUserToken),n=(0,U.sw)(t),e.next=5,V.ZP.post(V.Hv.bank.list,{},{headers:{Authorization:"Bearer ".concat(n)}});case 5:(r=e.sent)&&Ie(r.data.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),_("Failed to fetch bank accounts!",{variant:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),Bt=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var t,n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem(L._.keyUserToken),n=(0,U.sw)(t),e.next=5,V.ZP.get(V.Hv.sales.summary,{headers:{Authorization:"Bearer ".concat(n)}});case 5:(r=e.sent)&&st({totalSalesAmount:r.data.data.totalSalesAmount,totalPaidAmount:r.data.data.totalPaidAmount,pendingAmount:r.data.data.pendingAmount}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),_("Failed to fetch bank accounts!",{variant:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();(0,c.useEffect)((function(){et(!0),qt(),Bt(),It(),Mt(),Tt(),Rt(),_t(),Nt()}),[]);var zt=[{name:"Customer Name",selector:function(e){return e.customerId.name},sortable:"true",width:"160px"},{name:"Product Name",selector:function(e){return e.products.length>1?"".concat(e.products[0].name,", & ").concat(e.products.length-1," more"):e.products[0].name}},{name:"Amount",selector:function(e){return e.totalAmount.toFixed(2)},sortable:"true"},{name:"Payment Mode",selector:function(e){return e.payments[0].paymentID.paymentMode},sortable:"true"},{name:"Payment Status",selector:function(e){return e.paymentStatus},sortable:"true"},{name:"Invoice Number",width:"160px",selector:function(e){return e.invoiceNumber}},{name:"Last Updated",width:"250px",selector:function(e){return(0,U.p6)(e.updatedAt)},sortable:"true"},{name:"Actions",width:"130px",cell:function(e){return(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(f.Z,{onClick:function(t){pt(t.currentTarget),Zt(e)},style:{color:U.$_.actionButton},variant:"outlined",endIcon:(0,Q.jsx)(E.Z,{}),children:"Action"}),(0,Q.jsxs)(m.Z,{id:"basic-menu",anchorEl:dt,open:ft,onClose:function(){pt(null),Zt({})},MenuListProps:{"aria-labelledby":"basic-button"},children:[(0,Q.jsx)(x.Z,{onClick:Et,children:"Edit"}),(0,Q.jsx)(x.Z,{onClick:function(){},children:"Send via Email"}),(0,Q.jsx)(x.Z,{onClick:function(){},children:"Send via Whatsapp"}),(0,Q.jsx)(x.Z,{onClick:function(){me(!0),pt(null)},children:"Delete"}),ht.remainingAmount>0&&(0,Q.jsx)(x.Z,{onClick:function(){return pt(null),gt(!0),Ct((function(e){return(0,l.Z)((0,l.Z)({},e),{},{name:ht.customerId.name,balance:ht.remainingAmount,salesOrderId:ht._id})})),void Zt({})},children:"Record Payment"})]})]})}}],Ot=function(e,t,n){"discount"===t&&(n<0?(n=0,_("Discount should be between 0 and 100 percent.",{variant:"error"})):n>100&&(n=100,_("Discount should be between 0 and 100 percent.",{variant:"error"}))),"quantity"===t&&n>We.products[e].product.quantity&&(n=We.products[e].product.quantity,_("There are only ".concat(We.products[e].product.quantity," units available."),{variant:"error"}));var r=(0,a.Z)(We.products),o=(0,l.Z)({},r[e]);o[t]=n,r[e]=o,console.log("new Product",r[e]),Ye((function(e){return(0,l.Z)((0,l.Z)({},e),{},{products:r})}))},Et=function(){pt(null),console.log({tempData:ht}),Ye((function(e){var t;return(0,l.Z)((0,l.Z)({},e),{},{customer:ht.customerId,mobileNumber:ht.customerId.mobileNumber.slice(3),salesMan:ht.salesManId,invoiceDate:q()(ht.invoiceDate),invoiceDueDate:q()(ht.invoiceDueDate),products:ht.products,paymentMode:ht.payments[ht.payments.length-1].paymentID.paymentMode,paymentStatus:ht.paymentStatus},(null===ht||void 0===ht||null===(t=ht.discount)||void 0===t?void 0:t.offer)&&{offer:ht.discount.offer.id})})),At(!0),ce(!0)},Wt=[{name:"Product Name",selector:function(e){var t,n;return null!==(t=null===e||void 0===e||null===(n=e.product)||void 0===n?void 0:n.name)&&void 0!==t?t:e.name}},{name:"Quantity",selector:function(e){return e.quantity},cell:function(e,t){return(0,Q.jsx)(h.Z,{disabled:wt,type:"number",onBlur:function(n){var r=(0,a.Z)(We.products),o=(0,l.Z)({},r[t]);e.quantity||(_("Quantity cannot be empty",{variant:"error"}),o.quantity="1",r[t]=o,Ye((function(e){return(0,l.Z)((0,l.Z)({},e),{},{products:r})})))},onChange:function(e){return Ot(t,"quantity",e.target.value)},value:e.quantity,size:"small"})},center:"true"},{name:"Sell Price",selector:function(e){return e.sellingPrice},cell:function(e,t){return(0,Q.jsx)(h.Z,{type:"number",disabled:wt,onBlur:function(){var n=(0,a.Z)(We.products),r=(0,l.Z)({},n[t]);(!e.sellingPrice||r.product.purchasePrice>parseInt(e.sellingPrice,10))&&(_("The product price cannot be lower than its purchase price of ".concat(Yt(We.products[t].product.purchasePrice)),{variant:"error"}),r.sellingPrice=String(r.product.purchasePrice),n[t]=r,Ye((function(e){return(0,l.Z)((0,l.Z)({},e),{},{products:n})})))},onChange:function(e){return Ot(t,"sellingPrice",e.target.value)},value:e.sellingPrice,size:"small"})},center:"true"},{name:"GST Value",selector:function(e){var t,n;return null!==(t=null===e||void 0===e||null===(n=e.product)||void 0===n?void 0:n.gstValue)&&void 0!==t?t:e.gstValue},center:"true"},{name:"Discount",selector:function(e){return e.discount},cell:function(e,t){return(0,Q.jsx)(h.Z,{value:e.discount,size:"small",disabled:wt,type:"number",onBlur:function(){if(0===e.discount.length){var n=(0,a.Z)(We.products),r=(0,l.Z)({},n[t]);r.discount="0",n[t]=r,Ye((function(e){return(0,l.Z)((0,l.Z)({},e),{},{products:n})}))}},onChange:function(e){return Ot(t,"discount",e.target.value)},InputProps:{endAdornment:(0,Q.jsx)(Z.Z,{position:"end",children:(0,Q.jsx)(H.Z,{fontSize:"small"})})}})},center:"true"},{name:"Net Amount",selector:function(e){return parseInt(e.quantity?0:e.quantity,10)*parseInt(e.sellingPrice?0:e.sellingPrice,10)},center:"true"},{name:"Actions",cell:function(e,t){return(0,Q.jsx)(v.Z,{disabled:wt,onClick:function(){return function(e,t){console.log("deleting product...");var n=(0,a.Z)(We.products);n.splice(t,1),Ye((function(e){return(0,l.Z)((0,l.Z)({},e),{},{products:n})}))}(0,t)},color:"error",variant:"outlined",children:(0,Q.jsx)(F.Z,{})})},center:"true"}],Yt=new Intl.NumberFormat("hi-In",{style:"currency",currency:"INR"}).format;var Ft=We.products.reduce((function(e,t){var n=function(e){return parseInt(e.sellingPrice?e.sellingPrice:0,10)*parseInt(e.quantity?e.quantity:0,10)*(parseInt(e.discount?e.discount:0,10)/100)}(t);return e+n}),0),Ht=We.products.reduce((function(e,t){return e+parseInt(t.sellingPrice?t.sellingPrice:0,10)*parseInt(t.quantity?t.quantity:0,10)}),0),Ut=0;Object.keys(We.offer).length>0&&(Ut="PERCENTAGE"===We.offer.type?Ht*We.offer.typeValue/100:We.offer.typeValue);var Lt=Ht-(Ft+Number(Ut)),Vt=rt.filter((function(e){var t,n;return(null===e||void 0===e||null===(t=e.customerId.name)||void 0===t?void 0:t.toLowerCase().includes(null===Ue||void 0===Ue?void 0:Ue.toLowerCase()))||(null===e||void 0===e||null===(n=e.invoiceNumber)||void 0===n?void 0:n.toLowerCase().includes(null===Ue||void 0===Ue?void 0:Ue.toLowerCase()))}));return(0,Q.jsxs)(u.Z,{maxWidth:!r.themeStretch&&"xl",children:[(0,Q.jsx)(d.Z,{variant:"h4",children:" Sales "}),(0,Q.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",marginTop:"20px"},children:[(0,Q.jsxs)(y.Z,{direction:"row",spacing:1,children:[(0,Q.jsx)(b.Z,{label:"Total  ".concat(U.MG.format(lt.totalSalesAmount)),variant:"outlined"}),(0,Q.jsx)(b.Z,{label:"Paid  ".concat(U.MG.format(lt.totalPaidAmount)),variant:"outlined"}),(0,Q.jsx)(b.Z,{label:"Pending  ".concat(U.MG.format(lt.pendingAmount)),variant:"outlined"})]}),(0,Q.jsx)(y.Z,{children:(0,Q.jsx)(f.Z,{variant:"contained",color:"primary",startIcon:(0,Q.jsx)(T.Z,{}),onClick:function(){Ye((function(e){return(0,l.Z)((0,l.Z)({},e),{},{invoiceDate:q()(new Date)})})),ce(!0),At(!1)},children:"CREATE SALES ORDER"})})]}),(0,Q.jsxs)("div",{style:{marginTop:"20px"},children:[(0,Q.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"10px"},children:[(0,Q.jsx)("div",{style:{display:"flex",marginTop:"8px"},children:(0,Q.jsx)(h.Z,{placeholder:"Search",size:"small",value:Ue,onChange:function(e){return Le(e.target.value)},InputProps:{startAdornment:(0,Q.jsx)(Z.Z,{position:"start",children:(0,Q.jsx)(R.Z,{})})}})}),(0,Q.jsx)("div",{children:(0,Q.jsx)(B._,{dateAdapter:z.y,children:(0,Q.jsx)(N.C,{components:["SingleInputDateRangeField"],children:(0,Q.jsx)(O.n,{size:"small",label:"Date Range",value:ae,onChange:function(e){return oe(e)}})})})})]}),(0,Q.jsx)("div",{style:{marginTop:"20px"},children:(0,Q.jsx)(W.ZP,{columns:zt,data:Vt,pagination:!0,progressPending:Xe})})]}),(0,Q.jsx)(g.Z,{open:se,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,Q.jsxs)(j.Z,{sx:K,children:[(0,Q.jsxs)(P.ZP,{container:!0,sx:{backgroundColor:"white",padding:"15px",borderRadius:"10px",display:"flex",justifyContent:"space-between",gap:"10px"},children:[(0,Q.jsx)(P.ZP,{item:!0,xs:3,children:(0,Q.jsx)(k.Z,{disabled:wt,value:We.customer,options:Ze,getOptionLabel:function(e){return e.name?e.name:e},fullWidth:!0,onChange:function(e,t){Ye((function(e){return(0,l.Z)((0,l.Z)({},e),{},{customer:t||null,mobileNumber:t?t.mobileNumber.slice(3):""})}))},onInputChange:function(e,t){Ye((function(e){return(0,l.Z)((0,l.Z)({},e),{},{customer:t})}))},renderInput:function(e){return(0,Q.jsx)(h.Z,(0,l.Z)((0,l.Z)({},e),{},{label:"Search Customers",fullWidth:!0}))},freeSolo:!0})}),(0,Q.jsx)(P.ZP,{item:!0,xs:3,children:(0,Q.jsx)(h.Z,{disabled:wt,type:"number",label:"Mobile Number",InputProps:{startAdornment:(0,Q.jsxs)(Z.Z,{position:"start",children:[(0,Q.jsx)($.Z,{})," +91"]})},value:We.mobileNumber,fullWidth:!0,onChange:function(e){e.target.value.length>10||Ye((function(t){return(0,l.Z)((0,l.Z)({},t),{},{mobileNumber:e.target.value})}))}})}),(0,Q.jsx)(P.ZP,{item:!0,xs:3,children:(0,Q.jsx)(k.Z,{value:We.salesMan,disabled:wt,options:ge,getOptionLabel:function(e){return e.name},fullWidth:!0,onChange:function(e,t){Ye((function(e){return(0,l.Z)((0,l.Z)({},e),{},{salesMan:t})}))},renderInput:function(e){return(0,Q.jsx)(h.Z,(0,l.Z)((0,l.Z)({},e),{},{label:"Sales Man",fullWidth:!0}))}})}),(0,Q.jsxs)(P.ZP,{container:!0,sx:{display:"flex",gap:"136px"},children:[(0,Q.jsx)(P.ZP,{item:!0,xs:3,children:(0,Q.jsx)(B._,{dateAdapter:z.y,children:(0,Q.jsx)(Y.M,{label:"Invoice Date",value:We.invoiceDate,onChange:function(e){Ye((function(t){return(0,l.Z)((0,l.Z)({},t),{},{invoiceDate:e})}))},format:"DD/MM/YYYY",disabled:wt,slotProps:{textField:{fullWidth:!0}}})})}),(0,Q.jsx)(P.ZP,{item:!0,xs:3,children:(0,Q.jsx)(B._,{dateAdapter:z.y,children:(0,Q.jsx)(Y.M,{label:"Invoice Due Date",format:"DD/MM/YYYY",value:We.invoiceDueDate,minDate:We.invoiceDate,onChange:function(e){Ye((function(t){return(0,l.Z)((0,l.Z)({},t),{},{invoiceDueDate:e})}))},slotProps:{textField:{fullWidth:!0}}})})})]})]}),(0,Q.jsxs)(P.ZP,{container:!0,sx:{backgroundColor:"white",padding:"15px",borderRadius:"10px",display:"flex",justifyContent:"space-between"},alignItems:"center",children:[(0,Q.jsxs)(P.ZP,{item:!0,xs:12,md:7,display:"flex",children:[(0,Q.jsxs)(C.Z,{sx:{width:"35%"},children:[(0,Q.jsx)(D.Z,{id:"demo-simple-select-label",children:"All Categories"}),(0,Q.jsxs)(S.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",label:"All Categories",value:$e.category,onChange:function(e){Qe((function(t){return(0,l.Z)((0,l.Z)({},t),{},{category:e.target.value,product:null,quantity:null})}))},disabled:wt,children:[(0,Q.jsx)(x.Z,{value:"All Categories",children:"All Categories"}),Ce.map((function(e,t){return(0,Q.jsx)(x.Z,{value:e.name,children:e.name},t)}))]})]}),(0,Q.jsx)(k.Z,{options:Re.filter((function(e){return!$e.category||"All Categories"===$e.category||e.category.name===$e.category})),value:null!==(e=null===$e||void 0===$e?void 0:$e.product)&&void 0!==e?e:null,onChange:function(e,t){Qe(t?function(e){return(0,l.Z)((0,l.Z)({},e),{},{product:t})}:function(e){return(0,l.Z)((0,l.Z)({},e),{},{product:null})})},disabled:wt,getOptionLabel:function(e){return null===e||void 0===e?void 0:e.name},fullWidth:!0,renderInput:function(e){return(0,Q.jsx)(h.Z,(0,l.Z)((0,l.Z)({},e),{},{label:"Search Products",fullWidth:!0}))}})]}),(0,Q.jsx)(P.ZP,{item:!0,xs:12,md:2,children:(0,Q.jsx)(h.Z,{label:"Quantity",type:"number",disabled:wt,onChange:function(e){return Qe((function(t){return(0,l.Z)((0,l.Z)({},t),{},{quantity:e.target.value})}))},value:$e.quantity})}),(0,Q.jsx)(P.ZP,{item:!0,xs:12,md:2,children:(0,Q.jsx)(f.Z,{startIcon:(0,Q.jsx)(T.Z,{}),disabled:null===$e.product||null===$e.quantity||$e.quantity<=0,variant:"contained",color:"primary",onClick:function(){if(We.products.find((function(e){return e.product.name===$e.product.name})))_("Product already added!",{variant:"error"});else{var e=Re.find((function(e){return e.name===$e.product.name}));if(e&&e.quantity<$e.quantity)_("Product quantity not available!",{variant:"error"});else{var t={product:$e.product,sellingPrice:$e.product.sellingPrice,quantity:$e.quantity,category:$e.category,discount:0};Ye((function(e){return(0,l.Z)((0,l.Z)({},e),{},{products:[].concat((0,a.Z)(e.products),[t])})})),console.log($e),Qe(ee)}}},fullWidth:!0,children:"ADD TO ORDER"})})]}),We.products.length>0&&(0,Q.jsxs)(P.ZP,{container:!0,sx:{backgroundColor:"white",padding:"15px",borderRadius:"10px"},alignItems:"center",children:[(0,Q.jsx)(P.ZP,{item:!0,xs:12,children:(0,Q.jsx)(W.ZP,{columns:Wt,data:We.products})}),(0,Q.jsx)(P.ZP,{item:!0,xs:12,display:"flex",justifyContent:"flex-end",sx:{mt:2},children:(0,Q.jsxs)("div",{children:[!wt&&(0,Q.jsx)("div",{children:"Apply Offer to all products"}),wt?(0,Q.jsx)("div",{style:{paddingTop:"5px"},children:(null===ht||void 0===ht||null===(t=ht.discount)||void 0===t?void 0:t.offer)&&(0,Q.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,Q.jsx)(b.Z,{variant:"contained",color:"primary",label:"Offer Applied : ".concat(ht.discount.offer.id.code),onDelete:wt?void 0:function(){Ye((function(e){return(0,l.Z)((0,l.Z)({},e),{},{offer:{}})}))}}),(0,Q.jsx)(d.Z,{variant:"caption",gutterBottom:!0,children:"PERCENTAGE"===ht.discount.offer.id.type?"".concat(ht.discount.offer.id.typeValue,"% Off"):"".concat(Yt(ht.discount.offer.id.typeValue)," Off")})]})}):(0,Q.jsx)("div",{style:{paddingTop:"5px"},children:0===Object.keys(We.offer).length?(0,Q.jsxs)(C.Z,{fullWidth:!0,size:"small",children:[(0,Q.jsx)(D.Z,{id:"demo-simple-select-label",children:"Select Offer"}),(0,Q.jsx)(S.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",label:"Select Offer",value:null!==(n=We.offer)&&void 0!==n?n:"",onChange:function(e){return Ye((function(t){return(0,l.Z)((0,l.Z)({},t),{},{offer:e.target.value})}))},disabled:wt,children:Be.map((function(e,t){return(0,Q.jsx)(x.Z,{value:e,children:e.code},t)}))})]}):(0,Q.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,Q.jsx)(b.Z,{variant:"contained",color:"primary",label:"Offer Applied : ".concat(We.offer.code),onDelete:function(){Ye((function(e){return(0,l.Z)((0,l.Z)({},e),{},{offer:{}})}))}}),(0,Q.jsx)(d.Z,{variant:"caption",gutterBottom:!0,children:"PERCENTAGE"===We.offer.type?"".concat(We.offer.typeValue,"% Off"):"".concat(Yt(We.offer.typeValue)," Off")})]})})]})})]}),(0,Q.jsx)(P.ZP,{container:!0,display:"flex",justifyContent:"flex-end",children:(0,Q.jsx)(P.ZP,{item:!0,xs:12,md:6,lg:6,sx:{backgroundColor:"white",padding:"15px",borderRadius:"10px"},children:(0,Q.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,Q.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,Q.jsx)("div",{children:"Product Discount"}),(0,Q.jsx)("div",{children:0===We.products.length?Yt(0):Yt(Ft)})]}),0!==Object.keys(We.offer).length?(0,Q.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,Q.jsx)("div",{children:"Offer Discount"}),(0,Q.jsx)("div",{children:Yt(Ut)})]}):null,(0,Q.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,Q.jsx)("div",{children:"Total Amount"}),(0,Q.jsx)("div",{children:0===We.products.length?Yt(0):Yt(Ht)})]})]})})}),(0,Q.jsx)(P.ZP,{container:!0,display:"flex",justifyContent:"flex-end",children:(0,Q.jsxs)(P.ZP,{item:!0,xs:12,md:6,lg:6,sx:{backgroundColor:"white",padding:"15px",borderRadius:"10px",display:"flex",flexDirection:"column",gap:"10px"},children:[(0,Q.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:"10px"},children:[(0,Q.jsx)(h.Z,{fullWidth:!0,disabled:wt,size:"small",label:"Enter Amount",onBlur:function(e){e.target.value>Ht&&(_("Amount to pay cannot be greater than total amount!",{variant:"error"}),Ye((function(e){return(0,l.Z)((0,l.Z)({},e),{},{amountToPay:Ht})})))},value:We.amountToPay,onChange:function(e){return Ye((function(t){return(0,l.Z)((0,l.Z)({},t),{},{amountToPay:e.target.value})}))}}),(0,Q.jsxs)(C.Z,{fullWidth:!0,size:"small",children:[(0,Q.jsx)(D.Z,{id:"demo-simple-select-label",children:"Select Payment Status"}),(0,Q.jsx)(S.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",label:"Select Payment Status",value:We.paymentStatus,onChange:function(e){return Ye((function(t){return(0,l.Z)((0,l.Z)({},t),{},{paymentStatus:e.target.value})}))},children:U.y0.paymentStatus.map((function(e,t){return(0,Q.jsx)(x.Z,{value:e,children:e},t)}))})]})]}),(0,Q.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:"10px"},children:[(0,Q.jsxs)(C.Z,{fullWidth:!0,size:"small",children:[(0,Q.jsx)(D.Z,{id:"demo-simple-select-label",children:"Select Payment Mode"}),(0,Q.jsx)(S.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",label:"Select Payment Mode",value:We.paymentMode,disabled:wt,onChange:function(e){return Ye((function(t){return(0,l.Z)((0,l.Z)({},t),{},{paymentMode:e.target.value})}))},children:U.y0.paymentMode.map((function(e,t){return(0,Q.jsx)(x.Z,{value:e,children:e},t)}))})]}),(0,Q.jsxs)(C.Z,{fullWidth:!0,size:"small",children:[(0,Q.jsx)(D.Z,{id:"demo-simple-select-label",children:"Select Bank"}),(0,Q.jsx)(S.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",label:"Select Bank",value:We.bank,disabled:wt||"CASH"===We.paymentMode,onChange:function(e){return Ye((function(t){return(0,l.Z)((0,l.Z)({},t),{},{bank:e.target.value})}))},children:Ae.map((function(e,t){return(0,Q.jsx)(x.Z,{value:e._id,children:e.bankName},t)}))})]})]})]})}),(0,Q.jsx)(P.ZP,{container:!0,children:(0,Q.jsxs)(P.ZP,{item:!0,xs:12,md:12,lg:12,sx:{backgroundColor:"white",p:"15px",borderRadius:"10px"},display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,Q.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-around",gap:"20px"},children:[(0,Q.jsx)("div",{children:"Total  :"}),(0,Q.jsx)("div",{children:0===We.products.length?Yt(0):Yt(Lt)})]}),(0,Q.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[wt?(0,Q.jsx)(f.Z,{variant:"contained",onClick:function(){var e={};e.invoiceDueDate=q()(We.invoiceDueDate).format("YYYY-MM-DD"),e.paymentStatus=We.paymentStatus,e.id=ht._id,console.log({updatePayload:e});var t=localStorage.getItem(L._.keyUserToken),n=(0,U.sw)(t);V.ZP.post(V.Hv.sales.update,e,{headers:{Authorization:"Bearer ".concat(n)}}).then((function(e){_("Sales order updated successfully!",{variant:"success"}),ce(!1),Zt({}),ue(),qt(),At(!1)})).catch((function(e){_(e.error||e.err,{variant:"error"})}))},color:"primary",disabled:!We.invoiceDueDate||!We.paymentStatus,children:"UPDATE"}):(0,Q.jsx)(f.Z,{variant:"contained",onClick:function(){var e=(0,l.Z)({},We);e.discount={},e.discount.productDiscount=Ft,Object.keys(We.offer).length>0&&(e.discount.offer={},e.discount.offer.discount=Ut,e.discount.offer.id=We.offer),e.totalDiscount=Ft+Ut,e.totalAmount=Lt,e.invoiceDueDate=q()(e.invoiceDueDate).format("YYYY-MM-DD");var t=localStorage.getItem(L._.keyUserToken),n=(0,U.sw)(t);V.ZP.post(V.Hv.sales.add,e,{headers:{Authorization:"Bearer ".concat(n)}}).then((function(e){_("Sales order created successfully!",{variant:"success"}),ce(!1),ue(),qt(),Bt()})).catch((function(e){_(e.error||e.err,{variant:"error"})}))},color:"primary",disabled:!We.customer||!We.mobileNumber||!We.salesMan||!We.invoiceDueDate||0===We.products.length||!We.amountToPay||!We.paymentMode||!We.paymentStatus||"CASH"!==We.paymentMode&&!We.bank,children:"SAVE"}),(0,Q.jsx)(f.Z,{variant:"contained",color:"error",onClick:function(){ce(!1),ue()},children:"CANCEL"})]})]})})]})}),(0,Q.jsx)(g.Z,{id:"paymentModal",open:bt,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,Q.jsx)(j.Z,{sx:J,children:(0,Q.jsxs)(P.ZP,{container:!0,sx:{display:"flex",flexDirection:"column",gap:"10px"},children:[(0,Q.jsx)(P.ZP,{item:!0,xs:12,children:(0,Q.jsx)(d.Z,{variant:"h6",children:"Customer Details"})}),(0,Q.jsx)(P.ZP,{item:!0,xs:12,children:(0,Q.jsx)(h.Z,{label:"Name",value:kt.name,disabled:!0,sx:{backgroundColor:"white",borderRadius:"7px"},fullWidth:!0})}),(0,Q.jsx)(P.ZP,{item:!0,xs:12,children:(0,Q.jsx)(h.Z,{label:"Balance",value:kt.balance,disabled:!0,sx:{backgroundColor:"white",borderRadius:"7px"},fullWidth:!0})}),(0,Q.jsx)(P.ZP,{item:!0,xs:12,children:(0,Q.jsx)(d.Z,{variant:"h6",children:"Payment Details"})}),(0,Q.jsx)(P.ZP,{item:!0,xs:12,children:(0,Q.jsx)(h.Z,{label:"Amount To Pay",value:kt.amountToPay,onBlur:function(){kt.amountToPay>kt.balance&&(_("Amount to pay cannot be greater than balance!",{variant:"error"}),Ct((function(e){return(0,l.Z)((0,l.Z)({},e),{},{amountToPay:kt.balance})})))},onChange:function(e){return Ct((function(t){return(0,l.Z)((0,l.Z)({},t),{},{amountToPay:e.target.value})}))},sx:{backgroundColor:"white",borderRadius:"7px"},fullWidth:!0})}),(0,Q.jsx)(P.ZP,{item:!0,xs:12,children:(0,Q.jsx)(B._,{dateAdapter:z.y,children:(0,Q.jsx)(Y.M,{label:"Payment Date",value:kt.paymentDate,maxDate:q()(new Date),onChange:function(e){Ct((function(t){return(0,l.Z)((0,l.Z)({},t),{},{paymentDate:e})}))},sx:{backgroundColor:"white",borderRadius:"7px"},format:"DD/MM/YYYY",slotProps:{textField:{fullWidth:!0}}})})}),(0,Q.jsx)(P.ZP,{item:!0,xs:12,children:(0,Q.jsxs)(C.Z,{fullWidth:!0,children:[(0,Q.jsx)(D.Z,{id:"record-payment-mode",children:"Select Payment Mode"}),(0,Q.jsx)(S.Z,{labelId:"record-payment-mode",id:"demo-simple-select",label:"Select Payment Mode",sx:{backgroundColor:"white",borderRadius:"7px"},value:kt.paymentMode,onChange:function(e){return Ct((function(t){return(0,l.Z)((0,l.Z)({},t),{},{paymentMode:e.target.value})}))},children:U.y0.paymentMode.map((function(e,t){return(0,Q.jsx)(x.Z,{value:e,children:e},t)}))})]})}),"CASH"!==kt.paymentMode&&(0,Q.jsx)(P.ZP,{item:!0,xs:12,children:(0,Q.jsxs)(C.Z,{fullWidth:!0,children:[(0,Q.jsx)(D.Z,{id:"select-bank",children:"Select Bank"}),(0,Q.jsx)(S.Z,{labelId:"select-bank",id:"demo-simple-select",label:"Select Bank",value:kt.bank,sx:{backgroundColor:"white",borderRadius:"7px"},onChange:function(e){return Ct((function(t){return(0,l.Z)((0,l.Z)({},t),{},{paymentMode:e.target.value})}))},children:U.y0.paymentMode.map((function(e,t){return(0,Q.jsx)(x.Z,{value:e,children:e},t)}))})]})}),(0,Q.jsxs)(P.ZP,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[(0,Q.jsx)(f.Z,{variant:"contained",color:"primary",onClick:function(){var e={};e.salesOrderId=kt.salesOrderId,e.amountToPay=kt.amountToPay,e.paymentDate=kt.paymentDate,e.paymentMode=kt.paymentMode,kt.bank.length>0&&(e.bank=kt.bank);var t=localStorage.getItem(L._.keyUserToken),n=(0,U.sw)(t);V.ZP.post(V.Hv.sales.recordPayment,e,{headers:{Authorization:"Bearer ".concat(n)}}).then((function(e){_("Sales order payment recorded successfully!",{variant:"success"}),gt(!1),Ct(te),qt()})).catch((function(e){_(e.error,{variant:"error"})}))},disabled:!kt.amountToPay||!kt.paymentMode||"CASH"!==kt.paymentMode&&!kt.bank,children:"Update Payment"}),(0,Q.jsx)(f.Z,{variant:"contained",color:"error",onClick:function(){gt(!1),Ct(te)},children:"Cancel"})]})]})})}),(0,Q.jsxs)(w.Z,{open:fe,onClose:function(){return me(!1)},children:[(0,Q.jsx)(A.Z,{children:"Remove"}),(0,Q.jsx)(I.Z,{children:"Are you sure you want to delete this sales order?"}),(0,Q.jsxs)(M.Z,{children:[(0,Q.jsx)(f.Z,{onClick:function(){me(!1),Zt({})},children:"Cancel"}),(0,Q.jsx)(f.Z,{onClick:function(){var e=localStorage.getItem(L._.keyUserToken),t=(0,U.sw)(e),n={headers:{Authorization:"Bearer ".concat(t)}};V.ZP.post(V.Hv.sales.delete,{id:ht._id},n).then((function(e){e&&(_("Sales order deleted successfully!",{variant:"success"}),me(!1),Zt({}),qt(),Bt())})).catch((function(e){console.log(e),_(e.msg||e.error,{variant:"error"})}))},variant:"contained",color:"error",children:"Delete"})]})]})]})}function re(){return(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(r.ql,{children:(0,Q.jsx)("title",{children:" Dashboard : Sales"})}),(0,Q.jsx)(ne,{})]})}},42716:function(e,t,n){var r=n(64836);t.Z=void 0;var a=r(n(45649)),o=n(80184);t.Z=(0,a.default)((0,o.jsx)("path",{d:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02z"}),"Phone")},65661:function(e,t,n){var r=n(87462),a=n(63366),o=n(72791),i=n(28182),l=n(94419),s=n(4567),c=n(66934),u=n(31402),d=n(17673),p=n(85090),f=n(80184),m=["className","id"],x=(0,c.ZP)(s.Z,{name:"MuiDialogTitle",slot:"Root",overridesResolver:function(e,t){return t.root}})({padding:"16px 24px",flex:"0 0 auto"}),h=o.forwardRef((function(e,t){var n=(0,u.Z)({props:e,name:"MuiDialogTitle"}),s=n.className,c=n.id,h=(0,a.Z)(n,m),Z=n,v=function(e){var t=e.classes;return(0,l.Z)({root:["root"]},d.a,t)}(Z),y=o.useContext(p.Z).titleId,b=void 0===y?c:y;return(0,f.jsx)(x,(0,r.Z)({component:"h2",className:(0,i.Z)(v.root,s),ownerState:Z,ref:t,variant:"h6",id:null!=c?c:b},h))}));t.Z=h}}]);
//# sourceMappingURL=571.966de0d9.chunk.js.map