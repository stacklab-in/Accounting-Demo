"use strict";(self.webpackChunk_accounting_billing_stacklab=self.webpackChunk_accounting_billing_stacklab||[]).push([[178],{32869:function(e,t,n){n.d(t,{Ds:function(){return a.Ds}});var a=n(58518);n(58764)},21178:function(e,t,n){n.r(t),n.d(t,{default:function(){return Y}});var a=n(1413),r=n(74165),o=n(15861),s=n(29439),l=n(89164),i=n(4567),u=n(36314),c=n(85771),d=n(30439),m=n(71715),p=n(82626),f=n(48550),x=n(63466),v=n(64554),h=n(6907),y=n(57088),b=n(18406),Z=n(26759),j=n(72791),g=n(52073),A=n(99615),D=n(32869),I=n(43513),k=n(5403),w=n(97892),S=n.n(w),C=n(71652),N=n(23937),_=n(24750),M=n(34045),P=n(35125),T=(n(31052),n(64802)),F=n(80184);function Y(){var e=(0,y.K$)(),t=(0,j.useState)(!1),n=(0,s.Z)(t,2),w=n[0],Y=n[1],B=(0,j.useState)([]),R=(0,s.Z)(B,2),z=R[0],E=R[1],L=(0,j.useState)([]),G=(0,s.Z)(L,2),O=(G[0],G[1]),q=(0,j.useState)(""),U=(0,s.Z)(q,2),W=U[0],$=U[1],H=(0,D.Ds)().enqueueSnackbar,K=(0,j.useState)([]),J=(0,s.Z)(K,2),Q=J[0],V=J[1],X=(0,j.useState)(null),ee=(0,s.Z)(X,2),te=ee[0],ne=ee[1],ae=Boolean(te),re=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(){var t,n,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem(g._.keyUserToken),n=(0,b.sw)(t),e.next=5,A.ZP.post(A.Hv.sales.list,{},{headers:{Authorization:"Bearer ".concat(n)}});case 5:(a=e.sent)&&(Y(!1),E(a.data.data),O(a.data.data),V(a.data.data)),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),H("Failed to fetch sales orders!",{variant:"error"}),Y(!1);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();(0,j.useEffect)((function(){Y(!0),re()}),[]);var oe=(0,j.useState)(S()().startOf("month")),se=(0,s.Z)(oe,2),le=se[0],ie=se[1],ue=(0,j.useState)(S()().endOf("month")),ce=(0,s.Z)(ue,2),de=ce[0],me=ce[1];(0,j.useEffect)((function(){if(le&&de){var e=Q.filter((function(e){var t=S()(e.createdAt);return console.log(le,de),t.isBetween(le,de,null,"[]")}));E(e)}else E(Q)}),[le,de]);var pe=[{name:"Customer Name",selector:function(e){return e.customerId.name},sortable:"true"},{name:"Invoice Number",selector:function(e){return e.invoiceNumber}},{name:"Amount",selector:function(e){return e.totalAmount.toFixed(2)},sortable:"true"},{name:"Payment Mode",selector:function(e){return e.payments[e.payments.length-1].paymentID.paymentMode},sortable:"true"},{name:"Invoice Date",selector:function(e){return new Date(e.createdAt).toLocaleDateString("en-GB",{day:"2-digit",month:"long",year:"numeric"})},sortable:"true"}],fe=z.filter((function(e){var t;return null===e||void 0===e||null===(t=e.customerId.name)||void 0===t?void 0:t.toLowerCase().includes(null===W||void 0===W?void 0:W.toLowerCase())}));return(0,F.jsxs)(l.Z,{maxWidth:!e.themeStretch&&"xl",children:[(0,F.jsx)(h.ql,{children:(0,F.jsx)("title",{children:" Reports: Sales Report"})}),(0,F.jsx)(i.Z,{variant:"h4",children:" Sales Report "}),(0,F.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",marginTop:"20px"},children:[(0,F.jsx)(u.Z,{direction:"row",spacing:1,children:(0,F.jsx)(c.Z,{label:"Total Amount : ".concat(z.length>0?b.MG.format(z.reduce((function(e,t){return e+t.totalAmount}),0)):b.MG.format(0)),variant:"outlined"})}),(0,F.jsxs)(u.Z,{children:[(0,F.jsx)(d.Z,{style:{color:b.$_.actionButton},endIcon:(0,F.jsx)(Z.Z,{}),variant:"outlined",onClick:function(e){return ne(e.currentTarget)},children:"ACTIONS"}),(0,F.jsxs)(m.Z,{id:"basic-menu",anchorEl:te,open:ae,onClose:function(){ne(null),O({})},MenuListProps:{"aria-labelledby":"basic-button"},children:[(0,F.jsx)(p.Z,{onClick:function(){},children:"Print"}),(0,F.jsx)(p.Z,{onClick:function(){ne(null);var e=new P.default;e.text("Sales Report",10,10);var t=fe.map((function(e){var t,n;return[e.customerId.name||"N/A",e.invoiceNumber||"N/A",e.totalAmount.toFixed(2)||"N/A",(null===(t=e.payments[e.payments.length-1])||void 0===t||null===(n=t.paymentID)||void 0===n?void 0:n.paymentMode)||"N/A",e.createdAt?(0,b.p6)(e.createdAt):"N/A"]}));e.autoTable({head:[["Customer Name","Invoice Number","Amount","Payment Mode","Time"]],body:t}),e.save("sales_report.pdf")},children:"Download as PDF"}),(0,F.jsx)(p.Z,{onClick:function(){ne(null);var e=fe.map((function(e){var t,n;return{"Customer Name":e.customerId.name,"Invoice Number":e.invoiceNumber,Amount:e.totalAmount.toFixed(2),"Payment Mode":(null===(t=e.payments[e.payments.length-1])||void 0===t||null===(n=t.paymentID)||void 0===n?void 0:n.paymentMode)||"N/A","Invoice Date":e.createdAt?(0,b.p6)(e.createdAt):"N/A"}})),t=M.P6.book_new(),n=M.P6.json_to_sheet(e);M.P6.book_append_sheet(t,n,"Sales Report");var a=M.cW(t,{bookType:"xlsx",type:"array"}),r=new Blob([a],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});(0,T.saveAs)(r,"sales_report.xlsx")},children:"Download as Excel"})]})]})]}),(0,F.jsxs)("div",{style:{display:"flex",marginTop:"8px",gap:"10px"},children:[(0,F.jsx)(f.Z,{placeholder:"Search",size:"small",value:W,onChange:function(e){return $(e.target.value)},InputProps:{startAdornment:(0,F.jsx)(x.Z,{position:"start",children:(0,F.jsx)(k.Z,{})})}}),(0,F.jsx)("div",{children:(0,F.jsx)(C._,{dateAdapter:_.y,children:(0,F.jsxs)(v.Z,{sx:{display:"flex",flexDirection:"row",gap:"10px",alignItems:"center"},children:[(0,F.jsx)(N.M,{label:"From",format:"DD/MM/YYYY",value:le,slotProps:{textField:{size:"small"}},onChange:function(e){ie(e)},renderInput:function(e){return(0,F.jsx)(f.Z,(0,a.Z)({},e))}}),(0,F.jsx)(i.Z,{children:"-"}),(0,F.jsx)(N.M,{label:"To",format:"DD/MM/YYYY",value:de,slotProps:{textField:{size:"small"}},onChange:function(e){me(e)},renderInput:function(e){return(0,F.jsx)(f.Z,(0,a.Z)({},e))}})]})})})]}),(0,F.jsx)("div",{style:{marginTop:"20px"},children:(0,F.jsx)(I.ZP,{columns:pe,data:fe,pagination:!0,progressPending:w})})]})}}}]);
//# sourceMappingURL=178.7edba25c.chunk.js.map