"use strict";(self.webpackChunk_accounting_billing_stacklab=self.webpackChunk_accounting_billing_stacklab||[]).push([[571],{32869:function(e,t,n){n.d(t,{Ds:function(){return r.Ds}});var r=n(58518);n(58764)},36571:function(e,t,n){n.r(t),n.d(t,{default:function(){return re}});var r=n(6907),a=n(93433),o=n(74165),i=n(15861),l=n(1413),s=n(29439),u=n(72791),c=n(89164),d=n(4567),p=n(57088),m=n(30439),f=n(71715),h=n(82626),x=n(93006),v=n(63466),Z=n(13400),y=n(36314),b=n(85771),g=n(73590),j=n(64554),P=n(89744),C=n(61889),k=n(49900),S=n(68096),w=n(50168),A=n(58406),D=n(5574),I=n(65661),M=n(39157),T=n(97123),N=n(42419),R=n(5403),z=n(97892),B=n.n(z),F=n(4560),_=n(71652),U=n(24750),W=n(51612),E=n(26759),O=n(43513),q=n(98265),H=n(27247),L=n(93704),V=n(18406),$=n(52073),Y=n(99615),G=n(32869),Q=n(80184),K={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"75%",bgcolor:V.$_.modalbackground,borderRadius:"10px",height:"90%",overflowY:"auto",boxShadow:24,display:"flex",flexDirection:"column",justifyContent:"space-between",gap:"10px",p:2},J={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"400px",bgcolor:V.$_.modalbackground,borderRadius:"10px",height:"auto",boxShadow:24,p:2},X={customer:"",mobileNumber:"",salesMan:null,invoiceDate:null,invoiceDueDate:null,products:[],offer:"",amountToPay:"",totalAmount:0,productDiscount:0,paymentMode:"",paymentStatus:"",bank:""},ee={category:"All Categories",product:null,quantity:"",netAmount:null,discount:null,sellingPrice:null},te={salesOrderId:"",name:"",balance:0,amountToPay:0,paymentMode:"",bank:"",paymentDate:B()(new Date)};function ne(){var e,t,n=(0,p.K$)(),r=(0,u.useRef)(null),z=(0,u.useState)(0),ne=(0,s.Z)(z,2),re=ne[0],ae=ne[1],oe=(0,u.useState)(0),ie=(0,s.Z)(oe,2),le=ie[0],se=ie[1],ue=(0,G.Ds)().enqueueSnackbar,ce=(0,u.useState)((function(){return[B()("2022-04-17"),B()("2022-04-21")]})),de=(0,s.Z)(ce,2),pe=de[0],me=de[1],fe=(0,u.useState)(!1),he=(0,s.Z)(fe,2),xe=he[0],ve=he[1],Ze=function(){Ye(X),nt(ee),Ye((function(e){return(0,l.Z)((0,l.Z)({},e),{},{customer:null})})),ae(0),se(0)},ye=(0,u.useState)(!1),be=(0,s.Z)(ye,2),ge=be[0],je=be[1],Pe=(0,u.useState)([]),Ce=(0,s.Z)(Pe,2),ke=Ce[0],Se=Ce[1],we=(0,u.useState)([]),Ae=(0,s.Z)(we,2),De=Ae[0],Ie=Ae[1],Me=(0,u.useState)([]),Te=(0,s.Z)(Me,2),Ne=(Te[0],Te[1],(0,u.useState)([])),Re=(0,s.Z)(Ne,2),ze=Re[0],Be=Re[1],Fe=(0,u.useState)([]),_e=(0,s.Z)(Fe,2),Ue=_e[0],We=_e[1],Ee=(0,u.useState)([]),Oe=(0,s.Z)(Ee,2),qe=Oe[0],He=Oe[1],Le=(0,u.useState)(X),Ve=(0,s.Z)(Le,2),$e=Ve[0],Ye=Ve[1],Ge=(0,u.useState)(""),Qe=(0,s.Z)(Ge,2),Ke=Qe[0],Je=Qe[1],Xe=(0,u.useState)(ee),et=(0,s.Z)(Xe,2),tt=et[0],nt=et[1],rt=(0,u.useState)(!1),at=(0,s.Z)(rt,2),ot=at[0],it=at[1],lt=(0,u.useState)([]),st=(0,s.Z)(lt,2),ut=st[0],ct=st[1],dt=(0,u.useState)({totalSalesAmount:0,totalPaidAmount:0,pendingAmount:0}),pt=(0,s.Z)(dt,2),mt=pt[0],ft=pt[1],ht=(0,u.useState)(null),xt=(0,s.Z)(ht,2),vt=xt[0],Zt=xt[1],yt=Boolean(vt),bt=(0,u.useState)({}),gt=(0,s.Z)(bt,2),jt=gt[0],Pt=gt[1],Ct=(0,u.useState)(!1),kt=(0,s.Z)(Ct,2),St=kt[0],wt=kt[1],At=(0,u.useState)(te),Dt=(0,s.Z)(At,2),It=Dt[0],Mt=Dt[1],Tt=(0,u.useState)(!1),Nt=(0,s.Z)(Tt,2),Rt=Nt[0],zt=Nt[1],Bt=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var t,n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem($._.keyUserToken),n=(0,V.sw)(t),e.next=5,Y.ZP.post(Y.Hv.customer.list,{},{headers:{Authorization:"Bearer ".concat(n)}});case 5:(r=e.sent)&&Se(r.data.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),ue("Failed to fetch customers!",{variant:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),Ft=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var t,n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem($._.keyUserToken),n=(0,V.sw)(t),e.next=5,Y.ZP.post(Y.Hv.employee.list,{},{headers:{Authorization:"Bearer ".concat(n)}});case 5:(r=e.sent)&&Ie(r.data.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),ue("Failed to fetch employees!",{variant:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),_t=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var t,n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem($._.keyUserToken),n=(0,V.sw)(t),e.next=5,Y.ZP.post(Y.Hv.product.list,{},{headers:{Authorization:"Bearer ".concat(n)}});case 5:(r=e.sent)&&We(r.data.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),ue("Failed to fetch products!",{variant:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),Ut=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var t,n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem($._.keyUserToken),n=(0,V.sw)(t),e.next=5,Y.ZP.post(Y.Hv.offer.list,{status:["LIVE"]},{headers:{Authorization:"Bearer ".concat(n)}});case 5:(r=e.sent)&&He(r.data.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),ue("Failed to fetch offers!",{variant:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),Wt=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var t,n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem($._.keyUserToken),n=(0,V.sw)(t),e.next=5,Y.ZP.post(Y.Hv.sales.list,{},{headers:{Authorization:"Bearer ".concat(n)}});case 5:(r=e.sent)&&(it(!1),ct(r.data.data)),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),ue("Failed to fetch sales orders!",{variant:"error"}),it(!1);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),Et=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var t,n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem($._.keyUserToken),n=(0,V.sw)(t),e.next=5,Y.ZP.post(Y.Hv.bank.list,{},{headers:{Authorization:"Bearer ".concat(n)}});case 5:(r=e.sent)&&Be(r.data.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),ue("Failed to fetch bank accounts!",{variant:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),Ot=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var t,n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem($._.keyUserToken),n=(0,V.sw)(t),e.next=5,Y.ZP.get(Y.Hv.sales.summary,{headers:{Authorization:"Bearer ".concat(n)}});case 5:(r=e.sent)&&ft({totalSalesAmount:r.data.data.totalSalesAmount,totalPaidAmount:r.data.data.totalPaidAmount,pendingAmount:r.data.data.pendingAmount}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),ue("Failed to fetch bank accounts!",{variant:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();(0,u.useEffect)((function(){it(!0),Wt(),Ot(),Bt(),Ft(),_t(),Ut(),Et()}),[]);var qt=[{name:"Customer Name",selector:function(e){return e.customerId.name},sortable:"true",width:"160px"},{name:"Sales Man Name",selector:function(e){return e.salesManId.name},sortable:"true",width:"160px"},{name:"Product Name",selector:function(e){return e.products.length>1?"".concat(e.products[0].name,", & ").concat(e.products.length-1," more"):e.products[0].name}},{name:"Amount",selector:function(e){return e.totalAmount.toFixed(2)},sortable:"true"},{name:"Payment Mode",selector:function(e){return e.payments[0].paymentID.paymentMode},sortable:"true"},{name:"Payment Status",selector:function(e){return e.paymentStatus},sortable:"true"},{name:"Invoice Number",selector:function(e){return e.invoiceNumber}},{name:"Voucher Amount",width:"120px",selector:function(e){return 0===e.discount.amount?"N/A":e.discount.amount.toFixed(2)}},{name:"Last Updated",width:"220px",selector:function(e){return(0,V.p6)(e.updatedAt)},sortable:"true"},{name:"Actions",width:"130px",cell:function(e){return(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(m.Z,{onClick:function(t){Zt(t.currentTarget),Pt(e)},style:{color:V.$_.actionButton},variant:"outlined",endIcon:(0,Q.jsx)(E.Z,{}),children:"Action"}),(0,Q.jsxs)(f.Z,{id:"basic-menu",anchorEl:vt,open:yt,onClose:function(){Zt(null),Pt({})},MenuListProps:{"aria-labelledby":"basic-button"},children:[(0,Q.jsx)(h.Z,{onClick:Lt,children:"Edit"}),(0,Q.jsx)(h.Z,{onClick:function(){},children:"Send via Email"}),(0,Q.jsx)(h.Z,{onClick:function(){},children:"Send via Whatsapp"}),(0,Q.jsx)(h.Z,{onClick:function(){je(!0),Zt(null)},children:"Delete"}),jt.remainingAmount>0&&(0,Q.jsx)(h.Z,{onClick:function(){return Zt(null),wt(!0),Mt((function(e){return(0,l.Z)((0,l.Z)({},e),{},{name:jt.customerId.name,balance:jt.remainingAmount,salesOrderId:jt._id})})),void Pt({})},children:"Record Payment"})]})]})}}],Ht=function(e,t,n){"discount"===t&&(n<0?(n=0,ue("Discount should be between 0 and 100 percent.",{variant:"error"})):n>100&&(n=100,ue("Discount should be between 0 and 100 percent.",{variant:"error"}))),"quantity"===t&&n>$e.products[e].product.quantity&&(n=$e.products[e].product.quantity,ue("There are only ".concat($e.products[e].product.quantity," units available."),{variant:"error"}));var r=(0,a.Z)($e.products),o=(0,l.Z)({},r[e]);o[t]=n,r[e]=o,console.log("new Product",r[e]),Ye((function(e){return(0,l.Z)((0,l.Z)({},e),{},{products:r})}))},Lt=function(){Zt(null),ae(jt.discount.amount),se(jt.totalAmount-jt.remainingAmount);var e=jt.products.map((function(e){return{product:Ue.find((function(t){return t.name===e.name})),quantity:e.quantity,sellingPrice:e.sellingPrice,discount:e.discount}}));console.log("\ud83d\ude80 ~ previousProducts ~ previousProducts:",e),Ye((function(t){var n;return(0,l.Z)((0,l.Z)({},t),{},{customer:jt.customerId.name,mobileNumber:ke.find((function(e){return e.mobileNumber===jt.customerId.mobileNumber})),salesMan:jt.salesManId,invoiceDate:B()(jt.invoiceDate),invoiceDueDate:B()(jt.invoiceDueDate),products:e,paymentMode:jt.payments[jt.payments.length-1].paymentID.paymentMode,paymentStatus:jt.paymentStatus},(null===jt||void 0===jt||null===(n=jt.discount)||void 0===n?void 0:n.offer)&&{offer:jt.discount.offer.id})})),zt(!0),ve(!0)},Vt=[{name:"Product Name",selector:function(e){var t,n;return null!==(t=null===e||void 0===e||null===(n=e.product)||void 0===n?void 0:n.name)&&void 0!==t?t:e.name}},{name:"Quantity",selector:function(e){return e.quantity},cell:function(e,t){return(0,Q.jsx)(x.Z,{autoFocus:t===$e.products.length-1,type:"number",onBlur:function(n){var r=(0,a.Z)($e.products),o=(0,l.Z)({},r[t]);(!e.quantity||parseInt(e.quantity,10)<=0)&&(ue("Quantity cannot be empty",{variant:"error"}),o.quantity="1",r[t]=o,Ye((function(e){return(0,l.Z)((0,l.Z)({},e),{},{products:r})})))},onChange:function(e){return Ht(t,"quantity",e.target.value)},value:e.quantity,size:"small"})},center:"true"},{name:"Sell Price",selector:function(e){return e.sellingPrice},cell:function(e,t){return(0,Q.jsx)(x.Z,{type:"number",onBlur:function(){var n=(0,a.Z)($e.products),r=(0,l.Z)({},n[t]);(!e.sellingPrice||r.product.purchasePrice>parseInt(e.sellingPrice,10))&&(ue("The product price cannot be lower than its purchase price of ".concat($t($e.products[t].product.purchasePrice)),{variant:"error"}),r.sellingPrice=String(r.product.purchasePrice),n[t]=r,Ye((function(e){return(0,l.Z)((0,l.Z)({},e),{},{products:n})})))},onChange:function(e){return Ht(t,"sellingPrice",e.target.value)},value:e.sellingPrice,size:"small"})},center:"true"},{name:"GST Value",selector:function(e){var t,n;return null!==(t=null===e||void 0===e||null===(n=e.product)||void 0===n?void 0:n.gstValue)&&void 0!==t?t:e.gstValue},center:"true"},{name:"Discount",selector:function(e){return e.discount},cell:function(e,t){return(0,Q.jsx)(x.Z,{value:e.discount,size:"small",disabled:!0,type:"number",onBlur:function(){if(0===e.discount.length){var n=(0,a.Z)($e.products),r=(0,l.Z)({},n[t]);r.discount="0",n[t]=r,Ye((function(e){return(0,l.Z)((0,l.Z)({},e),{},{products:n})}))}},onChange:function(e){return Ht(t,"discount",e.target.value)},InputProps:{endAdornment:(0,Q.jsx)(v.Z,{position:"end",children:(0,Q.jsx)(L.Z,{fontSize:"small"})})}})},center:"true"},{name:"Net Amount",selector:function(e){return parseInt(e.quantity||0,10)*parseInt(e.sellingPrice||0,10)},center:"true"},{name:"Actions",cell:function(e,t){return(0,Q.jsx)(Z.Z,{onClick:function(){return function(e,t){console.log("deleting product...",Rt),Rt&&Ye((function(e){return(0,l.Z)((0,l.Z)({},e),{},{offer:{}})}));var n=(0,a.Z)($e.products);n.splice(t,1),Ye((function(e){return(0,l.Z)((0,l.Z)({},e),{},{products:n})}))}(0,t)},color:"error",variant:"outlined",children:(0,Q.jsx)(H.Z,{})})},center:"true"}],$t=new Intl.NumberFormat("hi-In",{style:"currency",currency:"INR"}).format;var Yt=$e.products.reduce((function(e,t){var n=function(e){return parseInt(e.sellingPrice?e.sellingPrice:0,10)*parseInt(e.quantity?e.quantity:0,10)*(parseInt(e.discount?e.discount:0,10)/100)}(t);return e+n}),0),Gt=$e.products.reduce((function(e,t){return e+parseInt(t.sellingPrice?t.sellingPrice:0,10)*parseInt(t.quantity?t.quantity:0,10)}),0),Qt=0;Object.keys($e.offer).length>0&&(Qt="PERCENTAGE"===$e.offer.type?Gt*$e.offer.typeValue/100:$e.offer.typeValue);var Kt=Gt-(Yt+Number(Qt))-parseFloat(""!==re?re:0),Jt=0;$e.amountToPay&&(Jt=Kt-$e.amountToPay,Rt&&(Jt-=le));var Xt=ut.filter((function(e){var t,n;return(null===e||void 0===e||null===(t=e.customerId.name)||void 0===t?void 0:t.toLowerCase().includes(null===Ke||void 0===Ke?void 0:Ke.toLowerCase()))||(null===e||void 0===e||null===(n=e.invoiceNumber)||void 0===n?void 0:n.toLowerCase().includes(null===Ke||void 0===Ke?void 0:Ke.toLowerCase()))}));return(0,Q.jsxs)(c.Z,{maxWidth:!n.themeStretch&&"xl",children:[(0,Q.jsx)(d.Z,{variant:"h4",children:" Sales "}),(0,Q.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",marginTop:"20px"},children:[(0,Q.jsxs)(y.Z,{direction:"row",spacing:1,children:[(0,Q.jsx)(b.Z,{label:"Total  ".concat(V.MG.format(mt.totalSalesAmount)),variant:"outlined"}),(0,Q.jsx)(b.Z,{label:"Paid  ".concat(V.MG.format(mt.totalPaidAmount)),variant:"outlined"}),(0,Q.jsx)(b.Z,{label:"Pending  ".concat(V.MG.format(mt.pendingAmount)),variant:"outlined"})]}),(0,Q.jsx)(y.Z,{children:(0,Q.jsx)(m.Z,{variant:"contained",color:"primary",startIcon:(0,Q.jsx)(N.Z,{}),onClick:function(){Ye((function(e){return(0,l.Z)((0,l.Z)({},e),{},{invoiceDate:B()(new Date)})})),ve(!0),zt(!1)},children:"CREATE SALES ORDER"})})]}),(0,Q.jsxs)("div",{style:{marginTop:"20px"},children:[(0,Q.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"10px"},children:[(0,Q.jsx)("div",{style:{display:"flex",marginTop:"8px"},children:(0,Q.jsx)(x.Z,{placeholder:"Search",size:"small",value:Ke,onChange:function(e){return Je(e.target.value)},InputProps:{startAdornment:(0,Q.jsx)(v.Z,{position:"start",children:(0,Q.jsx)(R.Z,{})})}})}),(0,Q.jsx)("div",{children:(0,Q.jsx)(_._,{dateAdapter:U.y,children:(0,Q.jsx)(F.C,{components:["SingleInputDateRangeField"],children:(0,Q.jsx)(W.n,{size:"small",label:"Date Range",value:pe,onChange:function(e){return me(e)}})})})})]}),(0,Q.jsx)("div",{style:{marginTop:"20px"},children:(0,Q.jsx)(O.ZP,{columns:qt,data:Xt,pagination:!0,progressPending:ot})})]}),(0,Q.jsx)(g.Z,{open:xe,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,Q.jsxs)(j.Z,{sx:K,children:[(0,Q.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"10px",backgroundColor:"white",padding:"15px",borderRadius:"10px"},children:[(0,Q.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",gap:"15px"},children:[(0,Q.jsx)(P.Z,{disabled:Rt,value:$e.mobileNumber,options:ke,fullWidth:!0,getOptionLabel:function(e){return"string"===typeof e?e:e.mobileNumber},selectOnFocus:!0,onChange:function(e,t){console.log({newValue:t}),console.log("event calling and changing value from options"),Ye(t?function(e){return(0,l.Z)((0,l.Z)({},e),{},{mobileNumber:t,customer:t.name})}:function(e){return(0,l.Z)((0,l.Z)({},e),{},{mobileNumber:null,customer:""})})},onInputChange:function(e,t){if(!ke.some((function(e){return e.mobileNumber===t})))console.log("Mobile number new "),Ye((function(e){return(0,l.Z)((0,l.Z)({},e),{},{mobileNumber:t,customer:""})}));else{var n=ke.find((function(e){return e.mobileNumber===t}));Ye((function(e){return(0,l.Z)((0,l.Z)({},e),{},{mobileNumber:t,customer:n.name})}))}},onBlur:function(e){var t=$e.mobileNumber;"string"===typeof t&&(/^\d+$/.test(t)?(Ye((function(e){return(0,l.Z)((0,l.Z)({},e),{},{mobileNumber:t.slice(0,10)})})),ue("Mobile number must be 10 digits only!",{variant:"error"})):(Ye((function(e){return(0,l.Z)((0,l.Z)({},e),{},{mobileNumber:""})})),ue("Mobile number must be numerical digits only!",{variant:"error"})))},freeSolo:!0,renderInput:function(e){return(0,Q.jsx)(x.Z,(0,l.Z)((0,l.Z)({},e),{},{label:"Mobile Number",fullWidth:!0}))}}),(0,Q.jsx)(x.Z,{label:"Customer Name",disabled:Rt,value:$e.customer,onBlur:function(e){var t=$e.customer;/\d/.test(t)&&(Ye((function(e){return(0,l.Z)((0,l.Z)({},e),{},{customer:""})})),ue("Customer name cannot contain digits!",{variant:"error"}))},fullWidth:!0,onChange:function(e){Ye((function(t){return(0,l.Z)((0,l.Z)({},t),{},{customer:e.target.value})}))}})]}),(0,Q.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:"15px"},children:[(0,Q.jsx)(P.Z,{value:$e.salesMan,disabled:Rt,options:De,getOptionLabel:function(e){return e.name},fullWidth:!0,onChange:function(e,t){Ye((function(e){return(0,l.Z)((0,l.Z)({},e),{},{salesMan:t})}))},renderInput:function(e){return(0,Q.jsx)(x.Z,(0,l.Z)((0,l.Z)({},e),{},{label:"Sales Man",fullWidth:!0}))}}),(0,Q.jsx)(_._,{dateAdapter:U.y,children:(0,Q.jsx)(q.M,{label:"Invoice Date",value:$e.invoiceDate,onChange:function(e){Ye((function(t){return(0,l.Z)((0,l.Z)({},t),{},{invoiceDate:e})}))},format:"DD/MM/YYYY",disabled:Rt,slotProps:{textField:{fullWidth:!0}}})})]})]}),(0,Q.jsx)(C.ZP,{container:!0,sx:{backgroundColor:"white",padding:"15px",borderRadius:"10px",display:"flex",justifyContent:"space-between"},alignItems:"center",children:(0,Q.jsx)(C.ZP,{item:!0,xs:12,md:12,display:"flex",children:(0,Q.jsx)(P.Z,{options:Ue.filter((function(e){return!tt.category||"All Categories"===tt.category||e.category.name===tt.category})),value:null!==(e=null===tt||void 0===tt?void 0:tt.product)&&void 0!==e?e:null,onChange:function(e,t){t?(nt((function(e){return(0,l.Z)((0,l.Z)({},e),{},{product:t})})),function(e){if($e.products.find((function(t){return t.product.name===e.name})))ue("Product already added!",{variant:"error"});else{var t=Ue.find((function(t){return t.name===e.name}));if(t&&t.quantity<e.quantity)ue("Product quantity not available!",{variant:"error"});else{var n={product:e,sellingPrice:e.sellingPrice,quantity:1,category:e.category,discount:0};Ye((function(e){return(0,l.Z)((0,l.Z)({},e),{},{products:[].concat((0,a.Z)(e.products),[n])})})),console.log(e),nt(ee),r.current&&r.current.blur()}}}(t)):nt((function(e){return(0,l.Z)((0,l.Z)({},e),{},{product:null})}))},getOptionLabel:function(e){return null===e||void 0===e?void 0:e.name},fullWidth:!0,renderInput:function(e){return(0,Q.jsx)(x.Z,(0,l.Z)((0,l.Z)({},e),{},{inputRef:r,label:"Search Products",fullWidth:!0}))}})})}),$e.products.length>0&&(0,Q.jsxs)(C.ZP,{container:!0,sx:{backgroundColor:"white",padding:"15px",borderRadius:"10px"},alignItems:"center",children:[(0,Q.jsx)(C.ZP,{item:!0,xs:12,children:(0,Q.jsx)(O.ZP,{columns:Vt,data:$e.products})}),(0,Q.jsx)(C.ZP,{item:!0,xs:12,display:"flex",justifyContent:"flex-end",sx:{mt:2},children:(0,Q.jsxs)("div",{style:{width:"200px"},children:[(0,Q.jsx)("div",{children:"Voucher"}),(0,Q.jsx)("div",{style:{paddingTop:"5px"},children:(0,Q.jsx)(x.Z,{fullWidth:!0,size:"small",type:"number",label:"Enter Discount",disabled:Object.keys($e.offer).length>0,onBlur:function(e){""===re&&ae(0),parseFloat(re)>Gt&&(ae(),ue("Discount cannot be greater than total amount!",{variant:"error"}))},value:re,onChange:function(e){Object.keys($e.offer).length>0&&Ye((function(e){return(0,l.Z)((0,l.Z)({},e),{},{offer:{}})})),ae(e.target.value)}})})]})}),(0,Q.jsx)(k.Z,{primary:"OR",sx:{display:"flex",justifyContent:"flex-end",marginRight:"100px",mt:.5}}),console.log("sales.offer",$e.offer),(0,Q.jsx)(C.ZP,{item:!0,xs:12,display:"flex",justifyContent:"flex-end",sx:{mt:.5},children:(0,Q.jsxs)("div",{style:{width:"200px"},children:[(0,Q.jsx)("div",{children:"Select Offer"}),(0,Q.jsx)("div",{style:{paddingTop:"5px"},children:Object.keys(null===$e||void 0===$e?void 0:$e.offer).length>0?(0,Q.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,Q.jsx)(b.Z,{variant:"contained",color:"primary",label:"Offer Applied : ".concat($e.offer.code),onDelete:function(){Ye((function(e){return(0,l.Z)((0,l.Z)({},e),{},{offer:{}})}))}}),(0,Q.jsx)(d.Z,{variant:"caption",gutterBottom:!0,children:"PERCENTAGE"===$e.offer.type?"".concat($e.offer.typeValue,"% Off"):"".concat($t($e.offer.typeValue)," Off")})]}):(0,Q.jsx)("div",{style:{paddingTop:"5px"},children:(0,Q.jsxs)(S.Z,{fullWidth:!0,size:"small",children:[(0,Q.jsx)(w.Z,{id:"demo-simple-select-label",children:"Select Offer"}),(0,Q.jsx)(A.Z,{disabled:re,labelId:"demo-simple-select-label",id:"demo-simple-select",label:"Select Offer",value:null!==(t=$e.offer)&&void 0!==t?t:"",onChange:function(e){return Ye((function(t){return(0,l.Z)((0,l.Z)({},t),{},{offer:e.target.value})}))},children:qe.map((function(e,t){return(0,Q.jsx)(h.Z,{value:e,children:e.code},t)}))})]})})})]})})]}),(0,Q.jsx)(C.ZP,{container:!0,display:"flex",justifyContent:"flex-end",children:(0,Q.jsx)(C.ZP,{item:!0,xs:12,md:6,lg:6,sx:{backgroundColor:"white",padding:"15px",borderRadius:"10px"},children:(0,Q.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,Q.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,Q.jsx)("div",{children:"Product Discount"}),(0,Q.jsx)("div",{children:0===$e.products.length?$t(0):$t(re)})]}),0!==Object.keys($e.offer).length?(0,Q.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,Q.jsx)("div",{children:"Offer Discount"}),(0,Q.jsx)("div",{children:$t(Qt)})]}):null,(0,Q.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,Q.jsx)("div",{children:"Total Amount"}),(0,Q.jsx)("div",{children:0===$e.products.length?$t(0):$t(Gt)})]})]})})}),(0,Q.jsx)(C.ZP,{container:!0,display:"flex",justifyContent:"flex-end",children:(0,Q.jsxs)(C.ZP,{item:!0,xs:12,md:6,lg:6,sx:{backgroundColor:"white",padding:"15px",borderRadius:"10px",display:"flex",flexDirection:"column",gap:"10px"},children:[(0,Q.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:"10px"},children:[(0,Q.jsx)(x.Z,{fullWidth:!0,disabled:Rt,size:"small",type:"number",label:"Enter Amount",onBlur:function(e){parseFloat($e.amountToPay)>Kt&&(ue("Amount to pay cannot be greater than total amount!",{variant:"error"}),Ye((function(e){return(0,l.Z)((0,l.Z)({},e),{},{amountToPay:0})})))},value:$e.amountToPay,onChange:function(e){Ye((function(t){return(0,l.Z)((0,l.Z)({},t),{},{amountToPay:e.target.value})}))}}),(0,Q.jsxs)(S.Z,{fullWidth:!0,size:"small",children:[(0,Q.jsx)(w.Z,{id:"demo-simple-select-label",children:"Select Payment Status"}),(0,Q.jsx)(A.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",label:"Select Payment Status",value:$e.paymentStatus,disabled:Rt,onChange:function(e){return Ye((function(t){return(0,l.Z)((0,l.Z)({},t),{},{paymentStatus:e.target.value})}))},children:V.y0.paymentStatus.map((function(e,t){return(0,Q.jsx)(h.Z,{value:e,children:e},t)}))})]})]}),(0,Q.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:"10px"},children:[(0,Q.jsxs)(S.Z,{fullWidth:!0,size:"small",children:[(0,Q.jsx)(w.Z,{id:"demo-simple-select-label",children:"Select Payment Mode"}),(0,Q.jsx)(A.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",label:"Select Payment Mode",value:$e.paymentMode,disabled:Rt,onChange:function(e){return Ye((function(t){return(0,l.Z)((0,l.Z)({},t),{},{paymentMode:e.target.value})}))},children:["CASH","CARD","UPI","CHEQUE"].map((function(e,t){return(0,Q.jsx)(h.Z,{value:e,children:e},t)}))})]}),(0,Q.jsxs)(S.Z,{fullWidth:!0,size:"small",children:[(0,Q.jsx)(w.Z,{id:"demo-simple-select-label",children:"Select Bank"}),(0,Q.jsx)(A.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",label:"Select Bank",value:$e.bank,disabled:Rt||"CASH"===$e.paymentMode,onChange:function(e){return Ye((function(t){return(0,l.Z)((0,l.Z)({},t),{},{bank:e.target.value})}))},children:ze.map((function(e,t){return(0,Q.jsx)(h.Z,{value:e._id,children:e.bankName},t)}))})]})]})]})}),(0,Q.jsx)(C.ZP,{container:!0,children:(0,Q.jsxs)(C.ZP,{item:!0,xs:12,md:12,lg:12,sx:{backgroundColor:"white",p:"15px",borderRadius:"10px"},display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,Q.jsxs)("div",{style:{display:"flex",justifyContent:"flex-start",gap:"20px"},children:[(0,Q.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-around",gap:"40px"},children:[(0,Q.jsx)("div",{children:"Total  :"}),(0,Q.jsx)("div",{children:0===$e.products.length?$t(0):$t(Kt)})]}),(0,Q.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-around",gap:"40px"},children:[(0,Q.jsx)("div",{children:"Balance  :"}),(0,Q.jsx)("div",{children:0===$e.products.length?$t(0):$t(Jt)})]}),Rt&&(0,Q.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-around",gap:"40px"},children:[(0,Q.jsx)("div",{children:"Previously Paid  :"}),(0,Q.jsx)("div",{children:0===$e.products.length?$t(0):$t(le)})]})]}),(0,Q.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[Rt?(0,Q.jsx)(m.Z,{variant:"contained",onClick:function(){if(Kt<le)ue("Order Amount Must be greater than ".concat($t(le),"!"),{variant:"error"});else{if(0!==Jt){if(""===$e.amountToPay||0===parseFloat($e.amountToPay))return void ue("Amount to pay cannot be empty or 0!.",{variant:"error"});if(parseFloat($e.amountToPay)>Kt-le)return void ue("Amount to pay cannot be greater than ".concat($t(Kt-le),"!"),{variant:"error"})}console.log("sales.amountToPay",$e.amountToPay);var e=(0,l.Z)({},$e);e.discount={},e.discount.productDiscount=Yt,e.discount.amount=parseFloat(re),Object.keys($e.offer).length>0&&(e.discount.offer={},e.discount.offer.discount=Qt,e.discount.offer.id=$e.offer),e.products=$e.products,e.balanceAmount=Jt,e.totalDiscount=Yt+Qt+parseFloat(re),e.totalAmount=Kt,e.paymentStatus=$e.paymentStatus,e.id=jt._id,delete e.offer,delete e.invoiceDueDate,delete e.salesMan,delete e.customer,delete e.invoiceDate,delete e.mobileNumber,console.log({updatePayload:e});var t=localStorage.getItem($._.keyUserToken),n=(0,V.sw)(t);Y.ZP.post(Y.Hv.sales.update,e,{headers:{Authorization:"Bearer ".concat(n)}}).then((function(e){ue("Sales order updated successfully!",{variant:"success"}),ve(!1),Pt({}),Ze(),Wt(),zt(!1),Ot()})).catch((function(e){ue(e.error||e.err,{variant:"error"})}))}},color:"primary",disabled:!$e.paymentStatus,children:"UPDATE"}):(0,Q.jsx)(m.Z,{variant:"contained",onClick:function(){var e=(0,l.Z)({},$e);if("string"===typeof $e.mobileNumber&&$e.mobileNumber.length<10)ue("Mobile number must be 10 digits!",{variant:"error"});else if($e.customer.length<=1)ue("Customer name must be greater than one alphabet!",{variant:"error"});else{e.discount={},e.discount.productDiscount=Yt,e.discount.amount=parseFloat(re),Object.keys($e.offer).length>0&&(e.discount.offer={},e.discount.offer.discount=Qt,e.discount.offer.id=$e.offer),e.totalDiscount=Yt+Qt+parseFloat(re),e.totalAmount=Kt,console.log(e);var t=localStorage.getItem($._.keyUserToken),n=(0,V.sw)(t);Y.ZP.post(Y.Hv.sales.add,e,{headers:{Authorization:"Bearer ".concat(n)}}).then((function(e){ue("Sales order created successfully!",{variant:"success"}),ve(!1),Ze(),Wt(),Ot()})).catch((function(e){ue(e.error||e.err,{variant:"error"})}))}},color:"primary",disabled:!$e.customer||!$e.mobileNumber||!$e.salesMan||0===$e.products.length||!$e.amountToPay||!$e.paymentMode||!$e.paymentStatus||"CASH"!==$e.paymentMode&&!$e.bank,children:"SAVE"}),(0,Q.jsx)(m.Z,{variant:"contained",color:"error",onClick:function(){ve(!1),zt(!1),Ze()},children:"CANCEL"})]})]})})]})}),(0,Q.jsx)(g.Z,{id:"paymentModal",open:St,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,Q.jsx)(j.Z,{sx:J,children:(0,Q.jsxs)(C.ZP,{container:!0,sx:{display:"flex",flexDirection:"column",gap:"10px"},children:[(0,Q.jsx)(C.ZP,{item:!0,xs:12,children:(0,Q.jsx)(d.Z,{variant:"h6",children:"Customer Details"})}),(0,Q.jsx)(C.ZP,{item:!0,xs:12,children:(0,Q.jsx)(x.Z,{label:"Name",value:It.name,disabled:!0,sx:{backgroundColor:"white",borderRadius:"7px"},fullWidth:!0})}),(0,Q.jsx)(C.ZP,{item:!0,xs:12,children:(0,Q.jsx)(x.Z,{label:"Balance",value:It.balance,disabled:!0,sx:{backgroundColor:"white",borderRadius:"7px"},fullWidth:!0})}),(0,Q.jsx)(C.ZP,{item:!0,xs:12,children:(0,Q.jsx)(d.Z,{variant:"h6",children:"Payment Details"})}),(0,Q.jsx)(C.ZP,{item:!0,xs:12,children:(0,Q.jsx)(x.Z,{label:"Amount To Pay",value:It.amountToPay,onBlur:function(){It.amountToPay>It.balance&&(ue("Amount to pay cannot be greater than balance!",{variant:"error"}),Mt((function(e){return(0,l.Z)((0,l.Z)({},e),{},{amountToPay:It.balance})})))},onChange:function(e){return Mt((function(t){return(0,l.Z)((0,l.Z)({},t),{},{amountToPay:e.target.value})}))},sx:{backgroundColor:"white",borderRadius:"7px"},fullWidth:!0})}),(0,Q.jsx)(C.ZP,{item:!0,xs:12,children:(0,Q.jsx)(_._,{dateAdapter:U.y,children:(0,Q.jsx)(q.M,{label:"Payment Date",value:It.paymentDate,maxDate:B()(new Date),onChange:function(e){Mt((function(t){return(0,l.Z)((0,l.Z)({},t),{},{paymentDate:e})}))},sx:{backgroundColor:"white",borderRadius:"7px"},format:"DD/MM/YYYY",slotProps:{textField:{fullWidth:!0}}})})}),(0,Q.jsx)(C.ZP,{item:!0,xs:12,children:(0,Q.jsxs)(S.Z,{fullWidth:!0,children:[(0,Q.jsx)(w.Z,{id:"record-payment-mode",children:"Select Payment Mode"}),(0,Q.jsx)(A.Z,{labelId:"record-payment-mode",id:"demo-simple-select",label:"Select Payment Mode",sx:{backgroundColor:"white",borderRadius:"7px"},value:It.paymentMode,onChange:function(e){return Mt((function(t){return(0,l.Z)((0,l.Z)({},t),{},{paymentMode:e.target.value})}))},children:["CASH","CARD","UPI","CHEQUE"].map((function(e,t){return(0,Q.jsx)(h.Z,{value:e,children:e},t)}))})]})}),"CASH"!==It.paymentMode&&(0,Q.jsx)(C.ZP,{item:!0,xs:12,children:(0,Q.jsxs)(S.Z,{fullWidth:!0,children:[(0,Q.jsx)(w.Z,{id:"select-bank",children:"Select Bank"}),(0,Q.jsx)(A.Z,{labelId:"select-bank",id:"demo-simple-select",label:"Select Bank",value:It.bank,sx:{backgroundColor:"white",borderRadius:"7px"},onChange:function(e){return Mt((function(t){return(0,l.Z)((0,l.Z)({},t),{},{bank:e.target.value})}))},children:ze.map((function(e,t){return(0,Q.jsx)(h.Z,{value:e._id,children:e.bankName},t)}))})]})}),(0,Q.jsxs)(C.ZP,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[(0,Q.jsx)(m.Z,{variant:"contained",color:"primary",onClick:function(){var e={};e.salesOrderId=It.salesOrderId,e.amountToPay=It.amountToPay,e.paymentDate=It.paymentDate,e.paymentMode=It.paymentMode,It.bank.length>0&&(e.bank=It.bank);var t=localStorage.getItem($._.keyUserToken),n=(0,V.sw)(t);Y.ZP.post(Y.Hv.sales.recordPayment,e,{headers:{Authorization:"Bearer ".concat(n)}}).then((function(e){ue("Sales order payment recorded successfully!",{variant:"success"}),wt(!1),Mt(te),Wt(),Ot()})).catch((function(e){ue(e.error,{variant:"error"})}))},disabled:!It.amountToPay||!It.paymentMode||"CASH"!==It.paymentMode&&!It.bank,children:"Update Payment"}),(0,Q.jsx)(m.Z,{variant:"contained",color:"error",onClick:function(){wt(!1),Mt(te)},children:"Cancel"})]})]})})}),(0,Q.jsxs)(D.Z,{open:ge,onClose:function(){return je(!1)},children:[(0,Q.jsx)(I.Z,{children:"Remove"}),(0,Q.jsx)(M.Z,{children:"Are you sure you want to delete this sales order?"}),(0,Q.jsxs)(T.Z,{children:[(0,Q.jsx)(m.Z,{onClick:function(){je(!1),Pt({})},children:"Cancel"}),(0,Q.jsx)(m.Z,{onClick:function(){var e=localStorage.getItem($._.keyUserToken),t=(0,V.sw)(e),n={headers:{Authorization:"Bearer ".concat(t)}};Y.ZP.post(Y.Hv.sales.delete,{id:jt._id},n).then((function(e){e&&(ue("Sales order deleted successfully!",{variant:"success"}),je(!1),Pt({}),Wt(),Ot())})).catch((function(e){console.log(e),ue(e.msg||e.error,{variant:"error"})}))},variant:"contained",color:"error",children:"Delete"})]})]})]})}function re(){return(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(r.ql,{children:(0,Q.jsx)("title",{children:" Dashboard : Sales"})}),(0,Q.jsx)(ne,{})]})}},27247:function(e,t,n){var r=n(64836);t.Z=void 0;var a=r(n(45649)),o=n(80184);t.Z=(0,a.default)((0,o.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete")},93704:function(e,t,n){var r=n(64836);t.Z=void 0;var a=r(n(45649)),o=n(80184);t.Z=(0,a.default)((0,o.jsx)("path",{d:"M7.5 11C9.43 11 11 9.43 11 7.5S9.43 4 7.5 4 4 5.57 4 7.5 5.57 11 7.5 11m0-5C8.33 6 9 6.67 9 7.5S8.33 9 7.5 9 6 8.33 6 7.5 6.67 6 7.5 6M4.0025 18.5832 18.59 3.9955l1.4142 1.4143L5.4167 19.9974zM16.5 13c-1.93 0-3.5 1.57-3.5 3.5s1.57 3.5 3.5 3.5 3.5-1.57 3.5-3.5-1.57-3.5-3.5-3.5m0 5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5"}),"Percent")},65661:function(e,t,n){var r=n(87462),a=n(63366),o=n(72791),i=n(28182),l=n(94419),s=n(4567),u=n(66934),c=n(31402),d=n(17673),p=n(85090),m=n(80184),f=["className","id"],h=(0,u.ZP)(s.Z,{name:"MuiDialogTitle",slot:"Root",overridesResolver:function(e,t){return t.root}})({padding:"16px 24px",flex:"0 0 auto"}),x=o.forwardRef((function(e,t){var n=(0,c.Z)({props:e,name:"MuiDialogTitle"}),s=n.className,u=n.id,x=(0,a.Z)(n,f),v=n,Z=function(e){var t=e.classes;return(0,l.Z)({root:["root"]},d.a,t)}(v),y=o.useContext(p.Z).titleId,b=void 0===y?u:y;return(0,m.jsx)(h,(0,r.Z)({component:"h2",className:(0,i.Z)(Z.root,s),ownerState:v,ref:t,variant:"h6",id:null!=u?u:b},x))}));t.Z=x},4560:function(e,t,n){n.d(t,{C:function(){return u}});var r=n(4942),a=n(87462),o=(n(72791),n(36314)),i=n(12022),l=n(80184),s=function(e){return e.match(/^([A-Za-z]+)Range(Calendar|Clock)$/)?"multi-panel-UI-view":e.match(/^([A-Za-z]*)(DigitalClock)$/)?"Tall-UI-view":e.match(/^Static([A-Za-z]+)/)||e.match(/^([A-Za-z]+)(Calendar|Clock)$/)?"UI-view":e.match(/^MultiInput([A-Za-z]+)RangeField$/)||e.match(/^([A-Za-z]+)RangePicker$/)?"multi-input-range-field":e.match(/^SingleInput([A-Za-z]+)RangeField$/)?"single-input-range-field":"single-input-field"};function u(e){var t=e.children,n=e.components,u=e.sx,c=new Set,d=new Set;n.forEach((function(e){c.add(s(e)),d.add(function(e){return e.includes("DateTime")?"date-time":e.includes("Date")?"date":"time"}(e))}));var p,m,f=function(e){return"row"===e?c.has("UI-view")||c.has("Tall-UI-view")?3:2:c.has("UI-view")?4:3},h=(0,a.Z)({overflow:"auto",pt:1},u);return n.length>2||c.has("multi-input-range-field")||c.has("single-input-range-field")||c.has("multi-panel-UI-view")||c.has("UI-view")||d.has("date-time")?(p="column",m=f("column")):(p={xs:"column",lg:"row"},m={xs:f("column"),lg:f("row")}),c.has("UI-view")||(h=c.has("single-input-range-field")?d.has("date-time")?(0,a.Z)({},h,(0,r.Z)({},"& > .".concat(i.Z.root),{minWidth:{xs:300,md:400}})):(0,a.Z)({},h,(0,r.Z)({},"& > .".concat(i.Z.root),{minWidth:300})):d.has("date-time")?(0,a.Z)({},h,(0,r.Z)({},"& > .".concat(i.Z.root),{minWidth:270})):(0,a.Z)({},h,(0,r.Z)({},"& > .".concat(i.Z.root),{minWidth:200}))),(0,l.jsx)(o.Z,{direction:p,spacing:m,sx:h,children:t})}}}]);
//# sourceMappingURL=571.feb8e2b7.chunk.js.map