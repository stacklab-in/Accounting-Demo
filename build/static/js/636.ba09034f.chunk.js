"use strict";(self.webpackChunk_accounting_billing_stacklab=self.webpackChunk_accounting_billing_stacklab||[]).push([[636],{32869:function(e,t,n){n.d(t,{Ds:function(){return r.Ds}});var r=n(58518);n(58764)},78636:function(e,t,n){n.r(t),n.d(t,{default:function(){return ne}});var r=n(6907),a=n(93433),o=n(74165),i=n(15861),l=n(1413),c=n(29439),s=n(72791),u=n(89164),d=n(4567),p=n(57088),f=n(30439),h=n(71715),m=n(82626),x=n(93006),v=n(63466),Z=n(13400),y=n(36314),g=n(85771),b=n(73590),j=n(64554),P=n(89744),k=n(61889),D=n(68096),C=n(50168),w=n(58406),S=n(5574),A=n(65661),M=n(39157),T=n(97123),I=n(42419),Y=n(5403),_=n(97892),B=n.n(_),R=n(4560),q=n(71652),z=n(24750),E=n(51612),W=n(26759),O=n(43513),G=n(98265),H=n(27247),F=n(93704),N=n(18406),U=n(52073),V=n(99615),L=n(32869),$=n(80184),Q={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"75%",borderRadius:"10px",height:"90%",overflowY:"auto",boxShadow:24,display:"flex",flexDirection:"column",justifyContent:"space-between",bgcolor:N.$_.modalbackground,gap:"10px",p:2},K={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"400px",bgcolor:N.$_.modalbackground,borderRadius:"10px",height:"auto",boxShadow:24,p:2},J={vendor:null,purchaseDate:null,purchaseDueDate:null,products:[],offer:"",amountToPay:"",totalAmount:0,productDiscount:0,paymentMode:"",paymentStatus:"",bank:""},X={id:"",name:"",balance:0,amountToPay:0,paymentMode:"",bank:"",paymentDate:B()(new Date)},ee={category:"All Categories",product:null,quantity:"",netAmount:null,discount:null,sellingPrice:null};function te(){var e,t,n,r=(0,p.K$)(),_=(0,L.Ds)().enqueueSnackbar,te=(0,s.useState)((function(){return[B()("2022-04-17"),B()("2022-04-21")]})),ne=(0,c.Z)(te,2),re=ne[0],ae=ne[1],oe=(0,s.useState)(!1),ie=(0,c.Z)(oe,2),le=ie[0],ce=ie[1],se=(0,s.useState)(J),ue=(0,c.Z)(se,2),de=ue[0],pe=ue[1],fe=(0,s.useState)([]),he=(0,c.Z)(fe,2),me=he[0],xe=he[1],ve=(0,s.useState)([]),Ze=(0,c.Z)(ve,2),ye=Ze[0],ge=Ze[1],be=(0,s.useState)([]),je=(0,c.Z)(be,2),Pe=je[0],ke=je[1],De=(0,s.useState)([]),Ce=(0,c.Z)(De,2),we=Ce[0],Se=Ce[1],Ae=(0,s.useState)([]),Me=(0,c.Z)(Ae,2),Te=Me[0],Ie=Me[1],Ye=(0,s.useState)(""),_e=(0,c.Z)(Ye,2),Be=_e[0],Re=_e[1],qe=(0,s.useState)(ee),ze=(0,c.Z)(qe,2),Ee=ze[0],We=ze[1],Oe=(0,s.useState)(!1),Ge=(0,c.Z)(Oe,2),He=Ge[0],Fe=Ge[1],Ne=(0,s.useState)([]),Ue=(0,c.Z)(Ne,2),Ve=Ue[0],Le=Ue[1],$e=(0,s.useState)({totalPurchaseAmount:0,totalPaidAmount:0,pendingAmount:0}),Qe=(0,c.Z)($e,2),Ke=Qe[0],Je=Qe[1],Xe=(0,s.useState)(!1),et=(0,c.Z)(Xe,2),tt=et[0],nt=et[1],rt=(0,s.useState)(null),at=(0,c.Z)(rt,2),ot=at[0],it=at[1],lt=Boolean(ot),ct=(0,s.useState)({}),st=(0,c.Z)(ct,2),ut=st[0],dt=st[1],pt=(0,s.useState)(!1),ft=(0,c.Z)(pt,2),ht=ft[0],mt=ft[1],xt=(0,s.useState)(X),vt=(0,c.Z)(xt,2),Zt=vt[0],yt=vt[1],gt=(0,s.useState)(!1),bt=(0,c.Z)(gt,2),jt=bt[0],Pt=bt[1],kt=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var t,n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem(U._.keyUserToken),n=(0,N.sw)(t),e.next=5,V.ZP.post(V.Hv.vendor.list,{},{headers:{Authorization:"Bearer ".concat(n)}});case 5:(r=e.sent)&&xe(r.data.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),_("Failed to fetch vendors!",{variant:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),Dt=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var t,n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem(U._.keyUserToken),n=(0,N.sw)(t),e.next=5,V.ZP.get(V.Hv.purchase.summary,{headers:{Authorization:"Bearer ".concat(n)}});case 5:(r=e.sent)&&Je({totalPurchaseAmount:r.data.data.totalPurchaseAmount,totalPaidAmount:r.data.data.totalPaidAmount,pendingAmount:r.data.data.pendingAmount}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),_("Failed to fetch purchase summary!",{variant:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),Ct=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var t,n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem(U._.keyUserToken),n=(0,N.sw)(t),e.next=5,V.ZP.post(V.Hv.product.list,{},{headers:{Authorization:"Bearer ".concat(n)}});case 5:(r=e.sent)&&Se(r.data.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),_("Failed to fetch products!",{variant:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),wt=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var t,n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem(U._.keyUserToken),n=(0,N.sw)(t),e.next=5,V.ZP.post(V.Hv.product.category.list,{},{headers:{Authorization:"Bearer ".concat(n)}});case 5:(r=e.sent)&&ge(r.data.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),_("Failed to fetch Categories!",{variant:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),St=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var t,n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem(U._.keyUserToken),n=(0,N.sw)(t),e.next=5,V.ZP.post(V.Hv.purchase.list,{},{headers:{Authorization:"Bearer ".concat(n)}});case 5:(r=e.sent)&&(Fe(!1),Le(r.data.data)),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),_("Failed to fetch purchase orders!",{variant:"error"}),Fe(!1);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),At=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var t,n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem(U._.keyUserToken),n=(0,N.sw)(t),e.next=5,V.ZP.post(V.Hv.offer.list,{status:["LIVE"]},{headers:{Authorization:"Bearer ".concat(n)}});case 5:(r=e.sent)&&Ie(r.data.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),_("Failed to fetch offers!",{variant:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),Mt=function(){var e=(0,i.Z)((0,o.Z)().mark((function e(){var t,n,r;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=localStorage.getItem(U._.keyUserToken),n=(0,N.sw)(t),e.next=5,V.ZP.post(V.Hv.bank.list,{},{headers:{Authorization:"Bearer ".concat(n)}});case 5:(r=e.sent)&&ke(r.data.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),_("Failed to fetch bank accounts!",{variant:"error"});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();(0,s.useEffect)((function(){Fe(!0),St(),Dt(),kt(),Ct(),wt(),At(),Mt()}),[]);var Tt=function(){pe(J),We(ee),pe((function(e){return(0,l.Z)((0,l.Z)({},e),{},{vendor:null})}))},It=function(e,t,n){"discount"===t&&(n<0?(n=0,_("Discount should be between 0 and 100 percent.",{variant:"error"})):n>100&&(n=100,_("Discount should be between 0 and 100 percent.",{variant:"error"}))),"quantity"===t&&n>de.products[e].product.quantity&&(n=de.products[e].product.quantity,_("There are only ".concat(de.products[e].product.quantity," units available."),{variant:"error"}));var r=(0,a.Z)(de.products),o=(0,l.Z)({},r[e]);o[t]=n,r[e]=o,console.log("new Product",r[e]),pe((function(e){return(0,l.Z)((0,l.Z)({},e),{},{products:r})}))},Yt=function(){it(null),console.log({tempData:ut}),pe((function(e){var t;return(0,l.Z)((0,l.Z)({},e),{},{vendor:ut.vendorId,purchaseDate:B()(ut.purchaseDate),purchaseDueDate:B()(ut.purchaseDueDate),products:ut.products,paymentMode:ut.payments[ut.payments.length-1].paymentID.paymentMode,paymentStatus:ut.paymentStatus},(null===ut||void 0===ut||null===(t=ut.discount)||void 0===t?void 0:t.offer)&&{offer:ut.discount.offer.id})})),Pt(!0),ce(!0)},_t=[{name:"Vendor Name",selector:function(e){return e.vendorId.name}},{name:"Product Name",width:"150px",selector:function(e){return e.products.length>1?"".concat(e.products[0].name,", & ").concat(e.products.length-1," more"):e.products[0].name}},{name:"Amount",selector:function(e){return e.totalAmount.toFixed(2)}},{name:"Payment Mode",selector:function(e){return e.payments[0].paymentID.paymentMode}},{name:"Payment Status",selector:function(e){return e.paymentStatus}},{name:"Invoice Number",width:"160px",selector:function(e){return e.invoiceNumber}},{name:"Last Updated",width:"250px",selector:function(e){return(0,N.p6)(e.updatedAt)},sortable:"true"},{name:"Actions",width:"130px",cell:function(e){return(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(f.Z,{onClick:function(t){it(t.currentTarget),dt(e)},style:{color:N.$_.actionButton},variant:"outlined",endIcon:(0,$.jsx)(W.Z,{}),children:"Action"}),(0,$.jsxs)(h.Z,{id:"basic-menu",anchorEl:ot,open:lt,onClose:function(){it(null),dt({})},MenuListProps:{"aria-labelledby":"basic-button"},children:[(0,$.jsx)(m.Z,{onClick:Yt,children:"Edit"}),(0,$.jsx)(m.Z,{onClick:function(){},children:"Send via Email"}),(0,$.jsx)(m.Z,{onClick:function(){},children:"Send via Whatsapp"}),(0,$.jsx)(m.Z,{onClick:function(){nt(!0),it(null)},children:"Delete"}),ut.remainingAmount>0&&(0,$.jsx)(m.Z,{onClick:function(){return it(null),mt(!0),yt((function(e){return(0,l.Z)((0,l.Z)({},e),{},{name:ut.vendorId.name,balance:ut.remainingAmount,id:ut._id})})),void dt({})},children:"Record Payment"})]})]})}}],Bt=[{name:"Product Name",selector:function(e){var t,n;return null!==(t=null===e||void 0===e||null===(n=e.product)||void 0===n?void 0:n.name)&&void 0!==t?t:e.name}},{name:"Quantity",selector:function(e){return e.quantity},cell:function(e,t){return(0,$.jsx)(x.Z,{disabled:jt,type:"number",onBlur:function(n){var r=(0,a.Z)(de.products),o=(0,l.Z)({},r[t]);(!e.quantity||parseInt(e.quantity,10)<=0)&&(_("Quantity cannot be empty",{variant:"error"}),o.quantity="1",r[t]=o,pe((function(e){return(0,l.Z)((0,l.Z)({},e),{},{products:r})})))},onChange:function(e){return It(t,"quantity",e.target.value)},value:e.quantity,size:"small"})},center:"true"},{name:"Sell Price",selector:function(e){return e.sellingPrice},cell:function(e,t){return(0,$.jsx)(x.Z,{type:"number",disabled:jt,onBlur:function(){var n=(0,a.Z)(de.products),r=(0,l.Z)({},n[t]);(!e.sellingPrice||r.product.purchasePrice>parseInt(e.sellingPrice,10))&&(_("The product price cannot be lower than its purchase price of ".concat(N.MG.format(de.products[t].product.purchasePrice)),{variant:"error"}),r.sellingPrice=String(r.product.purchasePrice),n[t]=r,pe((function(e){return(0,l.Z)((0,l.Z)({},e),{},{products:n})})))},onChange:function(e){return It(t,"sellingPrice",e.target.value)},value:e.sellingPrice,size:"small"})},center:"true"},{name:"GST Value",selector:function(e){var t,n;return null!==(t=null===e||void 0===e||null===(n=e.product)||void 0===n?void 0:n.gstValue)&&void 0!==t?t:e.gstValue},center:"true"},{name:"Discount",selector:function(e){return e.discount},cell:function(e,t){return(0,$.jsx)(x.Z,{value:e.discount,size:"small",disabled:jt,type:"number",onBlur:function(){if(0===e.discount.length){var n=(0,a.Z)(de.products),r=(0,l.Z)({},n[t]);r.discount="0",n[t]=r,pe((function(e){return(0,l.Z)((0,l.Z)({},e),{},{products:n})}))}},onChange:function(e){return It(t,"discount",e.target.value)},InputProps:{endAdornment:(0,$.jsx)(v.Z,{position:"end",children:(0,$.jsx)(F.Z,{fontSize:"small"})})}})},center:"true"},{name:"Net Amount",selector:function(e){return parseInt(e.quantity||0,10)*parseInt(e.sellingPrice||0,10)},center:"true"},{name:"Actions",cell:function(e,t){return(0,$.jsx)(Z.Z,{disabled:jt,onClick:function(){return function(e,t){console.log("deleting product...");var n=(0,a.Z)(de.products);n.splice(t,1),pe((function(e){return(0,l.Z)((0,l.Z)({},e),{},{products:n})}))}(0,t)},color:"error",variant:"outlined",children:(0,$.jsx)(H.Z,{})})},center:"true"}],Rt=de.products.reduce((function(e,t){var n=function(e){return parseInt(e.sellingPrice?e.sellingPrice:0,10)*parseInt(e.quantity?e.quantity:0,10)*(parseInt(e.discount?e.discount:0,10)/100)}(t);return e+n}),0);var qt=de.products.reduce((function(e,t){var n=parseInt(t.sellingPrice?t.sellingPrice:0,10)*parseInt(t.quantity?t.quantity:0,10),r=n;return console.log("\ud83d\ude80 ~ netTotalAmountWithGST ~ netAmount:",n),e+r}),0),zt=0;Object.keys(de.offer).length>0&&(zt="PERCENTAGE"===de.offer.type?qt*de.offer.typeValue/100:de.offer.typeValue);var Et=qt-(Rt+Number(zt)),Wt=Ve.filter((function(e){var t,n;return(null===e||void 0===e||null===(t=e.vendorId.name)||void 0===t?void 0:t.toLowerCase().includes(null===Be||void 0===Be?void 0:Be.toLowerCase()))||(null===e||void 0===e||null===(n=e.invoiceNumber)||void 0===n?void 0:n.toLowerCase().includes(null===Be||void 0===Be?void 0:Be.toLowerCase()))}));return(0,$.jsxs)(u.Z,{maxWidth:!r.themeStretch&&"xl",children:[(0,$.jsx)(d.Z,{variant:"h4",children:" Purchase Order "}),(0,$.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",marginTop:"20px"},children:[(0,$.jsxs)(y.Z,{direction:"row",spacing:1,children:[(0,$.jsx)(g.Z,{label:"Total  ".concat(N.MG.format(Ke.totalPurchaseAmount)),variant:"outlined"}),(0,$.jsx)(g.Z,{label:"Paid  ".concat(N.MG.format(Ke.totalPaidAmount)),variant:"outlined"}),(0,$.jsx)(g.Z,{label:"Pending  ".concat(N.MG.format(Ke.pendingAmount)),variant:"outlined"})]}),(0,$.jsx)(y.Z,{children:(0,$.jsx)(f.Z,{variant:"contained",color:"primary",startIcon:(0,$.jsx)(I.Z,{}),onClick:function(){ce(!0),pe((function(e){return(0,l.Z)((0,l.Z)({},e),{},{purchaseDate:B()(new Date)})}))},children:"CREATE PURCHASE ORDER"})})]}),(0,$.jsx)(b.Z,{open:le,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,$.jsxs)(j.Z,{sx:Q,children:[(0,$.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:"10px",backgroundColor:"white",padding:"15px",borderRadius:"10px"},children:[(0,$.jsx)(P.Z,{options:me,disabled:jt,getOptionLabel:function(e){return e.name},fullWidth:!0,value:de.vendor,onChange:function(e,t){pe((function(e){return(0,l.Z)((0,l.Z)({},e),{},{vendor:null!==t&&void 0!==t?t:null})}))},renderInput:function(e){return(0,$.jsx)(x.Z,(0,l.Z)((0,l.Z)({},e),{},{label:"Search Vendors",fullWidth:!0}))}}),(0,$.jsx)(q._,{dateAdapter:z.y,children:(0,$.jsx)(G.M,{label:"Purchase Date",value:de.purchaseDate,onChange:function(e){pe((function(t){return(0,l.Z)((0,l.Z)({},t),{},{purchaseDate:e})}))},format:"DD/MM/YYYY",disabled:jt,slotProps:{textField:{fullWidth:!0}}})}),(0,$.jsx)(q._,{dateAdapter:z.y,children:(0,$.jsx)(G.M,{label:"Purchase Due Date",value:de.purchaseDueDate,onChange:function(e){pe((function(t){return(0,l.Z)((0,l.Z)({},t),{},{purchaseDueDate:e})}))},format:"DD/MM/YYYY",minDate:de.purchaseDate,slotProps:{textField:{fullWidth:!0}}})})]}),(0,$.jsx)(k.ZP,{container:!0,sx:{backgroundColor:"white",padding:"15px",borderRadius:"10px",display:"flex",justifyContent:"space-between"},alignItems:"center",children:(0,$.jsxs)(k.ZP,{item:!0,xs:12,md:12,display:"flex",children:[(0,$.jsxs)(D.Z,{sx:{width:"35%"},children:[(0,$.jsx)(C.Z,{id:"demo-simple-select-label",children:"All Categories"}),(0,$.jsxs)(w.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",label:"All Categories",value:Ee.category,onChange:function(e){We((function(t){return(0,l.Z)((0,l.Z)({},t),{},{category:e.target.value,product:null,quantity:null})}))},disabled:jt,children:[(0,$.jsx)(m.Z,{value:"All Categories",children:"All Categories"}),ye.map((function(e,t){return(0,$.jsx)(m.Z,{value:e.name,children:e.name},t)}))]})]}),(0,$.jsx)(P.Z,{options:we.filter((function(e){return!Ee.category||"All Categories"===Ee.category||e.category.name===Ee.category})),value:null!==(e=null===Ee||void 0===Ee?void 0:Ee.product)&&void 0!==e?e:null,onChange:function(e,t){t?(We((function(e){return(0,l.Z)((0,l.Z)({},e),{},{product:t})})),function(e){if(de.products.find((function(t){return t.product.name===e.name})))_("Product already added!",{variant:"error"});else{var t=we.find((function(t){return t.name===e.name}));if(t&&t.quantity<e.quantity)_("Product quantity not available!",{variant:"error"});else{var n={product:e,sellingPrice:e.sellingPrice,quantity:1,category:e.category,discount:0};pe((function(e){return(0,l.Z)((0,l.Z)({},e),{},{products:[].concat((0,a.Z)(e.products),[n])})})),console.log(e),We(ee)}}}(t)):We((function(e){return(0,l.Z)((0,l.Z)({},e),{},{product:null})}))},disabled:jt,getOptionLabel:function(e){return null===e||void 0===e?void 0:e.name},fullWidth:!0,renderInput:function(e){return(0,$.jsx)(x.Z,(0,l.Z)((0,l.Z)({},e),{},{label:"Search Products",fullWidth:!0}))}})]})}),de.products.length>0&&(0,$.jsxs)(k.ZP,{container:!0,sx:{backgroundColor:"white",padding:"15px",borderRadius:"10px"},alignItems:"center",children:[(0,$.jsx)(k.ZP,{item:!0,xs:12,children:(0,$.jsx)(O.ZP,{columns:Bt,data:de.products})}),(0,$.jsx)(k.ZP,{item:!0,xs:12,display:"flex",justifyContent:"flex-end",sx:{mt:2},children:(0,$.jsxs)("div",{children:[!jt&&(0,$.jsx)("div",{children:"Apply Offer to all products"}),jt?(0,$.jsx)("div",{style:{paddingTop:"5px"},children:(null===ut||void 0===ut||null===(t=ut.discount)||void 0===t?void 0:t.offer)&&(0,$.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,$.jsx)(g.Z,{variant:"contained",color:"primary",label:"Offer Applied : ".concat(ut.discount.offer.id.code),onDelete:jt?void 0:function(){pe((function(e){return(0,l.Z)((0,l.Z)({},e),{},{offer:{}})}))}}),(0,$.jsx)(d.Z,{variant:"caption",gutterBottom:!0,children:"PERCENTAGE"===ut.discount.offer.id.type?"".concat(ut.discount.offer.id.typeValue,"% Off"):"".concat(N.MG.format(ut.discount.offer.id.typeValue)," Off")})]})}):(0,$.jsx)("div",{style:{paddingTop:"5px"},children:0===Object.keys(de.offer).length?(0,$.jsxs)(D.Z,{fullWidth:!0,size:"small",children:[(0,$.jsx)(C.Z,{id:"demo-simple-select-label",children:"Select Offer"}),(0,$.jsx)(w.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",label:"Select Offer",value:null!==(n=de.offer)&&void 0!==n?n:"",onChange:function(e){return pe((function(t){return(0,l.Z)((0,l.Z)({},t),{},{offer:e.target.value})}))},disabled:jt,children:Te.map((function(e,t){return(0,$.jsx)(m.Z,{value:e,children:e.code},t)}))})]}):(0,$.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,$.jsx)(g.Z,{variant:"contained",color:"primary",label:"Offer Applied : ".concat(de.offer.code),onDelete:function(){pe((function(e){return(0,l.Z)((0,l.Z)({},e),{},{offer:{}})}))}}),(0,$.jsx)(d.Z,{variant:"caption",gutterBottom:!0,children:"PERCENTAGE"===de.offer.type?"".concat(de.offer.typeValue,"% Off"):"".concat(N.MG.format(de.offer.typeValue)," Off")})]})})]})})]}),(0,$.jsx)(k.ZP,{container:!0,display:"flex",justifyContent:"flex-end",children:(0,$.jsx)(k.ZP,{item:!0,xs:12,md:6,lg:6,sx:{backgroundColor:"white",padding:"15px",borderRadius:"10px"},children:(0,$.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,$.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,$.jsx)("div",{children:"Product Discount"}),(0,$.jsx)("div",{children:0===de.products.length?N.MG.format(0):N.MG.format(Rt)})]}),0!==Object.keys(de.offer).length?(0,$.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,$.jsx)("div",{children:"Offer Discount"}),(0,$.jsx)("div",{children:N.MG.format(zt)})]}):null,(0,$.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,$.jsx)("div",{children:"Total Amount"}),(0,$.jsx)("div",{children:0===de.products.length?N.MG.format(0):N.MG.format(qt)})]})]})})}),(0,$.jsx)(k.ZP,{container:!0,display:"flex",justifyContent:"flex-end",children:(0,$.jsxs)(k.ZP,{item:!0,xs:12,md:6,lg:6,sx:{backgroundColor:"white",padding:"15px",borderRadius:"10px",display:"flex",flexDirection:"column",gap:"10px"},children:[(0,$.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:"10px"},children:[(0,$.jsx)(x.Z,{fullWidth:!0,disabled:jt,size:"small",label:"Enter Amount",onBlur:function(e){e.target.value>qt&&(_("Amount to pay cannot be greater than total amount!",{variant:"error"}),pe((function(e){return(0,l.Z)((0,l.Z)({},e),{},{amountToPay:qt})})))},value:de.amountToPay,onChange:function(e){return pe((function(t){return(0,l.Z)((0,l.Z)({},t),{},{amountToPay:e.target.value})}))}}),(0,$.jsxs)(D.Z,{fullWidth:!0,size:"small",children:[(0,$.jsx)(C.Z,{id:"demo-simple-select-label",children:"Select Payment Status"}),(0,$.jsx)(w.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",label:"Select Payment Status",value:de.paymentStatus,onChange:function(e){return pe((function(t){return(0,l.Z)((0,l.Z)({},t),{},{paymentStatus:e.target.value})}))},children:N.y0.paymentStatus.map((function(e,t){return(0,$.jsx)(m.Z,{value:e,children:e},t)}))})]})]}),(0,$.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:"10px"},children:[(0,$.jsxs)(D.Z,{fullWidth:!0,size:"small",children:[(0,$.jsx)(C.Z,{id:"demo-simple-select-label",children:"Select Payment Mode"}),(0,$.jsx)(w.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",label:"Select Payment Mode",value:de.paymentMode,disabled:jt,onChange:function(e){return pe((function(t){return(0,l.Z)((0,l.Z)({},t),{},{paymentMode:e.target.value})}))},children:N.y0.paymentMode.map((function(e,t){return(0,$.jsx)(m.Z,{value:e,children:e},t)}))})]}),(0,$.jsxs)(D.Z,{fullWidth:!0,size:"small",children:[(0,$.jsx)(C.Z,{id:"demo-simple-select-label",children:"Select Bank"}),(0,$.jsx)(w.Z,{labelId:"demo-simple-select-label",id:"demo-simple-select",label:"Select Bank",value:de.bank,disabled:jt||"CASH"===de.paymentMode,onChange:function(e){return pe((function(t){return(0,l.Z)((0,l.Z)({},t),{},{bank:e.target.value})}))},children:Pe.map((function(e,t){return(0,$.jsx)(m.Z,{value:e._id,children:e.bankName},t)}))})]})]})]})}),(0,$.jsx)(k.ZP,{container:!0,children:(0,$.jsxs)(k.ZP,{item:!0,xs:12,md:12,lg:12,sx:{backgroundColor:"white",p:"15px",borderRadius:"10px"},display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,$.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-around",gap:"20px"},children:[(0,$.jsx)("div",{children:"Total  :"}),(0,$.jsx)("div",{children:0===de.products.length?N.MG.format(0):N.MG.format(Et)})]}),(0,$.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[jt?(0,$.jsx)(f.Z,{variant:"contained",onClick:function(){var e={};e.purchaseDueDate=B()(de.purchaseDueDate).format("YYYY-MM-DD"),e.paymentStatus=de.paymentStatus,e.id=ut._id,console.log({updatePayload:e});var t=localStorage.getItem(U._.keyUserToken),n=(0,N.sw)(t);V.ZP.post(V.Hv.purchase.update,e,{headers:{Authorization:"Bearer ".concat(n)}}).then((function(e){_("Purchase order updated successfully!",{variant:"success"}),ce(!1),dt({}),Tt(),St(),Pt(!1)})).catch((function(e){_(e.error||"Something went wrong!",{variant:"error"})}))},color:"primary",disabled:!de.purchaseDueDate||!de.paymentStatus,children:"UPDATE"}):(0,$.jsx)(f.Z,{variant:"contained",onClick:function(){var e=(0,l.Z)({},de);e.discount={},e.discount.productDiscount=Rt,Object.keys(de.offer).length>0&&(e.discount.offer={},e.discount.offer.discount=zt,e.discount.offer.id=de.offer),e.totalDiscount=Rt+zt,e.totalAmount=Et,e.purchaseDueDate=B()(e.purchaseDueDate).format("YYYY-MM-DD"),e.purchaseDate=B()(e.purchaseDate).format("YYYY-MM-DD"),e.amountToPay=parseFloat(e.amountToPay),delete e.offer;var t=localStorage.getItem(U._.keyUserToken),n=(0,N.sw)(t);V.ZP.post(V.Hv.purchase.add,e,{headers:{Authorization:"Bearer ".concat(n)}}).then((function(e){_("Purchase order created successfully!",{variant:"success"}),ce(!1),Tt(),St()})).catch((function(e){_(e.error||"Something went wrong!",{variant:"error"})}))},color:"primary",disabled:!de.vendor||!de.purchaseDueDate||0===de.products.length||!de.amountToPay||!de.paymentMode||!de.paymentStatus||"CASH"!==de.paymentMode&&!de.bank,children:"SAVE"}),(0,$.jsx)(f.Z,{variant:"contained",color:"error",onClick:function(){return ce(!1)},children:"CANCEL"})]})]})})]})}),(0,$.jsxs)("div",{style:{marginTop:"20px"},children:[(0,$.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",gap:"10px"},children:[(0,$.jsx)("div",{style:{display:"flex",marginTop:"8px"},children:(0,$.jsx)(x.Z,{placeholder:"Search",size:"small",value:Be,onChange:function(e){return Re(e.target.value)},InputProps:{startAdornment:(0,$.jsx)(v.Z,{position:"start",children:(0,$.jsx)(Y.Z,{})})}})}),(0,$.jsx)("div",{children:(0,$.jsx)(q._,{dateAdapter:z.y,children:(0,$.jsx)(R.C,{components:["SingleInputDateRangeField"],children:(0,$.jsx)(E.n,{size:"small",label:"Date Range",value:re,onChange:function(e){return ae(e)}})})})})]}),(0,$.jsx)("div",{style:{marginTop:"20px"},children:(0,$.jsx)(O.ZP,{columns:_t,data:Wt,progressPending:He,pagination:!0})})]}),(0,$.jsx)(b.Z,{id:"paymentModal",open:ht,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:(0,$.jsx)(j.Z,{sx:K,children:(0,$.jsxs)(k.ZP,{container:!0,sx:{display:"flex",flexDirection:"column",gap:"10px"},children:[(0,$.jsx)(k.ZP,{item:!0,xs:12,children:(0,$.jsx)(d.Z,{variant:"h6",children:"Customer Details"})}),(0,$.jsx)(k.ZP,{item:!0,xs:12,children:(0,$.jsx)(x.Z,{label:"Name",value:Zt.name,disabled:!0,sx:{backgroundColor:"white",borderRadius:"7px"},fullWidth:!0})}),(0,$.jsx)(k.ZP,{item:!0,xs:12,children:(0,$.jsx)(x.Z,{label:"Balance",value:Zt.balance,disabled:!0,sx:{backgroundColor:"white",borderRadius:"7px"},fullWidth:!0})}),(0,$.jsx)(k.ZP,{item:!0,xs:12,children:(0,$.jsx)(d.Z,{variant:"h6",children:"Payment Details"})}),(0,$.jsx)(k.ZP,{item:!0,xs:12,children:(0,$.jsx)(x.Z,{label:"Amount To Pay",value:Zt.amountToPay,onBlur:function(){Zt.amountToPay>Zt.balance&&(_("Amount to pay cannot be greater than balance!",{variant:"error"}),yt((function(e){return(0,l.Z)((0,l.Z)({},e),{},{amountToPay:Zt.balance})})))},onChange:function(e){return yt((function(t){return(0,l.Z)((0,l.Z)({},t),{},{amountToPay:e.target.value})}))},sx:{backgroundColor:"white",borderRadius:"7px"},fullWidth:!0})}),(0,$.jsx)(k.ZP,{item:!0,xs:12,children:(0,$.jsx)(q._,{dateAdapter:z.y,children:(0,$.jsx)(G.M,{label:"Payment Date",value:Zt.paymentDate,maxDate:B()(new Date),onChange:function(e){yt((function(t){return(0,l.Z)((0,l.Z)({},t),{},{paymentDate:e})}))},sx:{backgroundColor:"white",borderRadius:"7px"},format:"DD/MM/YYYY",slotProps:{textField:{fullWidth:!0}}})})}),(0,$.jsx)(k.ZP,{item:!0,xs:12,children:(0,$.jsxs)(D.Z,{fullWidth:!0,children:[(0,$.jsx)(C.Z,{id:"record-payment-mode",children:"Select Payment Mode"}),(0,$.jsx)(w.Z,{labelId:"record-payment-mode",id:"demo-simple-select",label:"Select Payment Mode",sx:{backgroundColor:"white",borderRadius:"7px"},value:Zt.paymentMode,onChange:function(e){return yt((function(t){return(0,l.Z)((0,l.Z)({},t),{},{paymentMode:e.target.value})}))},children:N.y0.paymentMode.map((function(e,t){return(0,$.jsx)(m.Z,{value:e,children:e},t)}))})]})}),"CASH"!==Zt.paymentMode&&(0,$.jsx)(k.ZP,{item:!0,xs:12,children:(0,$.jsxs)(D.Z,{fullWidth:!0,children:[(0,$.jsx)(C.Z,{id:"select-bank",children:"Select Bank"}),(0,$.jsx)(w.Z,{labelId:"select-bank",id:"demo-simple-select",label:"Select Bank",value:Zt.bank,sx:{backgroundColor:"white",borderRadius:"7px"},onChange:function(e){return yt((function(t){return(0,l.Z)((0,l.Z)({},t),{},{bank:e.target.value})}))},children:Pe.map((function(e,t){return(0,$.jsx)(m.Z,{value:e._id,children:e.bankName},t)}))})]})}),(0,$.jsxs)(k.ZP,{item:!0,xs:12,sx:{display:"flex",justifyContent:"flex-end",gap:"10px"},children:[(0,$.jsx)(f.Z,{variant:"contained",color:"primary",onClick:function(){var e={};e.id=Zt.id,e.amountToPay=Zt.amountToPay,e.paymentDate=B()(Zt.paymentDate).format("YYYY-MM-DD"),e.paymentMode=Zt.paymentMode,Zt.bank.length>0&&(e.bank=Zt.bank);var t=localStorage.getItem(U._.keyUserToken),n=(0,N.sw)(t);V.ZP.post(V.Hv.purchase.recordPayment,e,{headers:{Authorization:"Bearer ".concat(n)}}).then((function(e){_("Purchase order payment recorded successfully!",{variant:"success"}),mt(!1),yt(X),St()})).catch((function(e){_(e.error,{variant:"error"})}))},disabled:!Zt.amountToPay||!Zt.paymentMode||"CASH"!==Zt.paymentMode&&!Zt.bank,children:"Update Payment"}),(0,$.jsx)(f.Z,{variant:"contained",color:"error",onClick:function(){mt(!1),yt(X)},children:"Cancel"})]})]})})}),(0,$.jsxs)(S.Z,{open:tt,onClose:function(){return nt(!1)},children:[(0,$.jsx)(A.Z,{children:"Remove"}),(0,$.jsx)(M.Z,{children:"Are you sure you want to delete this purchase order?"}),(0,$.jsxs)(T.Z,{children:[(0,$.jsx)(f.Z,{onClick:function(){nt(!1),dt({})},children:"Cancel"}),(0,$.jsx)(f.Z,{onClick:function(){var e=localStorage.getItem(U._.keyUserToken),t=(0,N.sw)(e),n={headers:{Authorization:"Bearer ".concat(t)}};V.ZP.post(V.Hv.purchase.delete,{id:ut._id},n).then((function(e){e&&(_("Purchase order deleted successfully!",{variant:"success"}),nt(!1),dt({}),St())})).catch((function(e){console.log(e),_(e.msg||e.error,{variant:"error"})}))},variant:"contained",color:"error",children:"Delete"})]})]})]})}function ne(){return(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(r.ql,{children:(0,$.jsx)("title",{children:" Dashboard: Purchase Order"})}),(0,$.jsx)(te,{})]})}}}]);
//# sourceMappingURL=636.ba09034f.chunk.js.map